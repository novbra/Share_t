<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新能源汽车舆情分析系统 - 用户管理</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#3b82f6',
                        accent: '#0ea5e9',
                        neutral: '#f1f5f9',
                        'neutral-dark': '#334155',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'card-hover': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .bg-gradient-primary {
                background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- 侧边栏 -->
        <aside id="sidebar" class="w-full md:w-64 bg-white shadow-lg fixed md:sticky top-0 left-0 h-full overflow-y-auto scrollbar-hide z-20">
            <!-- 侧边栏顶部 -->
            <div class="p-4 border-b">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                        <i class="fa fa-line-chart text-white"></i>
                    </div>
                    <h2 class="text-lg font-semibold text-gray-800">舆情分析系统</h2>
                </div>
            </div>

            <!-- 侧边栏导航 -->
            <nav class="p-4">
                <ul class="space-y-2">
                    <!-- 仪表盘 -->
                    <li>
                        <a href="index.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-dashboard"></i>
                            <span>仪表盘</span>
                        </a>
                    </li>

                    <!-- 情感分析 -->
                    <li>
                        <a href="sentiment.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-smile-o"></i>
                            <span>情感分析</span>
                        </a>
                    </li>

                    <!-- 主题建模 -->
                    <li>
                        <a href="topic.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-tags"></i>
                            <span>主题建模</span>
                        </a>
                    </li>

                    <!-- 报告生成 -->
                    <li>
                        <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-file-text-o"></i>
                            <span>报告生成</span>
                        </a>
                    </li>

                    <!-- 搜索与查询 -->
                    <li>
                        <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-search"></i>
                            <span>搜索与查询</span>
                        </a>
                    </li>

                    <!-- 数据采集配置（管理员专属） -->
                    <li class="admin-only">
                        <a href="data-collection.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-cogs"></i>
                            <span>数据采集配置</span>
                        </a>
                    </li>

                    <!-- 用户管理（管理员专属） -->
                    <li class="admin-only">
                        <a href="user-management.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg bg-primary text-white transition-all-300">
                            <i class="fa fa-users"></i>
                            <span>用户管理</span>
                        </a>
                    </li>

                    <!-- 系统设置 -->
                    <li>
                        <a href="settings.html" class="flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-primary hover:text-white transition-all-300">
                            <i class="fa fa-gear"></i>
                            <span>系统设置</span>
                        </a>
                    </li>
                </ul>

                <!-- 数据源状态 -->
                <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-sm font-semibold text-gray-700 mb-3">数据源状态</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">微博API</span>
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                        </li>
                        <li class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">微信公众平台</span>
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                        </li>
                        <li class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">新闻网站</span>
                            <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                        </li>
                        <li class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">论坛社区</span>
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- 主内容区域 -->
        <main class="flex-1 md:ml-64">
            <!-- 顶部导航栏 -->
            <header class="bg-white shadow-md fixed top-0 left-0 right-0 z-10">
                <div class="flex items-center justify-between p-4">
                    <!-- 移动端菜单按钮 -->
                    <button id="sidebarToggle" class="md:hidden p-2 rounded-lg text-gray-700 hover:bg-gray-100">
                        <i class="fa fa-bars"></i>
                    </button>

                    <!-- 页面标题 -->
                    <h1 class="text-xl font-semibold text-gray-800">用户管理</h1>

                    <!-- 用户菜单 -->
                    <div class="relative">
                        <button id="userMenuButton" class="flex items-center space-x-2 p-2 rounded-lg text-gray-700 hover:bg-gray-100">
                            <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">
                                <i class="fa fa-user text-gray-700"></i>
                            </div>
                            <span class="hidden md:inline">管理员</span>
                            <i class="fa fa-chevron-down text-xs"></i>
                        </button>
                        <!-- 用户菜单下拉 -->
                        <div id="userMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg hidden">
                            <ul class="py-2">
                                <li>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                        <i class="fa fa-user mr-2"></i>个人资料
                                    </a>
                                </li>
                                <li>
                                    <a href="settings.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                        <i class="fa fa-gear mr-2"></i>设置
                                    </a>
                                </li>
                                <li>
                                    <a href="login.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                        <i class="fa fa-sign-out mr-2"></i>退出登录
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </header>

            <!-- 主要内容 -->
            <div class="p-4 pt-20">
                <!-- 面包屑导航 -->
                <nav class="flex items-center space-x-2 text-sm mb-6">
                    <a href="index.html" class="text-gray-600 hover:text-primary">首页</a>
                    <i class="fa fa-chevron-right text-xs text-gray-400"></i>
                    <span class="text-gray-800">用户管理</span>
                </nav>

                <!-- 内容卡片 -->
                <div class="bg-white rounded-lg shadow-card p-6">
                    <!-- 卡片标题和操作按钮 -->
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 space-y-4 md:space-y-0">
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800">用户管理</h2>
                            <p class="text-gray-600 mt-1">管理系统用户账号和权限</p>
                        </div>
                        <button id="addUserBtn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-all-300 flex items-center space-x-2">
                            <i class="fa fa-plus"></i>
                            <span>添加新用户</span>
                        </button>
                    </div>

                    <!-- 用户列表 -->
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">用户名</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">姓名</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">邮箱</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">角色</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建时间</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- 用户行示例 -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="h-8 w-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center">
                                                <i class="fa fa-user"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">admin</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">系统管理员</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">admin@example.com</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                            管理员
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                            启用
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500">2023-01-01</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="1"><i class="fa fa-edit"></i> 编辑</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="h-8 w-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center">
                                                <i class="fa fa-user"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">user1</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">张三</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">zhangsan@example.com</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                            普通用户
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                            启用
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500">2023-01-02</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="2"><i class="fa fa-edit"></i> 编辑</button>
                                        <button class="text-gray-500 hover:text-gray-700 disable-user" data-user-id="2"><i class="fa fa-ban"></i> 禁用</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="h-8 w-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center">
                                                <i class="fa fa-user"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">user2</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">李四</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-900">lisi@example.com</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                            普通用户
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                            禁用
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm text-gray-500">2023-01-03</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="3"><i class="fa fa-edit"></i> 编辑</button>
                                        <button class="text-green-500 hover:text-green-700 enable-user" data-user-id="3"><i class="fa fa-check"></i> 启用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 用户管理模态框 -->
    <div id="userModal" class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 id="userModalTitle" class="text-lg font-medium text-gray-800">添加新用户</h3>
                <button id="closeUserModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- 用户表单 -->
            <form id="userForm">
                <input type="hidden" id="userId">
                
                <div class="mb-4">
                    <label for="userName" class="block text-sm font-medium text-gray-700 mb-1">用户名</label>
                    <input type="text" id="userName" name="userName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="输入用户名" required>
                </div>
                
                <div class="mb-4">
                    <label for="realName" class="block text-sm font-medium text-gray-700 mb-1">姓名</label>
                    <input type="text" id="realName" name="realName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="输入真实姓名" required>
                </div>
                
                <div class="mb-4">
                    <label for="userEmail" class="block text-sm font-medium text-gray-700 mb-1">邮箱</label>
                    <input type="email" id="userEmail" name="userEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="输入邮箱地址" required>
                </div>
                
                <div class="mb-4">
                    <label for="userPassword" class="block text-sm font-medium text-gray-700 mb-1">密码</label>
                    <input type="password" id="userPassword" name="userPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="输入密码">
                    <p id="passwordHint" class="text-xs text-gray-500 mt-1">编辑用户时可留空不修改密码</p>
                </div>
                
                <div class="mb-6">
                    <label for="userRole" class="block text-sm font-medium text-gray-700 mb-1">角色</label>
                    <select id="userRole" name="userRole" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary">
                        <option value="user">普通用户</option>
                        <option value="admin">管理员</option>
                    </select>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancelUserAction" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                        取消
                    </button>
                    <button type="submit" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
                        保存
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // 侧边栏切换
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('hidden');
        });

        // 用户菜单切换
        document.getElementById('userMenuButton').addEventListener('click', function() {
            document.getElementById('userMenu').classList.toggle('hidden');
        });

        // 点击外部关闭用户菜单
        document.addEventListener('click', function(e) {
            const userMenuButton = document.getElementById('userMenuButton');
            const userMenu = document.getElementById('userMenu');
            if (!userMenuButton.contains(e.target) && !userMenu.contains(e.target)) {
                userMenu.classList.add('hidden');
            }
        });

        // 用户管理功能
        // 模拟用户数据
        let users = [
            { id: 1, userName: 'admin', realName: '系统管理员', email: 'admin@example.com', role: 'admin', status: 'enabled', createTime: '2023-01-01' },
            { id: 2, userName: 'user1', realName: '张三', email: 'zhangsan@example.com', role: 'user', status: 'enabled', createTime: '2023-01-02' },
            { id: 3, userName: 'user2', realName: '李四', email: 'lisi@example.com', role: 'user', status: 'disabled', createTime: '2023-01-03' }
        ];

        // 获取DOM元素
        const userModal = document.getElementById('userModal');
        const userModalTitle = document.getElementById('userModalTitle');
        const userForm = document.getElementById('userForm');
        const userId = document.getElementById('userId');
        const userName = document.getElementById('userName');
        const realName = document.getElementById('realName');
        const userEmail = document.getElementById('userEmail');
        const userPassword = document.getElementById('userPassword');
        const userRole = document.getElementById('userRole');
        const passwordHint = document.getElementById('passwordHint');
        const addUserBtn = document.getElementById('addUserBtn');
        const closeUserModal = document.getElementById('closeUserModal');
        const cancelUserAction = document.getElementById('cancelUserAction');

        // 打开添加用户模态框
        addUserBtn.addEventListener('click', function() {
            userModalTitle.textContent = '添加新用户';
            userForm.reset();
            userId.value = '';
            passwordHint.style.display = 'none';
            userPassword.required = true;
            userModal.classList.remove('hidden');
        });

        // 关闭模态框
        function closeModal() {
            userModal.classList.add('hidden');
        }

        closeUserModal.addEventListener('click', closeModal);
        cancelUserAction.addEventListener('click', closeModal);

        // 点击外部关闭模态框
        window.addEventListener('click', function(e) {
            if (e.target === userModal) {
                closeModal();
            }
        });

        // 提交用户表单
        userForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userData = {
                userName: userName.value,
                realName: realName.value,
                email: userEmail.value,
                role: userRole.value
            };

            // 如果有密码则添加到数据中
            if (userPassword.value) {
                userData.password = userPassword.value;
            }

            if (userId.value) {
                // 编辑现有用户
                const index = users.findIndex(u => u.id === parseInt(userId.value));
                if (index !== -1) {
                    users[index] = { ...users[index], ...userData };
                    console.log('更新用户:', users[index]);
                    updateUserRow(users[index]);
                }
            } else {
                // 添加新用户
                const newUser = {
                    id: Date.now(), // 使用时间戳作为临时ID
                    ...userData,
                    status: 'enabled',
                    createTime: new Date().toISOString().split('T')[0]
                };
                users.push(newUser);
                console.log('添加新用户:', newUser);
                addUserRow(newUser);
            }

            closeModal();
        });

        // 添加用户到表格
        function addUserRow(user) {
            const tbody = document.querySelector('tbody');
            const row = document.createElement('tr');
            
            const roleText = user.role === 'admin' ? '管理员' : '普通用户';
            const roleColor = user.role === 'admin' ? 'bg-red-100 text-red-800' : 'bg-blue-100 text-blue-800';
            
            const statusText = user.status === 'enabled' ? '启用' : '禁用';
            const statusColor = user.status === 'enabled' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';
            
            const actionButtons = user.status === 'enabled' 
                ? `<button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="${user.id}"><i class="fa fa-edit"></i> 编辑</button><button class="text-gray-500 hover:text-gray-700 disable-user" data-user-id="${user.id}"><i class="fa fa-ban"></i> 禁用</button>`
                : `<button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="${user.id}"><i class="fa fa-edit"></i> 编辑</button><button class="text-green-500 hover:text-green-700 enable-user" data-user-id="${user.id}"><i class="fa fa-check"></i> 启用</button>`;
            
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="h-8 w-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center">
                            <i class="fa fa-user"></i>
                        </div>
                        <div class="ml-4">
                            <div class="text-sm font-medium text-gray-900">${user.userName}</div>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">${user.realName}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">${user.email}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${roleColor}">
                        ${roleText}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColor}">
                        ${statusText}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-500">${user.createTime}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    ${actionButtons}
                </td>
            `;
            
            tbody.appendChild(row);
            
            // 为新添加的按钮绑定事件
            bindUserActionButtons();
        }

        // 更新表格中的用户行
        function updateUserRow(user) {
            const row = document.querySelector(`[data-user-id="${user.id}"]`).closest('tr');
            if (row) {
                const roleText = user.role === 'admin' ? '管理员' : '普通用户';
                const roleColor = user.role === 'admin' ? 'bg-red-100 text-red-800' : 'bg-blue-100 text-blue-800';
                
                const statusText = user.status === 'enabled' ? '启用' : '禁用';
                const statusColor = user.status === 'enabled' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';
                
                const actionButtons = user.status === 'enabled' 
                    ? `<button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="${user.id}"><i class="fa fa-edit"></i> 编辑</button><button class="text-gray-500 hover:text-gray-700 disable-user" data-user-id="${user.id}"><i class="fa fa-ban"></i> 禁用</button>`
                    : `<button class="text-primary hover:text-secondary mr-3 edit-user" data-user-id="${user.id}"><i class="fa fa-edit"></i> 编辑</button><button class="text-green-500 hover:text-green-700 enable-user" data-user-id="${user.id}"><i class="fa fa-check"></i> 启用</button>`;
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="h-8 w-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center">
                                <i class="fa fa-user"></i>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${user.userName}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${user.realName}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${user.email}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${roleColor}">
                            ${roleText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColor}">
                            ${statusText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${user.createTime}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        ${actionButtons}
                    </td>
                `;
            }
        }

        // 绑定用户操作按钮事件
        function bindUserActionButtons() {
            // 编辑用户
            document.querySelectorAll('.edit-user').forEach(button => {
                button.addEventListener('click', function() {
                    const userIdVal = parseInt(this.dataset.userId);
                    const user = users.find(u => u.id === userIdVal);
                    if (user) {
                        userModalTitle.textContent = '编辑用户';
                        userId.value = user.id;
                        userName.value = user.userName;
                        realName.value = user.realName;
                        userEmail.value = user.email;
                        userRole.value = user.role;
                        userPassword.value = '';
                        userPassword.required = false;
                        passwordHint.style.display = 'block';
                        userModal.classList.remove('hidden');
                    }
                });
            });

            // 禁用用户
            document.querySelectorAll('.disable-user').forEach(button => {
                button.addEventListener('click', function() {
                    const userIdVal = parseInt(this.dataset.userId);
                    const user = users.find(u => u.id === userIdVal);
                    if (user && confirm(`确定要禁用用户 ${user.userName} 吗？`)) {
                        user.status = 'disabled';
                        updateUserRow(user);
                        console.log('禁用用户:', user);
                    }
                });
            });

            // 启用用户
            document.querySelectorAll('.enable-user').forEach(button => {
                button.addEventListener('click', function() {
                    const userIdVal = parseInt(this.dataset.userId);
                    const user = users.find(u => u.id === userIdVal);
                    if (user && confirm(`确定要启用用户 ${user.userName} 吗？`)) {
                        user.status = 'enabled';
                        updateUserRow(user);
                        console.log('启用用户:', user);
                    }
                });
            });
        }

        // 初始绑定按钮事件
        bindUserActionButtons();
    </script>
</body>
</html>