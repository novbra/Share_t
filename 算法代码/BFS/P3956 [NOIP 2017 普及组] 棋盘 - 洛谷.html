<!DOCTYPE html>
<!-- saved from url=(0047)https://www.luogu.com.cn/problem/solution/P3956 -->
<html lang="zh-CN" class="no-js"><script id="allow-copy_script">(function agent() {
    let unlock = false
    document.addEventListener('allow_copy', (event) => {
      unlock = event.detail.unlock
    })

    const copyEvents = [
      'copy',
      'cut',
      'contextmenu',
      'selectstart',
      'mousedown',
      'mouseup',
      'mousemove',
      'keydown',
      'keypress',
      'keyup',
    ]
    const rejectOtherHandlers = (e) => {
      if (unlock) {
        e.stopPropagation()
        if (e.stopImmediatePropagation) e.stopImmediatePropagation()
      }
    }
    copyEvents.forEach((evt) => {
      document.documentElement.addEventListener(evt, rejectOtherHandlers, {
        capture: true,
      })
    })
  })()</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="csrf-token" content="1763897434:D83pUCS8ygkHRhGtYYevpvG9GY6tUlpYe9wmCPutM/8=">
    <meta name="renderer" content="webkit">
    <script>
        window.__feInitLocalTime = new Date().getTime() / 1000;
        window.__feConfigVersion = 'ad40498c65c4c783'; window.__feConfigRequest = '\/_lfe\/config';
        window.__luoguTagVersion = 'zh\u002DCN\/2025112219'; window.__luoguTagRequest = '\/_lfe\/tags\/zh\u002DCN';
            </script>
    <title>P3956 [NOIP 2017 普及组] 棋盘 - 洛谷</title>
    <style type="text/css">:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}</style><link rel="icon" href="https://fecdn.luogu.com.cn/favicon.ico">
    <meta http-equiv="Content-Security-Policy" content="default-src &#39;unsafe-eval&#39; &#39;unsafe-inline&#39; luogu.com *.luogu.com luogu.com.cn *.luogu.com.cn luogu.org *.luogu.org wss: blob: luoguprivate.oss-cn-hangzhou.aliyuncs.com luogu.oss-cn-hangzhou.aliyuncs.com https://challenges.cloudflare.com https://*.dun.163yun.com https://*.dun.163.com https://*.nosdn.126.net https://*.nosdn.127.net https://nos.netease.com https://cstaticdun.126.net https://cstaticdun1.126.net https://cstaticdun-v6.126.net https://acstatic-dun.126.net; img-src * data:; font-src * data:; worker-src data: blob:; frame-src https://player.bilibili.com https://www.bilibili.com https://challenges.cloudflare.com">    <script id="lentille-context" type="application/json">{"instance":"main","template":"problem.solution","status":200,"locale":"zh-CN","data":{"solutions":{"perPage":10,"count":11,"result":[{"lid":"2779qoy1","title":"\u9898\u89e3 P3956 \u3010\u68cb\u76d8\u3011","time":1536585113,"author":{"uid":35871,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/35871.png","name":"ZigZagKmp","slogan":"Think twice. Code once.","badge":null,"isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":7,"xcpcLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/2zvvl49n.png"},"upvote":520,"replyCount":93,"favorCount":3,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"### update on 2020.2.16\n\u770b\u5230\u8bc4\u8bba\u533a\u6709\u540c\u5b66\u5bf9\u6392\u7248\u7684\u5efa\u8bae\uff0c\u6545\u5bf9\u6587\u7ae0\u6392\u7248\u8fdb\u884c\u4e00\u4e9b\u4f18\u5316\uff0c\u4f7f\u672c\u9898\u89e3\u7b26\u5408\u73b0\u884c\u9898\u89e3\u89c4\u8303\u3002\n\n## \u5199\u5728\u524d\u9762\n\u8fd9\u662f\u672c\u849f\u84bb\u4e00\u5e74\u524d\u53d1\u7684\u9898\u89e3\uff0c\u56e0\u6b64\u6709\u4e9b\u5730\u65b9\u8bb2\u7684\u4e0d\u662f\u7279\u522b\u6e05\u695a\uff0c\u4ee3\u7801\u4e5f\u6bd4\u8f83\u5197\u957f\u3002\u5176\u5b9e\u8fd9\u4e00\u9898\u6ca1\u6709\u5fc5\u8981\u5c06\u5176\u8f6c\u6362\u4e3a\u56fe\u8bba\u6a21\u578b\uff0c\u5728\u4e0a\u9762\u8dd1\u6700\u77ed\u8def\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4f18\u5148\u961f\u5217\u4f18\u5316\u7684 `BFS` \u3002\n\n`NOIP2017`\u666e\u53ca\u7ec4\u6bd4\u8d5b\uff0c\u662f\u6211\u53c2\u52a0\u7684\u7b2c\u4e00\u6b21\u590d\u8d5b\uff0c\u5f53\u65f6\u6211\u592a\u83dc\u4e86\uff08\u867d\u7136\u8bf4\u73b0\u5728\u7684\u6211\u4e5f\u8fd8\u662f\u5f88\u83dc\uff09\uff0c\u8fd9\u4e00\u9898\u6700\u66b4\u529b\u7684 `dfs` \u90fd\u5199\u4e0d\u5bf9\uff0c\u4e0d\u77e5\u600e\u4e48\u62ff\u5230\u4e86`20`\u5206\uff0c\u5176\u4f59\u7684\u6d4b\u8bd5\u70b9 `WA`+`TLE` \uff0c\u5728\u8003\u573a\u4e0a\u65f6\u95f4\u51e0\u4e4e\u5168\u7528\u6765\u6c2a\u8fd9\u4e00\u9898\uff0c\u7ed3\u679c\u6700\u540e\u4e00\u9898\u60f3\u51fa`50`\u5206 `DP` \u6ca1\u8c03\u5b8c\uff0c`220`\u6eda\u7c97\u3002\u8003\u573a\u4e0a\u4e3b\u8981\u7ea0\u7ed3\u4e8e\u5982\u4f55\u5904\u7406\u9b54\u6cd5\uff0c\u56e0\u6b64\u8003\u540e\u548c[\u540c\u5b66](https:\/\/www.luogu.com.cn\/user\/28910)\u60f3\u5230\u4e86\u8fd9\u6837\u4e00\u79cd\u4ee3\u66ff\u9b54\u6cd5\u7684\u7b97\u6cd5\u3002\n\n\u8fd9\u4e00\u6b21\u4fee\u6539\uff0c\u5c06\u5bf9\u539f\u9898\u89e3\u4e2d\u89e3\u91ca\u7684\u4e0d\u662f\u5f88\u6e05\u695a\u7684\u5730\u65b9\u4f5c\u8f83\u4e3a\u6e05\u6670\u7684\u89e3\u91ca\uff0c\u5e76\u4e14\u4fee\u6539\u4e86\u6700\u540e\u7684\u53c2\u8003\u7a0b\u5e8f\uff0c\u63d0\u4f9b\u672c\u98982\u79cd\u505a\u6cd5\u3002\n\n\u81f3\u4e8e\u672c\u9898\u7684\u4e3b\u6d41\u7b97\u6cd5\uff08 `dfs` +\u8bb0\u5fc6\u5316\u4f18\u5316\uff09\uff0c\u5176\u5b9e\u4ece\u6700\u77ed\u8def\u7684\u89d2\u5ea6\u4e0a\u6765\u8bb2\u662f\u57fa\u4e8e `dfs` \u5b9e\u73b0\u7684 `SPFA` \uff08\u6ca1\u9519\uff0c\u5c31\u662f\u90a3\u4e2a~~\u6b7b\u4e86\u53c8\u6d3b\u4e86\u7684`SPFA`~~\uff09,\u5982\u679c\u8fd9\u4e00\u9898\u6570\u636e\u8303\u56f4\u6269\u5927\uff0c\u5e76\u4e14\u505a\u4e00\u4e9b\u7279\u6b8a\u6784\u9020\uff0c\u662f\u53ef\u4ee5\u88ab\u5361\u6389\u7684\u3002\n\n\u53e6\u5916\uff0c\u672c\u849f\u84bb\u4e0d\u5efa\u8bae\u4f7f\u7528\u57fa\u4e8e `dfs` \u5b9e\u73b0\u7684 `SPFA` \uff0c\u56e0\u4e3a\u8fd9\u5176\u5b9e\u662f\u6700\u597d\u5361\u6389\u4e86 `SPFA` \u3002\n\n----\n\n### \u9898\u610f\u5206\u6790\u4e0e\u8f6c\u5316\n\n\u003E \u7ed9\u4f60\u4e00\u4e2a\u68cb\u76d8\uff0c\u6709\u4e00\u4e9b\u683c\u5b50\u88ab\u67d3\u6210\u4e86\u4e24\u79cd\u989c\u8272\u3002\u4f60\u53ef\u4ee5\u4ece\u4e00\u4e2a\u6709\u989c\u8272\u7684\u683c\u5b50\u8d70\u5411\u53e6\u4e00\u4e2a\u6709\u989c\u8272\u7684\u683c\u5b50\uff0c\u82e5\u4e24\u4e2a\u683c\u5b50\u989c\u8272\u76f8\u540c\uff0c\u5219\u4e0d\u4ed8\u51fa\u4ee3\u4ef7\uff0c\u5426\u5219\u4ed8\u51fa $1$ \u70b9\u4ee3\u4ef7\u3002\n\n\u5982\u679c\u9898\u76ee\u5c31\u5230\u8fd9\u91cc\uff0c\u76f8\u5f53\u4e8e\u4ee3\u4ef7\u4e3a $0$ \u6216\u8005 $1$ \u7684\u56db\u4e2a\u65b9\u5411\u7684\u8d70\u8ff7\u5bab\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cc\u7aef\u961f\u5217 `BFS` \u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(m^2)$\n\n\n\u003E \u53e6\u5916\uff0c \u4f60\u53ef\u4ee5\u82b1\u8d39 $2$ \u4e2a\u91d1\u5e01\u65bd\u5c55\u9b54\u6cd5\u8ba9\u4e0b\u4e00\u4e2a\u65e0\u8272\u683c\u5b50\u6682\u65f6\u53d8\u4e3a\u4f60\u6307\u5b9a\u7684\u989c\u8272\u3002\u4f46**\u8fd9\u4e2a\u9b54\u6cd5\u4e0d\u80fd\u8fde\u7eed\u4f7f\u7528**\uff0c \u800c\u4e14\u8fd9\u4e2a\u9b54\u6cd5\u7684\u6301\u7eed\u65f6\u95f4\u5f88\u77ed\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u8fd9\u4e2a\u9b54\u6cd5\uff0c\u8d70\u5230\u4e86\u8fd9\u4e2a\u6682\u65f6\u6709\u989c\u8272\u7684\u683c\u5b50\u4e0a\uff0c\u4f60\u5c31\u4e0d\u80fd\u7ee7\u7eed\u4f7f\u7528\u9b54\u6cd5\uff1b \u53ea\u6709\u5f53\u4f60\u79bb\u5f00\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u8d70\u5230\u4e00\u4e2a\u672c\u6765\u5c31\u6709\u989c\u8272\u7684\u683c\u5b50\u4e0a\u7684\u65f6\u5019\uff0c\u4f60\u624d\u80fd\u7ee7\u7eed\u4f7f\u7528\u8fd9\u4e2a\u9b54\u6cd5\uff0c\u800c\u5f53\u4f60\u79bb\u5f00\u4e86\u8fd9\u4e2a\u4f4d\u7f6e\uff08\u65bd\u5c55\u9b54\u6cd5\u4f7f\u5f97\u53d8\u4e3a\u6709\u989c\u8272\u7684\u683c\u5b50\uff09\u65f6\uff0c\u8fd9\u4e2a\u683c\u5b50\u6062\u590d\u4e3a\u65e0\u8272\u3002\n\n\u5982\u679c\u5c31\u6309\u7167\u9898\u610f\u6765**\u76f4\u63a5\u641c\u7d22**\u7684\u8bdd\u4f1a\u6bd4\u8f83\u9ebb\u70e6\uff08\u672c\u849f\u84bb\u5f53\u5e74\u5c31\u662f\u8fd9\u6837\u5199\u6302\u4e86\u7684\uff09\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u8f6c\u5316\u4e00\u4e0b\u3002\n\n\uff08\u6ce8\uff1a\u4e0b\u9762\u7684\u5206\u6790\u8fc7\u7a0b\u4e0d\u59a8**\u53ea\u8003\u8651\u4e00\u79cd\u989c\u8272**\uff0c\u56e0\u4e3a\u989c\u8272\u4e0d\u540c\u5e26\u6765\u7684\u4ee3\u4ef7\u7684\u53d8\u5316\u548c\u9b54\u6cd5\u7684\u8f6c\u5316\u6ca1\u6709\u592a\u5927\u5173\u7cfb\uff09\n\n\u6211\u4eec\u73b0\u5728\u7ad9\u5728\u4e00\u4e2a\u65bd\u4e86\u9b54\u6cd5\u7684\u683c\u5b50\u4e0a(\u79f0\u4e3a `via` )\uff0c\u6211\u4eec\u4e0a\u4e00\u6b65\u7684\u683c\u5b50\u79f0\u4e3a `now` \uff0c\u4e0b\u9762\u6211\u4eec\u601d\u8003\u4e0b\u4e00\u6b65\u80fd\u8d70\u5230\u7684\u683c\u5b50\u6709\u54ea\u4e9b\uff08\u79f0\u4e3a `next` \uff09\u3002\n\n\u56e0\u4e3a\u9b54\u6cd5\u4e0d\u80fd\u8fde\u7528\uff0c\u5e76\u4e14\u5982\u679c\u6211\u4eec\u8d70\u56de\u4e0a\u4e00\u6b65\u7684\u683c\u5b50\uff0c\u7ed3\u679c\u4e00\u5b9a\u4e0d\u662f\u6700\u4f18\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u7684\u53ea\u6709\u5982\u4e0b\u7684\u60c5\u51b5\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/71445.png)\n\n\u5176\u4e2d\u84dd\u8272\u7684\u683c\u5b50\u53ef\u80fd\u6210\u4e3a `next` \uff08**\u524d\u63d0\uff0c\u5728\u672a\u4f7f\u7528\u9b54\u6cd5\u7684\u60c5\u51b5\u4e0b\u8fd9\u4e9b\u683c\u5b50\u672c\u6765\u6709\u8272**\uff09\u3002\n\n\u77e5\u9053\u4e86 `next` \u53ef\u80fd\u7684\u51b3\u7b56\u96c6\u5408\uff0c\u6211\u4eec\u4e0b\u9762\u6765\u770b\u5982\u4f55\u628a\u9b54\u6cd5**\u7b49\u4ef7\u8f6c\u6362**\u6389\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32552.png)\n\n\u5982\u56fe\uff0c\u53ef\u4ee5\u5c06\u683c\u5b50 `via` \u65bd\u52a0\u9b54\u6cd5\uff0c\u4ece `now` \u8d70\u5411 `next` \uff0c\u5b9e\u73b0\u4e86\u5411**\u53f3\u4e0b\u65b9**\u7684\u8f6c\u79fb\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32553.png)\n\n\u5982\u56fe\uff0c\u53ef\u4ee5\u5c06\u683c\u5b50 `via` \u65bd\u52a0\u9b54\u6cd5\uff0c\u4ece `now` \u8d70\u5411 `next` \uff0c\u5b9e\u73b0\u4e86\u5411**\u5de6\u4e0b\u65b9**\u7684\u8f6c\u79fb\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32554.png)\n\n\u5982\u56fe\uff0c\u53ef\u4ee5\u5c06\u683c\u5b50 `via` \u65bd\u52a0\u9b54\u6cd5\uff0c\u4ece `now` \u8d70\u5411 `next` \uff0c\u5b9e\u73b0\u4e86\u5411**\u4e0b\u8fde\u8df3$2$\u683c**\u7684\u8f6c\u79fb\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32555.png)\n\n\u5982\u56fe\uff0c\u53ef\u4ee5\u5c06\u683c\u5b50 `via` \u65bd\u52a0\u9b54\u6cd5\uff0c\u4ece `now` \u8d70\u5411 `next` \uff0c\u5b9e\u73b0\u4e86\u5411**\u53f3\u8fde$2$\u683c**\u7684\u8f6c\u79fb\u3002\n\n\u540c\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5411**\u5de6\u4e0a\u65b9**\uff0c\u5411**\u53f3\u4e0a\u65b9**\uff0c\u5411**\u4e0a\u8fde\u8df3$2$\u683c**\uff0c\u5411**\u5de6\u8fde\u8df3$2$\u683c**\u7684\u8f6c\u79fb\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u5f97\u5230**\u4f7f\u7528\u9b54\u6cd5**\u53ef\u4ee5\u8f6c\u79fb\u5230\u7684\u60c5\u51b5\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32556.png)\n\n\u7efc\u5408\u4e00\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7ed3\u8bba\uff1a\u4ece `now` \u8fd9\u4e2a\u683c\u5b50\u51fa\u53d1\uff0c\u4f7f\u7528\u6216\u4e0d\u4f7f\u7528\u9b54\u6cd5\u53ef\u4ee5\u8d70\u5230\u7684**\u6709\u8272\u683c\u5b50**\u7684\u60c5\u51b5\u5982\u4e0b\u56fe\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32558.png)\n\n\u5176\u4e2d\u7eff\u8272\u683c\u5b50\u56e0\u4e3a\u4f7f\u7528\u9b54\u6cd5\uff0c\u4e0d\u9700\u8981\u82b1\u8d39\u4ee3\u4ef7\uff0c\u84dd\u8272\u7684\u683c\u5b50\u56e0\u4e3a\u4f7f\u7528\u4e00\u6b21\u9b54\u6cd5\uff0c\u9700\u8981\u989d\u5916\u82b1\u8d39 $2$ \u70b9\u4ee3\u4ef7\u3002\uff08\u540c\u6837\uff0c\u8fd9\u91cc\u4e0d\u8003\u8651\u683c\u5b50\u5b9e\u9645\u989c\u8272\u5bf9\u4ee3\u4ef7\u7684\u5f71\u54cd\uff09\n\n\u4e5f\u8bb8\u6709\u540c\u5b66\u4f1a\u95ee\u4e86\uff0c\u5982\u679c\u51fa\u73b0\u4e0b\u56fe\u4e2d\u7684\u8fd9\u79cd\u60c5\u51b5\u5462\uff1f\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/71453.png )\n\n\u663e\u7136\u4ece `now` \u51fa\u53d1\u5148\u5411\u53f3\u8d70\u540e\u5411\u4e0b\u8d70\u662f\u66f4\u4f18\u7684\uff0c\u4f46\u662f\u6309\u7167\u6211\u4eec\u521a\u521a\u6240\u8ff0\u7684\u65b9\u6cd5\uff0c\u5bf9 `now` \u8fd9\u4e2a\u683c\u5b50\u8ba8\u8bba\uff0c\u53f3\u4e0b\u89d2\u7684\u6709\u8272\u683c\u5b50 `B` \u4f1a\u88ab\u8ba4\u4e3a\u8981\u4f7f\u7528\u9b54\u6cd5\uff0c\u51ed\u7a7a\u591a\u51fa\u4e86$2$\u70b9\u4ee3\u4ef7\uff0c\u6211\u4eec\u521a\u521a\u7684\u65b9\u6cd5\u80fd\u5f97\u5230\u6700\u4f18\u89e3\u5417\uff1f\n\n\u8bd5\u95ee\uff1a `now` \u53f3\u9762\u7684\u683c\u5b50 `A` \u662f\u4e0d\u662f\u6709\u8272\u683c\u5b50\uff1f\n\n\u65e2\u7136 `A` \u662f\u6709\u8272\u683c\u5b50\uff0c\u90a3\u4e48\u6211\u4eec\u4e5f\u4f1a\u5bf9 `A` \u8ba8\u8bba\uff0c `now` \u53ef\u4ee5\u4e0d\u82b1\u8d39\u4ee3\u4ef7\u5230\u8fbe `A` \uff0c `A` \u53c8\u53ef\u4ee5\u4e0d\u82b1\u8d39\u4ee3\u4ef7\u5230\u8fbe `B` \uff0c\u56e0\u6b64 `now` \u5230 `B` \u683c\u5b50\u7684\u4ee3\u4ef7\u6700\u7ec8\u4f1a\u88ab `now-\u003EA-\u003EB` \u7684\u8def\u5f84\u53d6\u4ee3\uff0c\u4e0d\u4f1a\u51fa\u73b0\u4e22\u5931\u6700\u4f18\u89e3\u7684\u60c5\u51b5\u3002\n\n\u8fd9\u65f6\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\uff1a\u666e\u901a\u7684 `BFS` \u4f3c\u4e4e\u5b9e\u73b0\u4e0d\u4e86\u8fd9\u79cd\u7b54\u6848\u66f4\u65b0\uff0c\u5177\u4f53\u7684\u5206\u6790\u4e0e\u89e3\u6cd5\u5c06\u5728\u4e0b\u6587\u8bb2\u89e3\u3002\n\n----\n\n#### \u73b0\u5728\u6211\u4eec\u5148\u628a\u989c\u8272\u52a0\u4e0a\u53bb\uff1a\n\n1. \u4e0e\u9b54\u6cd5\u65e0\u5173\u7684$4$\u79cd\u8f6c\u79fb\uff0c\u540c\u8272\u4ee3\u4ef7\u4e0d\u53d8\uff0c\u5f02\u8272\u4ee3\u4ef7\u52a0 $1$ \u3002\n2. \u6d89\u53ca\u9b54\u6cd5\u7684$8$\u79cd\u8f6c\u6362\uff0c\u5982\u679c\u989c\u8272\u76f8\u540c\uff0c\u5982\u56fe\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32560.png)\n\n\u5f53\u683c\u5b50 `via` \u53d8\u6210\u9ec4\u8272\u7684\u683c\u5b50\u7684\u65f6\u5019\uff0c\u4ed8\u51fa\u7684\u4ee3\u4ef7\u6700\u5c0f\uff0c\u4e00\u5171\u4e3a$2$\u4e2a\u4ee3\u4ef7\u3002\n\n\u5982\u679c\u989c\u8272\u4e0d\u540c\uff0c\u5982\u56fe\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/32561.png)\n\n\u5f53\u683c\u5b50 `via` \u53d8\u6210\u9ec4\u8272\u6216\u8005\u7ea2\u8272\u7684\u65f6\u5019\uff0c\u4ed8\u51fa\u7684\u4ee3\u4ef7\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4e00\u5171\u4e3a$3$\u4e2a\u4ee3\u4ef7\u3002\n\n----\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u5c06\u9898\u76ee\u8f6c\u5316\u4e3a\u5982\u4e0b\uff1a\n\n\u003E \u4f60\u9700\u8981\u4ece$(1,1)$\u8d70\u5230$(m,m)$\uff0c\u4f60\u53ea\u80fd\u8d70\u5728\u6709\u989c\u8272\u7684\u683c\u5b50\u4e2d\uff0c\u5e76\u4e14\u4f7f\u5f97\u4f60\u6240\u82b1\u8d39\u7684\u4ee3\u4ef7\u6700\u5c0f\u3002\n\n\u003E \u5f53\u4f60\u7ad9\u5728\u4e00\u4e2a\u6709\u989c\u8272\u7684\u683c\u5b50\u4e0a\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b$2$\u79cd\u64cd\u4f5c\uff1a\n\u003E 1. \u5411\u4e0a\u3001\u4e0b\u3001\u5de6\u3001\u53f3\u524d\u884c\u3002\n\u003E 2. \u5411\u5de6\u4e0a\u3001\u5de6\u4e0b\u3001\u53f3\u4e0a\u3001\u53f3\u4e0b\u3001\u5411\u4e0a\u8fde\u8df3$2$\u683c\u3001\u5411\u4e0b\u8fde\u8df3$2$\u683c\u3001\u5411\u5de6\u8fde\u8df3$2$\u683c\u3001\u5411\u53f3\u8fde\u8df3$2$\u683c\u524d\u884c\u3002\n\n\u003E \u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u64cd\u4f5c $2$ \uff0c\u4f60\u5c06\u989d\u5916\u4ed8\u51fa $2$ \u70b9\u4ee3\u4ef7\u3002\n\n\u003E \u5728\u4e00\u6b21\u64cd\u4f5c\u4e2d\uff0c\u5982\u679c\u4f60**\u8fd9\u6b21\u64cd\u4f5c\u7684\u8d77\u70b9\u683c\u5b50\u4e0e\u7ec8\u70b9\u683c\u5b50**\u989c\u8272\u4e0d\u540c\uff0c\u4f60\u5c06\u4ed8\u51fa$1$\u70b9\u4ee3\u4ef7\u3002\n\n\u5b8c\u4e86\u5417\uff1f\n\n**\u663e\u7136\u6ca1\u6709\uff01**\n\n\u5982\u679c$(m,m)$\u6ca1\u6709\u989c\u8272\u600e\u4e48\u529e\uff1f\n\n\u56e0\u4e3a\u9b54\u6cd5\u4e0d\u80fd\u8fde\u7eed\u4f7f\u7528\uff0c\u6240\u4ee5\u53ea\u53ef\u80fd\u4ece$(m,m-1)$\uff0c$(m-1,m)$\u8f6c\u79fb\u3002\n\n1. \u5982\u679c\u90fd\u6ca1\u6709\u989c\u8272\uff0c\u5c31\u4e0d\u53ef\u80fd\u5230\u8fbe$(m,m)$\u3002\n2. \u5982\u679c\u4efb\u4f55\u4e00\u4e2a\u6709\u989c\u8272\uff0c\u76f8\u5f53\u4e8e$(m,m)$\u53d8\u5316\u4e3a\u6709\u989c\u8272\u7684\u90a3\u4e2a\u683c\u5b50\u7684\u989c\u8272\uff0c\u603b\u4ee3\u4ef7\u4e3a$2$\u3002\n3. \u5982\u679c$2$\u4e2a\u90fd\u6709\u989c\u8272\uff0c\u8f6c\u79fb\u603b\u4ee3\u4ef7\u90fd\u662f$2$\uff0c\u6700\u540e\u505a\u4e00\u4e0b\u6bd4\u8f83\u5c31\u53ef\u4ee5\u4e86\u3002\n\n----\n\n## \u7b97\u6cd5\u5206\u6790\n\u4e0b\u9762\u6211\u4eec\u4e3b\u8981\u7814\u7a76 `BFS` \u7684\u5b9e\u73b0\u3002\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5c06\u9898\u610f\u8f6c\u5316\u4e3a\u7ecf\u5178\u7684\u8d70\u8ff7\u5bab\u6a21\u578b\uff0c\u89e3\u51b3\u7684\u7ecf\u5178\u65b9\u6cd5\u662f `BFS` \uff0c\u4f46\u662f\u53c8\u6709\u6240\u4e0d\u540c\u3002\u6bcf\u4e00\u6b21\u62d3\u5c55\u7684\u4ee3\u4ef7\u4e0d\u4e00\u5b9a\u76f8\u540c\uff0c\u6b64\u65f6\u53ef\u80fd\u51fa\u73b0\u5982\u4e0b\u7684\u60c5\u51b5\uff1a\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/39190.png)\n\n~~\u56e0\u4e3a\u4e0d\u6ee1\u8db3\u4e09\u89d2\u5f62\u4e0d\u7b49\u5f0f\uff0c\u6240\u4ee5\u4ece\u5b9e\u9645\u6765\u8bb2\u8fd9\u91cc\u4e0d\u5e94\u8be5\u753b\u6210\u4e09\u89d2\u5f62\u3002\u4f46\u56e0\u4e3a\u8fd9\u5f20\u56fe\u7b80(wo)\u660e(bi)\u76f4(jiao)\u89c2(lan)\uff0c\u6240\u4ee5\u8fd9\u5f20\u56fe\u5c31\u4e0d\u91cd\u753b\u4e86\u3002~~\n\n\u663e\u7136\uff0c\u6700\u77ed\u8def\u5f84\u5e94\u8be5\u662f `1-\u003E2-\u003E3` \uff0c\u800c\u5982\u679c\u6211\u4eec\u7528\u4e00\u822c\u7684\u961f\u5217\u5b9e\u73b0\u5bbd\u641c\uff0c\u5c31\u4f1a\u5f97\u5230\u9519\u8bef\u7684\u7b54\u6848\u3002\n\n\u6211\u4eec\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a\u4e3a\u4ec0\u4e48\u7ecf\u5178\u7684\u8d70\u8ff7\u5bab\u6a21\u578b\u53ef\u4ee5\u76f4\u63a5\u666e\u901a\u961f\u5217 `BFS` \uff1f\n\n\u4e0d\u96be\u5f97\u51fa\uff1a\u5728\u8fd9\u6837\u7684 `BFS` \u4e2d\uff0c\u6bcf\u4e00\u6b21\u6269\u5c55\u7684\u4ee3\u4ef7\u90fd\u76f8\u7b49**\u4e14\u4e3a\u6b63\u6570**\uff0c**\u540e\u8fdb\u5165\u961f\u5217\u7684\u72b6\u6001\u4e00\u5b9a\u4e0d\u5982\u5148\u8fdb\u5165\u961f\u5217\u7684\u72b6\u6001\u4f18**\uff08\u5148\u8fdb\u5165\u961f\u5217\u7684\u72b6\u6001\u7684\u4ee3\u4ef7 $\\le$ \u540e\u8fdb\u5165\u961f\u5217\u7684\u72b6\u6001\u7684\u4ee3\u4ef7\uff09\u3002\n\n\u57fa\u4e8e\u8fd9\u6837\u7684\u5355\u8c03\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\uff1a\u7b2c\u4e00\u6b21\u8bbf\u95ee\u5230\u67d0\u4e00\u4e2a\u72b6\u6001\u65f6\uff0c\u4e00\u5b9a\u662f\u8fd9\u4e2a\u72b6\u6001\u7684\u6700\u4f18\u60c5\u51b5\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u8d2a\u5fc3\u601d\u60f3\u3002\u6211\u4eec\u628a\u8fd9\u79cd\u601d\u60f3\u5e94\u7528\u5230\u66f4\u5177\u6709\u666e\u904d\u6027\u7684\u60c5\u51b5\u4e2d\uff1a\u4ee3\u4ef7\u4e0d\u4e00\u5b9a\u76f8\u7b49\u3002\n\n\u73b0\u5728\u6211\u4eec\u6709$2$\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a\n- \u666e\u901a\u961f\u5217+\u8fed\u4ee3\u601d\u60f3(~~\u5df2\u7ecf\u6b7b\u6389\u7684`SPFA`~~)\n\n\u6211\u4eec\u65e0\u6cd5\u4fdd\u8bc1\u7b2c\u4e00\u6b21\u8bbf\u95ee\u5230\u67d0\u4e00\u4e2a\u72b6\u6001\u7684\u6700\u4f18\u6027\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u5c06**\u88ab\u4f18\u5316\u7684\u72b6\u6001**\u4e0d\u65ad\u538b\u5165\u961f\u5217\u4e2d\uff0c\u76f4\u5230\u6240\u6709\u72b6\u6001\u90fd\u662f\u6700\u4f18\u7684\u3002\u8fd9\u79cd\u7b97\u6cd5\u6700\u574f\u60c5\u51b5\u4e0b\u53ef\u4ee5\u8fbe\u5230 $O(n^2)$ \uff08n\u4e3a\u72b6\u6001\u79cd\u6570\uff09\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a $O(n)$ \u3002\n- \u4f18\u5148\u961f\u5217( `Dijkstra` )\n\n\u6211\u4eec\u53ea\u8981\u6ee1\u8db3\u6bcf\u4e00\u6b21\u90fd\u4ece\u72b6\u6001\u961f\u5217\u4e2d\u53d6\u51fa\u6700\u5c0f\u4ee3\u4ef7\u7684\u72b6\u6001\uff0c\u5373\u53ef\u6ee1\u8db3\u7b2c\u4e00\u6b21\u8bbf\u95ee\u6700\u4f18\u6027\u3002\u4f18\u5148\u961f\u5217\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u79cd\u64cd\u4f5c\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log_2n)$ \u3002\n\n\u6709\u4e00\u79cd\u6bd4\u8f83\u5f62\u8c61\u5730\u89e3\u91ca\uff0c\u6211\u4eec\u53ef\u4ee5\u628a `BFS` \u7684\u68cb\u76d8\u770b\u4f5c\u56fe\uff0c\u5373 `Dijkstra` \u7528\u6765\u89e3\u51b3\u6700\u77ed\u8def\u3002\u628a\u8fd9\u4e2a\u56fe **\u201c\u62ce\u8d77\u6765 \u201d**\uff0c\u6700\u521d\u62ce\u7740\u8d77\u70b9\uff0c\u7136\u540e\u627e\u5f53\u524d\u6700\u9ad8\u7684\u4e14\u6ca1\u6709\u88ab\u62ce\u8fc7\u7684\u7ed3\u70b9\uff0c\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u62ce\u8d77\u6765\u7684\u7ed3\u70b9\uff0c\u5982\u6b64\u4e0d\u65ad\u53bb\u62ce\uff0c\u76f4\u5230\u628a\u7ec8\u70b9\u7ed3\u70b9\u62ce\u8d77\u6765\uff0c\u8fd9\u6837\u62ce\u5c31\u53ef\u4ee5\u627e\u5230\u8d77\u70b9\u548c\u7ec8\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\u3002\n\n\u6ce8\u610f\uff0c\u4f7f\u7528\u4f18\u5148\u961f\u5217\u4f18\u5316\u7684 `BFS` \u4e0d\u80fd\u5904\u7406**\u6709\u8d1f\u6570\u4ee3\u4ef7**\u7684\u60c5\u51b5\uff0c\u53cd\u4f8b\u5982\u4e0b\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/71455.png)\n\n\u6211\u4eec\u8981\u4ece `S` \u8d70\u5230 `T` \uff0c\u7b2c\u4e00\u6b65\u5c31\u53ef\u4ee5\u627e\u5230\u6240\u8c13\u7684\u6700\u5c0f\u4ee3\u4ef7$2$\uff0c `A` \u867d\u7136\u4e5f\u5728\u961f\u5217\u4e2d\uff0c\u4f46\u662f$10$\u7684\u4ee3\u4ef7\u6bd4$2$\u5927\uff0c\u56e0\u6b64\u4e0d\u4f1a\u88ab\u53d6\u51fa\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\uff0c `S` \u8d70\u5230 `T` \u7684\u6700\u5c0f\u4ee3\u4ef7\u662f$-90$\uff0c\u8def\u5f84\u4e3a `S-\u003EA-\u003ET` ,\u6211\u4eec\u5f97\u5230\u4e86\u9519\u8bef\u7684\u7b54\u6848\u3002\n\n----\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u6210\u529f\u8df3\u51fa\u4e86\u547d\u9898\u4eba\u6316\u7ed9\u6211\u4eec\u7684\u7684\u601d\u7ef4\u9677\u9631\uff0c\u6ca1\u6709\u76f4\u63a5\u6309\u7167\u9898\u610f\u641c\u7d22\uff0c\u800c\u662f\u5c06\u9898\u610f\u8f6c\u5316\uff0c\u7b80\u5316\u95ee\u9898\uff0c\u5927\u5927\u964d\u4f4e\u4e86\u4ee3\u7801\u5b9e\u73b0\u590d\u6742\u5ea6\u3002\uff08\u542c\u8bf4\u76f4\u63a5\u6309\u7167\u9898\u610f `dfs` \u4f1a\u70b8\u6808\u7a7a\u95f4\uff0c\u867d\u7136 `NOIP` \u5f00\u5927\u6808\u7a7a\u95f4\uff0c\u4f46\u662f\u4f60\u5728\u8dd1\u5927\u6837\u4f8b\u7684\u65f6\u5019\u770b\u5230\u7a0b\u5e8f\u62a5 `RE` \u8fd8\u627e\u4e0d\u5230\u54ea\u513f\u9519\u4e86\uff0c\u5bf9\u63a5\u4e0b\u6765\u505a\u9898\u7684\u5fc3\u6001\u4f1a\u6709\u5f88\u5927\u5f71\u54cd\uff09\n\nupdate on 2020.2.16. `CSP-S 2019` \u7684\u65f6\u5019\uff0c\u6211\u7684\u51e0\u4e2a\u540c\u5b66\u56e0\u4e3a\u4e0d\u4f1a\u5f00\u5927\u6808\u7a7a\u95f4 `Day1T2` \u6ca1\u6cd5\u6d4b\u5927\u6837\u4f8b\uff0c\u4e22\u5206\u4e25\u91cd\uff0c\u4e14\u5f71\u54cd\u5230 `Day2` \u7684\u53d1\u6325\u3002\n\n----\n\n### \u4ee3\u7801\u5b9e\u73b0\n1.  `BFS` +\u4f18\u5148\u961f\u5217\u4f18\u5316\n\n```cpp\n#include\u003Cbits\/stdc++.h\u003E\nusing namespace std;\n#define inf 0x3f3f3f3f\ntemplate \u003Ctypename Tp\u003E\nvoid read(Tp \u0026x){\n\tchar c=getchar();x=0;int f=1;\n\twhile(c\u003C\u00270\u0027||c\u003E\u00279\u0027){if(c==\u0027-\u0027)f=-1;c=getchar();}\n\twhile(c\u003E=\u00270\u0027\u0026\u0026c\u003C=\u00279\u0027){x=x*10+c-\u00270\u0027;c=getchar();}x*=f;\n}\/\/\u5feb\u901f\u8bfb\u5165\uff0c\u4e0d\u89e3\u91ca\nstruct node{\n\tint x,y,c,w; \n\tbool operator \u003C(node b)const{\/\/const\u4e0d\u53ef\u4e22 \n\t\treturn w\u003Eb.w;\n\t}\/\/\u56e0\u4e3aSTL\u4e2d\u4f18\u5148\u961f\u5217\u9ed8\u8ba4\u53d6\u51fa\u6700\u5927\u7684\u5143\u7d20 \n\t \/\/\u6240\u4ee5\u8fd9\u91cc\u91cd\u8f7d\u8fd0\u7b97\u7b26\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u53d6\u51fa\u7684\u662f\u6700\u5c0f\u4ee3\u4ef7\u7684 \n};\npriority_queue\u003Cnode\u003Eq;\/\/node\u7c7b\u578b\u5fc5\u987b\u5b9a\u4e49\u003C \nint dx[]={0,1,0,-1,1,1,-1,-1,0,2,0,-2};\/\/12\u65b9\u5411\u53ca\u9b54\u6cd5\u4ee3\u4ef7 \nint dy[]={1,0,-1,0,1,-1,1,-1,2,0,-2,0};\nint dw[]={0,0,0,0,2,2,2,2,2,2,2,2};\nint a[105][105],dis[105][105];\/\/a\u5b58\u50a8\u68cb\u76d8\u4e0a\u683c\u5b50\u7684\u989c\u8272 \nint n,m;\nvoid bfs(){\n\tmemset(dis,0x3f,sizeof(dis));dis[1][1]=0;\n\tq.push((node){1,1,a[1][1],dis[1][1]});\n\tnode cur,nxt;\n\twhile(!q.empty()){\n\t\tcur=q.top();q.pop();\n\t\tif(dis[cur.x][cur.y]\u003Ccur.w)continue;\n\t\tfor(int i=0;i\u003C12;i++){\/\/\u61d2\u60f0\u5220\u9664 \n\t\t\tnxt.x=cur.x+dx[i];\n\t\t\tnxt.y=cur.y+dy[i];\n\t\t\tnxt.w=cur.w+dw[i];\n            if(nxt.x\u003C=0||nxt.x\u003Em||nxt.y\u003C=0||nxt.y\u003Em)continue;\/\/\u4fdd\u8bc1\u5728\u68cb\u76d8\u8303\u56f4\u5185\n\t\t\tnxt.c=a[nxt.x][nxt.y];\n\t\t\tif(!nxt.c)continue;\n\t\t\tif(cur.c!=nxt.c)nxt.w++;\/\/\u786e\u5b9a\u4e0b\u4e00\u6b65\u7684\u4fe1\u606f \n\t\t\tif(dis[nxt.x][nxt.y]\u003Enxt.w){\n\t\t\t\tdis[nxt.x][nxt.y]=nxt.w;\n\t\t\t\tq.push(nxt);\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tint x,y,c;\n\tread(m);read(n);\n\tfor(int i=1;i\u003C=n;i++){\n\t\tread(x);read(y);read(c);\n\t\ta[x][y]=c+1;\n\t}\/\/\u8fd9\u91ccc+1\uff0c\u4e3a\u4e86\u65b9\u4fbf\u533a\u5206\u65e0\u8272\u683c\u5b50 \n\tbfs();\n\tif(!a[m][m]){\/\/\u5904\u7406(m,m)\u65e0\u8272\u60c5\u51b5 \n\t\tint ans=min(dis[m][m-1],dis[m-1][m])+2;\n\t\tif(ans\u003E=inf)puts(\u0022-1\u0022);\n\t\telse printf(\u0022%d\\n\u0022,ans);\n\t}\n\telse{\n\t\tif(dis[m][m]==inf)puts(\u0022-1\u0022);\n\t\telse printf(\u0022%d\\n\u0022,dis[m][m]);\n\t}\n\treturn 0;\n}\n```\n\n2. \u6700\u77ed\u8def\uff08 `Dijkstra` \uff09\n\n\u6ce8\uff1a\u4e0b\u9762\u7684\u53c2\u8003\u7a0b\u5e8f\u4f7f\u7528 `zkw\u7ebf\u6bb5\u6811` \u4ee3\u66ff\u4f18\u5148\u961f\u5217\uff0c `zkw\u7ebf\u6bb5\u6811` \u77ed\u5c0f\u7cbe\u608d\uff0c\u5e38\u6570\u8f83\u5c0f\uff0c\u5e76\u4e14\u652f\u6301\u76f4\u63a5\u5355\u70b9\u4fee\u6539\uff0c\u4e0d\u9700\u8981\u4f18\u5148\u961f\u5217\u7684\u61d2\u60f0\u5220\u9664\u6cd5\u3002\n\n```cpp\n#include\u003Cbits\/stdc++.h\u003E\nusing namespace std;\n#define maxn 100005\n#define maxm 2000005\n#define inf 0x3f3f3f3f\ntemplate \u003Ctypename Tp\u003E\nvoid read(Tp \u0026x){\n\tchar c=getchar();x=0;int f=1;\n\twhile(c\u003C\u00270\u0027||c\u003E\u00279\u0027){if(c==\u0027-\u0027)f=-1;c=getchar();}\n\twhile(c\u003E=\u00270\u0027\u0026\u0026c\u003C=\u00279\u0027){x=x*10+c-\u00270\u0027;c=getchar();}x*=f;\n}\/\/\u5feb\u901f\u8bfb\u5165\uff0c\u4e0d\u89e3\u91ca \nstruct Edge{\n\tint f,t,w,nxt;\n}edge[maxm];\nint head[maxn],etot=1;\/\/\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u6280\u5de7\uff0c\u5b58\u56fe\u65f6\u8fb9\u6570\u521d\u503c\u8bbe\u4e3a\u4e00\u4e2a\u5947\u6570 \nvoid add_edge(int f,int t,int w){\/\/\u8fd9\u6837\u53ef\u4ee5\u5229\u7528\u4f4d\u8fd0\u7b97\u6210\u5bf9\u53d8\u5316\u627e\u5230\u53cd\u5411\u8fb9 \n\tedge[++etot]=(Edge){f,t,w,head[f]};\n\thead[f]=etot;\n}\/\/\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe \n\/\/--------\u4ee5\u4e0b\u5185\u5bb9\u4e3a zkw\u7ebf\u6bb5\u6811\n\/\/\u4e3b\u8981\u601d\u8def\uff0c\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4dis\n\/\/dis1\u6570\u7ec4\u8868\u793a\u5728\u7ebf\u6bb5\u6811\u4e2d\u7684dis\n\/\/tr\u6570\u7ec4\u8bb0\u5f55\u5f53\u524d\u6700\u5c0fdis\u5bf9\u5e94\u7684\u8282\u70b9\u7f16\u53f7 \n\/\/\u6709\u5173zkw\u7ebf\u6bb5\u6811\uff0c\u53ef\u4ee5\u53c2\u8003\u6d1b\u8c37\u65e5\u62a5\u7684\u8bb2\u89e3\uff0c\u8fd9\u91cc\u4e0d\u591a\u8bf4 \nint tr[maxn\u003C\u003C2],dis1[maxn\u003C\u003C2],bt;\nint n,m,S,T;\nvoid build(){\n\tfor(bt=1;bt\u003C=n+1;bt\u003C\u003C=1);\/\/bt\u521d\u59cb\u5316\uff0czkw\u7ebf\u6bb5\u6811\u7684\u521d\u59cb\u64cd\u4f5c \n\tfor(int i=1;i\u003C=n;i++)tr[i+bt]=i;\/\/tr\u6570\u7ec4\u521d\u59cb\u5316 \n\tmemset(dis1,0x3f,sizeof(dis1));\/\/dis1\u6570\u7ec4\u521d\u59cb\u5316 \n\t\/\/\u56e0\u4e3a\u8fd9\u91ccdis\u521d\u503c\u90fd\u662finf\uff0c\u6240\u4ee5\u53ef\u4ee5\u8fd9\u6837\u76f4\u63a5\u8d4b\u503c \n}\nvoid modify(int x,int val){\n\tdis1[x]=val;x+=bt;\/\/\u5355\u70b9\u4fee\u6539 \n\tfor(x\u003E\u003E=1;x;x\u003E\u003E=1){\/\/\u4ee5\u4e0b\u662fzkw\u7ebf\u6bb5\u6811\u5e38\u89c4\u64cd\u4f5c \n\t\tif(dis1[tr[x\u003C\u003C1]]\u003Cdis1[tr[(x\u003C\u003C1)|1]])tr[x]=tr[x\u003C\u003C1];\n\t\telse tr[x]=tr[(x\u003C\u003C1)|1];\n\t}\n}\/\/\u5176\u5b9e\u4e0a\u9762\u7684\u5185\u5bb9\u5e76\u4e0d\u662f\u5f88\u957f\uff0c\u53ea\u662f\u6ce8\u91ca\u6bd4\u8f83\u591a \nint dis[maxn];\nvoid dijkstra(){\n\tmemset(dis,0x3f,sizeof(dis));\n\tbuild();\/\/build()\u4e0d\u53ef\u5fd8 \n\tdis[S]=0;modify(S,0);\/\/\u6e90\u70b9\u66f4\u65b0 \n\tint x,y,w;\n\tfor(int j=1;j\u003C=n;j++){\/\/\u8fd9\u91cctr[1]\u7ef4\u62a4\u7684\u662f[1,n]dis\u7684\u6700\u5c0f\u503c\u7684\u8282\u70b9\u7f16\u53f7\uff0c\u6240\u4ee5\u76f4\u63a5\u8c03\u7528 \n\t\tx=tr[1];modify(x,inf);\/\/\u8fd9\u91cc\u5c06x\u8bbe\u4e3a\u6781\u5927\u503c\uff0c\u6765\u53d6\u4ee3\u5220\u9664\u64cd\u4f5c \n\t\tfor(int i=head[x];i;i=edge[i].nxt){\n\t\t\ty=edge[i].t;w=edge[i].w;\n\t\t\tif(dis[y]\u003Edis[x]+w){\/\/dijkstra\u677e\u5f1b\u64cd\u4f5c \n\t\t\t\tdis[y]=dis[x]+w;\n\t\t\t\tmodify(y,dis[y]);\/\/\u76f4\u63a5\u66f4\u65b0 \n\t\t\t}\n\t\t}\n\t}\n}\nint dx[]={0,1,0,-1,1,1,-1,-1,0,2,0,-2};\/\/12\u65b9\u5411\u53ca\u9b54\u6cd5\u4ee3\u4ef7 \nint dy[]={1,0,-1,0,1,-1,1,-1,2,0,-2,0};\nint dw[]={0,0,0,0,2,2,2,2,2,2,2,2};\nint a[105][105],cnt[105][105];\nstruct node{\n\tint x,y,c;\n}b[maxn];\n\/\/a\u5b58\u50a8\u68cb\u76d8\u4e0a\u683c\u5b50\u7684\u989c\u8272 \n\/\/cnt\u8868\u793a\u68cb\u76d8\u4e0a\u7684\u683c\u5b50\u5bf9\u5e94\u7684\u8282\u70b9\u7f16\u53f7 \nvoid preprocess(){\/\/\u5efa\u56fe \n\tint x,y,c,xx,yy,ww;\n\tfor(int i=1;i\u003C=n;i++){\n\t\tx=b[i].x;y=b[i].y;c=b[i].c;\n\t\tfor(int j=0;j\u003C12;j++){\n\t\t\txx=x+dx[j];yy=y+dy[j];ww=dw[j];\n\t\t\tif(a[xx][yy]){\n\t\t\t\tif(a[xx][yy]!=c)ww++;\n\t\t\t\tadd_edge(i,cnt[xx][yy],ww);\n\t\t\t}\n\t\t}\n\t}\/\/\u8fd9\u4e00\u6bb5\u5728\u4e0a\u6587\u9898\u89e3\u4e2d\u8bb2\u7684\u6bd4\u8f83\u8be6\u7ec6\uff0c\u8fd9\u91cc\u4e0d\u518d\u591a\u8bf4 \n\tS=cnt[1][1];\n}\nint main(){\n\tint mm,x,y,c;\n\tread(mm);read(n);\n\tfor(int i=1;i\u003C=n;i++){\n\t\tread(x);read(y);read(c);\n\t\ta[x][y]=c+1;cnt[x][y]=i;\n\t\tb[i]=(node){x,y,c+1};\n\t}\/\/\u8fd9\u91ccc+1\uff0c\u4e3a\u4e86\u65b9\u4fbf\u533a\u5206\u65e0\u8272\u683c\u5b50 \n\tpreprocess();\n\tdijkstra();\/\/\u56e0\u4e3a\u5728\u56fe\u8bba\u4e2dm\u5e38\u4ee3\u8868\u7684\u542b\u4e49\u662f\u8fb9\u6570 \n\tif(!a[mm][mm]){\/\/\u6240\u4ee5\u7528mm\u53d6\u4ee3\u539f\u9898\u76ee\u4e2d\u7684m\uff0c\u5373\u68cb\u76d8\u5927\u5c0f \n\t\tint ans=min(dis[cnt[mm][mm-1]],dis[cnt[mm-1][mm]])+2;\n\t\tif(ans\u003E=inf)puts(\u0022-1\u0022);\n\t\telse printf(\u0022%d\\n\u0022,ans);\n\t}\/\/(m,m)\u6ca1\u6709\u989c\u8272\u7684\u7279\u5224 \n\telse{\n\t\tif(dis[cnt[mm][mm]]==inf)puts(\u0022-1\u0022);\n\t\telse printf(\u0022%d\\n\u0022,dis[cnt[mm][mm]]);\n\t}\n\treturn 0;\n}\n```\n\n\u9644\uff1a\u5361\u6389\u672c\u9898 `dfs` +\u8bb0\u5fc6\u5316\u4f18\u5316(\u5373 `SPFA` )\u7684\u505a\u6cd5\uff1a\u6570\u636e\u8303\u56f4\u4fee\u6539\u4e3a $m\\le 1000,n\\le 100000$ \uff0c\u56e0\u4e3a\u672c\u9898\u662f\u68cb\u76d8\uff0c\u672c\u8eab\u5c31\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u7f51\u683c\u56fe\u7684\u4e1c\u897f\uff0c\u518d\u52a0\u4e00\u4e9b\u6bd4\u8f83\u9760\u8fd1\u7684\u6709\u8272\u683c\u5b50\uff08\u53ea\u80fd\u8bf4\u63a5\u8fd1\u83ca\u82b1\u56fe\uff0c\u56e0\u4e3a\u8fd9\u4e00\u9898\u4e00\u4e2a\u70b9\u51fa\u5ea6\u6700\u591a\u4e3a$12$\uff09\uff0c\u518d\u52a0\u4e00\u4e9b\u94fe\u72b6\u6709\u8272\u683c\u5b50\uff08\u6b21\u4f18\u89e3\u957f\u94fe\uff09\uff0c\u7406\u8bba\u4e0a\u6765\u8bb2\u5927\u90e8\u5206\u53ef\u4ee5\u5361\u6389\u4e86\u3002","categoryOld":"\u9898\u89e3","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"jmv8a0j1","title":"\u9898\u89e3 P3956 \u3010\u68cb\u76d8\u3011","time":1540268729,"author":{"uid":28910,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/28910.png","name":"\u89c8\u904d\u5343\u79cb","slogan":"\u65f6\u7a7a\u662f\u4e2a\u5706\u5708\uff0c\u76f4\u884c\u6216\u662f\u8f6c\u5f2f\uff0c\u6211\u4eec\u6700\u7ec8\u90fd\u4f1a\u76f8\u89c1\u3002","badge":"\u4e03\u6d77","isAdmin":true,"isBanned":false,"color":"Purple","ccfLevel":6,"xcpcLevel":6,"background":""},"upvote":29,"replyCount":11,"favorCount":1,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"## Update Log\n\n- 2025-08-29 \u4f7f\u7528\u589e\u91cf\u6570\u7ec4\u91cd\u5199\u4ee3\u7801\uff0c\u4fee\u6539 Latex \u4ee5\u7b26\u5408\u5ba1\u6838\u89c4\u8303\u5e76\u81ea\u5df1\u5ba1\u6838\u901a\u8fc7\u3002\n\n## \u524d\u6cbf\n\n\u672c\u65b9\u6cd5\u662f\u51fa\u4e86\u8003\u573a\u53ea\u4e09\u5206\u949f\u540e\uff0c\u548c\u540c\u5b66\u8111\u888b\u4e00\u62cd\u60f3\u51fa\u6765\u7684\uff0c**\u7ffb\u4e86\u51e0\u4e4e\u6240\u6709\u9898\u89e3\uff0c\u6ca1\u6709\u53d1\u73b0\u76f8\u540c\u89e3\u6cd5\u7684**\uff0c\u73b0\u5728\u628a\u5b83\u5199\u51fa\u6765\uff0c\u4ee5\u796d\u5960\u901d\u53bb\u7684 NOIP2017\uff0c\u8fce\u63a5\u5df2\u81f3\u7684 NOIP2018\u3002\n\n---\n\n## \u601d\u8def 1\uff1a\u641c\u7d22\n\n### \u57fa\u672c\u641c\u7d22\u601d\u8def\n\n\u5f88\u663e\u7136\uff0c\u8fd9\u662f\u4e00\u9053\u641c\u7d22\u9898\u3002\n\n\u6211\u4eec\u8003\u8651\u7528\u4e8c\u5143\u7ec4 $(x,y)$ \u4ee3\u8868\u5f53\u524d\u641c\u7d22\u5230\u7684\u683c\u5b50\uff0c\u9644\u5e26\u53c2\u6570 $q$ \u4e3a\u5df2\u7ecf\u4f7f\u7528\u7684\u91d1\u5e01\uff0c$flag$ \u4ee3\u8868\u4e0a\u4e00\u6b21\u6709\u6ca1\u6709\u4f7f\u7528\u9b54\u6cd5\u3002\n\n\u8fd9\u79cd\u641c\u7d22\u53ef\u80fd\u662f\u5927\u90e8\u5206\u4eba\u770b\u5230\u9898\u76ee\u5c31\u60f3\u5230\u7684\u7b97\u6cd5\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u6211\u6700\u540e\u63d0\u4ea4\u7684\u5c31\u662f\u8fd9\u79cd\u7206\u641c\uff0c55\u5206\uff0cTLE\u3002\n\n\u8fd9\u79cd\u8981\u5206\u5f88\u591a\u7c7b\u8ba8\u8bba\uff0c\u5e76\u4e14\u5bf9\u4e8e $flag$ \u7684\u5904\u7406\u975e\u5e38\u8ba8\u538c\u3002\n\n### \u9b54\u6cd5\u7684\u8f6c\u6362\n\n\u4e0a\u9762\u63d0\u5230\u7684\u641c\u7d22\uff0c\u662f\u5bf9 $(x,y)$ \u5468\u56f4\u56db\u4e2a\u70b9\u4e0d\u65ad\u8fdb\u884c\u62d3\u5c55\uff0c\u5230\u4e86\u7ec8\u70b9\u5c31\u8bb0\u5f55\u7b54\u6848\u3002\n\n\u5982\u56fe\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/39182.png)\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u88ab\u547d\u9898\u4eba\u7275\u7740\u9f3b\u5b50\u8d70\u4e86\u3002\n\n\u8003\u8651\u9b54\u6cd5\uff0c\u672c\u8d28\u4e0a\u662f\u5141\u8bb8\u8fd9\u4e2a\u4eba\u4ece\u8fd9\u4e2a\u70b9\u8d70\u5230\u8ddd\u79bb\u4e3a\u4e24\u683c\u7684**\u6709\u989c\u8272**\u683c\u5b50\u91cc\uff0c\u4ee3\u4ef7\u4e3a\u5728\u8d70\u5230\u76f8\u540c\u6216\u4e0d\u540c\u989c\u8272\u7684\u683c\u5b50\u4e0a\u7684\u4ee3\u4ef7 $+2$\u3002\n\n\u5373\uff0c\u5982\u56fe\uff1a\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/pic\/39181.png)\n\n\u4e0a\u56fe\u4e2d\u7eff\u8272\u683c\u5b50\u5c31\u662f\u8ddd\u79bb\u4e3a $1$ \u7684\u683c\u5b50\uff0c\u84dd\u8272\u683c\u5b50\u5c31\u662f\u8ddd\u79bb\u4e3a $2$ \u7684\u683c\u5b50\u3002\n\n**\u8bf7\u6ce8\u610f\uff0c\u65e0\u8bba\u662f\u4e0a\u56fe\u4e2d\u84dd\u8272\u6216\u8005\u7eff\u8272\u683c\u5b50\uff0c\u90fd\u5fc5\u987b\u5728\u539f\u6765\u7684\u68cb\u76d8\u4e2d\u662f\u6709\u989c\u8272\u7684**\n\n\u901a\u8fc7\u8fd9\u6837\u7684\u529e\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4f7f\u7528\/\u4e0d\u4f7f\u7528\u9b54\u6cd5\u7edf\u4e00\u8d77\u6765\uff1a\n\n- \u4e0d\u4f7f\u7528\u9b54\u6cd5\uff0c\u53ea\u80fd\u8d70 $1$ \u6b65\uff0c\u6309\u7167\u989c\u8272\u652f\u4ed8\u4ee3\u4ef7\n- \u4f7f\u7528\u9b54\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u8d70 $2$ \u6b65\uff0c\u6309\u7167\u989c\u8272\u652f\u4ed8\u4ee3\u4ef7\u4ee5\u5916\uff0c\u989d\u5916\u652f\u4ed8 $2$ \u4ee3\u4ef7\u7528\u4e8e\u67d3\u8272\u3002\n\n\u5728\u8fd9\u6837\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u5b58\u5728 $(x,y)\\to (x+2,y)$\uff0c\u4f46\u672c\u8eab $(x+1,y)$ \u662f\u6709\u989c\u8272\u7684\u60c5\u51b5\u3002\u8d70 $2$ \u6b65\u4f1a\u591a\u7b97\u4ee3\u4ef7\uff0c\u4f46\u662f\u7ed3\u5408\u4e86\u8d70 $1$ \u6b65\u7684\u65b9\u6cd5\uff0c\u6700\u7ec8\u8fd9\u4e24\u6b65\u4f1a\u7531\u8d70 $1$ \u6b65\u7684\u65b9\u6cd5\u751f\u6210\u6700\u5c0f\u7b54\u6848\u3002\n\n### \u6700\u7ec8\u641c\u7d22\u7b97\u6cd5\n\n\u6211\u4eec\u6700\u7ec8\u5f62\u6210\u4e86\u8fd9\u6837\u7684\u4e00\u4e2a\u7b97\u6cd5\uff1a\n\n\u901a\u8fc7 dfs\uff0c\u641c\u7d22\u6bcf\u4e00\u4e2a\u683c\u5b50\uff0c\u53ef\u4ee5\u5411\u5468\u56f4**\u5341\u4e8c**\u4e2a\u65b9\u5411\u62d3\u5c55\uff1a\n\n1. \u8d70 $1$ \u6b65\u7684\u65b9\u5411\uff1a\n- $(x-1,y)$\n- $(x+1,y)$\n- $(x,y-1)$\n- $(x,y+1)$\n2. \u8d70 $2$ \u6b65\u7684\u65b9\u5411\uff1a\n- $(x-1,y-1)$\n- $(x+1,y+1)$\n- $(x-1,y+1)$\n- $(x+1,y-1)$\n- $(x-2,y)$\n- $(x+2,y)$\n- $(x,y-2)$\n- $(x,y+2)$\n\n### \u526a\u679d\u4e0e\u7b54\u6848\u7edf\u8ba1\n\n\u8bbe $f[i][j]$ \u4ee3\u8868\u5230 $(i,j)$ \u65f6\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u521d\u503c\u4e3a $+\\infty$\u3002\n\n\u5982\u679c dfs \u8fdb\u5165 $(x,y)$ \u7684\u65f6\u5019\uff0c$f[x][y] \\leq q$\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u5373\u53ef\u3002\n\n\u7b54\u6848\u7edf\u8ba1\u5219\u6709\u4e00\u4e9b\u7ec6\u8282\u9700\u8981\u6ce8\u610f\u3002\u5f53 $(x,y)=(m,m)$ \u65f6\u81ea\u7136\u53ef\u4ee5\u7edf\u8ba1\u7b54\u6848\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u4e00\u4e2a\u8f6c\u5316\uff0c\u8ba9\u6240\u6709\u7684\u6b65\u5b50\u90fd\u843d\u5728\u4e86\u6709\u989c\u8272\u7684\u70b9\u4e0a\u3002\u5982\u679c $(m,m)$ \u672c\u8eab\u6ca1\u6709\u989c\u8272\uff0c\u5219\u4f1a\u9020\u6210\u65e0\u6cd5\u7edf\u8ba1\u3002\n\n\u56e0\u6b64\uff0c\u9700\u8981\u5728 $(m,m-1)$ \u6216 $(m-1,m)$ \u7684\u5730\u65b9\uff0c\u5224\u65ad $(m,m)$ \u7684\u989c\u8272\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5219\u7b54\u6848\u5bf9 $q+2$ \u53d6 min\u3002\n\n### \u4ee3\u7801\n\n\n```cpp line-numbers\n#include\u003Cbits\/stdc++.h\u003E\nusing namespace std;\n\nconst int MAXM = 100 + 7;\nconst int INF = 0x3f3f3f3f;\n\nint m, n, col[MAXM][MAXM];\nint f[MAXM][MAXM], ans = INF;\nbool vis[MAXM][MAXM];\n\nint dx[] = {1, -1, 0, 0, -2, -1, -1, 0, 0, 1, 1, 2};\nint dy[] = {0, 0, 1, -1, 0, -1, 1, -2, 2, -1, 1, 0};\nint extra[] = {0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2};\n\nbool valid(int x, int y) {\n    if(x \u003C 1 || y \u003C 1 || x \u003E m || y \u003E m) return false;\n    return true;\n}\n\nvoid dfs(int x, int y, int q) {\n    if(f[x][y] \u003C= q) return;\n    f[x][y] = q;\n\n    if(x == m \u0026\u0026 y == m) {\n        ans = min(ans, q);\n        return;\n    }\n    if(col[m][m] == 0 \u0026\u0026 x + y == 2 * m - 1) {\n        ans = min(ans, q + 2);\n        return;\n    }\n\n    vis[x][y] = true;\n    for(int i = 0; i \u003C 12; i++) {\n        int nx = x + dx[i], ny = y + dy[i];\n        if(valid(nx, ny) \u0026\u0026 col[nx][ny] != 0 \u0026\u0026 vis[nx][ny] == false) {\n            int cost = extra[i] + (col[nx][ny] == col[x][y]? 0: 1);\n            dfs(nx, ny, q + cost);\n        }\n    }\n    vis[x][y] = false;\n}\n\nint main() {\n    cin \u003E\u003E m \u003E\u003E n;\n    for(int i = 1, x, y, z; i \u003C= n; i++) {\n        cin \u003E\u003E x \u003E\u003E y \u003E\u003E z;\n        col[x][y] = z + 1;\n    }\n    memset(f, 0x3f, sizeof(f));\n    dfs(1, 1, 0);\n    if(ans == INF) ans = -1;\n    cout \u003C\u003C ans \u003C\u003C endl;\n    return 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"vxf3sb63","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1723579908,"author":{"uid":310449,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/310449.png","name":"dxzier","slogan":"\u8b66\u544a\uff1a\u516d\u5e74 OI \u4e00\u573a\u7a7a\uff0c\u597d\u5927\u559c\u529f\u89c1\u7956\u5b97\uff01\uff01\uff01 || \u8bef\u95ef\u5929\u5bb6","badge":null,"isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":7,"xcpcLevel":0,"background":""},"upvote":17,"replyCount":7,"favorCount":1,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"\u672c\u7bc7\u9898\u89e3\u601d\u60f3\u90e8\u5206\u6765\u81ea\u4e8e NOIWC2024 \u7b2c\u4e8c\u8bfe\u5802\u300a\u6700\u77ed\u8def\u7b97\u6cd5\u53ca\u5176\u5e94\u7528\u300b\u3002\u611f\u8c22 \u201c\u5317\u4eac\u5927\u5b66\u9644\u5c5e\u4e2d\u5b66 \u8096\u7136\u201d\u8001\u5e08\u7684\u8bb2\u89e3\u3002\n\n## \n\n\u9996\u5148\u5728\u9605\u8bfb\u9898\u76ee\u540e\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5\uff0c\u672c\u9898\u662f\u5728\u4e00\u4e2a $m \\times m$ \u7684\u68cb\u76d8\u4e2d\uff0c\u6bcf\u4e2a\u683c\u5b50\u6709 $0,1,$ \u7a7a \u4e09\u79cd\u60c5\u51b5\uff0c\u6bcf\u6b21\u79fb\u52a8\u53ef\u4ee5\u5411\u4e0a\u4e0b\u5de6\u53f3\u56db\u4e2a\u65b9\u5411\u79fb\u52a8\u4e00\u683c\uff0c\u4efb\u610f\u65f6\u523b\u6240\u5904\u7684\u683c\u5b50\u4e0d\u80fd\u4e3a\u7a7a\u3002\u6bcf\u8d70\u4e00\u6b65\uff1a\n\n- \u5982\u679c\u51fa\u53d1\u548c\u5230\u8fbe\u7684\u683c\u5b50\u989c\u8272\u76f8\u540c\uff0c\u4ee3\u4ef7\u4e3a $0$\u3002\n  \n- \u5982\u679c\u51fa\u53d1\u548c\u5230\u8fbe\u7684\u683c\u5b50\u989c\u8272\u4e0d\u540c\uff0c\u4ee3\u4ef7\u4e3a $1$\u3002\n\n- \u53ef\u4ee5\u6682\u65f6\u6539\u53d8\u7a7a\u4e3a $0,1$ \u4e2d\u7684\u4efb\u610f\u4e00\u79cd\uff0c\u4ee3\u4ef7\u4e3a $2$\uff0c**\u4e0d\u80fd\u8fde\u7eed\u4f7f\u7528**\u3002\n\n\u6c42\u4ece $(1,1)$ \u8d70\u5230 $(m,m)$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5bb9\u6613\u6784\u9020\u51fa\u4e0b\u56fe\uff0c\u5047\u8bbe\u5f53\u524d\u6240\u5904\u7684\u70b9\u4e3a 0\uff0c\u5176\u4e2d\u4e00\u6b65\u5c31\u80fd\u5230\u8fbe\u7684\u70b9\u4e3a 1\uff0c\u4e24\u6b65\u624d\u80fd\u5230\u8fbe\u7684\u70b9\u4e3a 2\u3002\n\n|||2|||\n|:-:|:-:|:-:|:-:|:-:|\n||2|1|2||\n|2|1|0|1|2|\n||2|1|2||\n|||2|||\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4e0d\u4e3a\u7a7a\u7684\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u65b9\u6cd5\u5efa\u56fe\uff1a\n\n- \u5982\u679c\u5728\u6807\u8bb0\u4e3a 1 \u7684\u5730\u65b9\u5b58\u5728\u70b9\uff0c\u5219\u7531\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u5411\u6b64\u70b9\u8fde\u8fb9\u5373\u53ef\uff0c\u8fb9\u6743\u7531\u989c\u8272\u5f02\u540c\u51b3\u5b9a\u3002\n\n- \u5982\u679c\u5728\u6807\u8bb0\u4e3a 2 \u7684\u5730\u65b9\u5b58\u5728\u70b9\uff0c\u884c\u8d70\u8fc7\u7a0b\u4e3a\u5148\u7531\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u8d70\u5411\u6807\u8bb0\u4e3a 1 \u7684\u70b9\uff0c\u518d\u8d70\u5411\u6807\u8bb0\u4e3a 2 \u7684\u70b9\uff0c\u4f46\u53ef\u4ee5**\u76f4\u63a5\u8fde\u63a5**\u4e00\u6761\u4ece\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u5230\u6b64\u70b9\u7684\u8fb9\uff0c\u8fb9\u6743\u7531\u989c\u8272\u5f02\u540c\u51b3\u5b9a\u540e\u518d\u52a0\u4e8c\u3002\n\n- \u5bf9\u4e8e\u6807\u8bb0\u4e3a 1 \u7684\u70b9\uff0c\u5982\u679c\u5b83\u4e3a\u7a7a\uff0c\u4f46\u5750\u6807\u5374\u4e3a $(m,m)$\uff0c\u53ef\u4ee5\u8fde\u63a5\u4e00\u6761\u7531\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u5411\u6b64\u70b9\uff0c\u8fb9\u6743\u4e3a\u4e8c\u7684\u8fb9\u3002\u5bb9\u6613\u53d1\u73b0\u4ec5\u5f53\u8be5\u70b9\u5904\u5728\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u7684\u4e0b\u65b9\u6216\u53f3\u65b9\u65f6\uff0c\u6b64\u70b9\u624d\u6709\u53ef\u80fd\u662f $(m,m)$\u3002\n\n- \u5bf9\u4e8e\u6807\u8bb0\u4e3a 2 \u7684\u70b9\uff0c\u5982\u679c\u5b83\u4e3a\u7a7a\uff0c\u4f46\u5750\u6807\u5374\u4e3a $(m,m)$\uff0c\u5bb9\u6613\u53d1\u73b0\u65e0\u6cd5**\u76f4\u63a5**\u5230\u8fbe\uff0c\u56e0\u4e3a\u65e0\u6cd5\u8fde\u7eed\u6539\u53d8\u70b9\u7684\u989c\u8272\u3002\n\n\u5728\u7b2c\u4e8c\u6761\u4e2d\uff0c\u5982\u679c\u4e2d\u95f4\u7ecf\u8fc7\u7684\u6807\u8bb0\u4e3a 1 \u7684\u70b9\u4e0d\u4e3a\u7a7a\uff0c\u8fd9\u6761\u7531\u6807\u8bb0\u4e3a 0 \u7684\u70b9**\u76f4\u63a5**\u8fde\u5411\u6807\u8bb0\u4e3a 2 \u7684\u70b9\u7684\u8fb9\u7684\u8fb9\u6743**\u5927\u4e8e\u7b49\u4e8e\u4e8c**\u3002\u800c\u5148\u7531\u6807\u8bb0\u4e3a 0 \u7684\u70b9\u8d70\u5411\u6807\u8bb0\u4e3a 1 \u7684\u70b9\uff0c\u518d\u8d70\u5411\u6807\u8bb0\u4e3a 2 \u7684\u70b9\uff0c**\u8fd9\u4e24\u6761\u8fb9\u7684\u8fb9\u6743\u4e4b\u548c\u5c0f\u4e8e\u7b49\u4e8e\u4e8c**\u3002\u6240\u4ee5\u8fd9\u6837\u7684\u975e\u6cd5\u8fde\u8fb9\u5728\u7ed3\u679c\u4e0a\u4e00\u5b9a\u4e0d\u4f1a\u66f4\u4f18\uff0c\u4e5f\u5c31\u65e0\u9700\u5bf9\u6b64\u7c7b\u975e\u6cd5\u8fb9\u8fdb\u884c\u5224\u65ad\u3002\n\n\u5efa\u56fe\u540e\u5728\u56fe\u4e0a\u8dd1\u6700\u77ed\u8def\u5373\u53ef\u3002\u5982\u679c\u65e0\u6cd5\u5230\u8fbe $(m,m)$ \u5219\u8f93\u51fa $-1$\u3002\n\n---\n\n\u4e0a\u8ff0\u5185\u5bb9\u4e0e\u5176\u5b83\u9898\u89e3\u65e0\u5f02\u3002\u8bda\u7136\uff0c\u8fd9\u662f\u4e00\u9053\u666e\u53ca\u7ec4\u7684\u9898\u76ee\uff0c\u4f46\u5728\u66f4\u5927\u7684\u6570\u636e\u8303\u56f4\u4e2d\uff0c\u539f\u89e3\u6cd5\u662f\u5426\u4ecd\u6709\u4e00\u4e9b\u4f18\u5316\u7684\u7a7a\u95f4\uff1f\n\n### \u7a00\u758f\u77e9\u9635\u5b58\u50a8\n\n\u9996\u5148\u662f\u70b9\u7684\u5b58\u50a8\u95ee\u9898\u3002\u5728\u6700\u521d\u7684\u505a\u6cd5\u4e2d\uff0c\u7531\u4e8e $m \\le 100$\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e8c\u7ef4\u6570\u7ec4\u5b58\u50a8\u6574\u4e2a\u68cb\u76d8\uff0c\u7136\u540e\u5bf9\u5176\u4e2d\u6bcf\u4e00\u4e2a\u975e\u7a7a\u70b9\u505a\u4e0a\u8ff0\u7684\u5efa\u56fe\u64cd\u4f5c\u5373\u53ef\u3002\u8fd9\u4f1a\u4f7f\u6211\u4eec\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u8fbe\u5230 $m^2$\u3002\u800c\u5982\u679c\u4e0d\u4f7f\u7528\u4e8c\u7ef4\u6570\u7ec4\uff0c\u76f4\u63a5\u5224\u65ad\u4e24\u70b9\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u5219\u4f1a\u4f7f\u65f6\u95f4\u590d\u6742\u5ea6\u8fbe\u5230 $n^2$\u3002\u4f46\u5f53 $n,m$ \u6269\u5927\u5230\u5f88\u5927\u5374\u5904\u4e8e\u540c\u4e00\u6570\u91cf\u7ea7\u65f6\uff0c\u5bb9\u6613\u53d1\u73b0\u4e8c\u7ef4\u6570\u7ec4\u4e2d\u4ec5\u6709\u6781\u5c11\u4e00\u90e8\u5206\u70b9\u662f\u771f\u6b63\u6709\u7528\u7684\u3002\n\n\u5bf9\u4e8e\u8fd9\u79cd\u7a00\u758f\u77e9\u9635\u7684\u5b58\u50a8\uff0c\u5bb9\u6613\u60f3\u5230\u4f7f\u7528\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\uff0c\u6bd4\u5982 std::unordered_map\u3002\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u5982\u4e0b\u5bf9\u8c61\u6765\u5b58\u50a8\u68cb\u76d8\u4e2d\u7684\u6709\u6548\u70b9\u3002\n\n```cpp\nstd::unordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E M;\n```\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5e38\u6570\u7a0d\u5927\u7684\u4e8c\u7ef4\u6570\u7ec4\uff0c\u4f46\u5176\u5e73\u5747\u65f6\u7a7a\u590d\u6742\u5ea6\u4ecd\u7136\u662f $O(n)$ \u7684\u3002\n\n### \u7279\u6b8a\u6761\u4ef6\u4e0b\u7684\u7ebf\u6027\u5355\u6e90\u6700\u77ed\u8def\n\n#### $0\/1$ BFS\n\n\u8ba9\u6211\u4eec\u91cd\u65b0\u5ba1\u89c6\u5355\u6e90\u6700\u77ed\u8def\u95ee\u9898\u3002\u9996\u5148\u8003\u8651\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u8fb9\u6743\u53ea\u6709 $0\/1$ \u4e24\u79cd\u53d6\u503c\u3002\u5bf9\u4e8e\u8fd9\u6837\u7684\u56fe\u5728 BFS \u65f6\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u961f\u5217\uff0c\u6bcf\u6b21\u53d6\u4e24\u4e2a\u961f\u5217\u961f\u5934\u4e2d\u5df2\u7ecf\u8fc7\u957f\u5ea6 $dis$ \u8f83\u5c0f\u7684\u4e00\u4e2a\u5143\u7d20\u3002\u5bf9\u4e8e\u6b64\u70b9\u8fde\u5411\u7684\u8fd8\u6ca1\u904d\u5386\u8fc7\u7684\u70b9\uff0c\u5982\u679c\u8fb9\u6743\u4e3a $0$ \u5219\u52a0\u5165\u7b2c\u96f6\u4e2a\u961f\u5217\uff0c\u5982\u679c\u8fb9\u6743\u4e3a $1$ \u5219\u52a0\u5165\u7b2c\u4e00\u4e2a\u961f\u5217\u3002\n\n\u82e5\u4fdd\u8bc1\u961f\u5217\u96f6\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u76f8\u540c\uff0c\u961f\u5217\u4e00\u961f\u5934\u5143\u7d20\u7684 $dis$ \u5927\u4e8e\u7b49\u4e8e\u961f\u5217\u96f6\u961f\u5934\u5143\u7d20\u7684 $dis$\uff0c\u4e14\u961f\u5217\u4e00\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4e24\u961f\u5217\u961f\u5934\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u5927\u4e00\u3002\n\n- \u4e00\u4e2a\u5143\u7d20\u88ab\u63d2\u5165\u961f\u5217\u4e00\uff0c\u5176 $dis$ \u4ec5\u6bd4\u6b64\u65f6\u961f\u5934\u4e2d $dis$ \u8f83\u5c0f\u7684\u90a3\u4e2a\u5927\u4e00\uff0c\u5219\u65b0\u63d2\u5165\u961f\u5217\u4e00\u7684\u5143\u7d20\u53ef\u4ee5\u4fdd\u8bc1\u961f\u5217\u4e00\u4ecd\u7136\u5177\u6709\u539f\u6027\u8d28\uff0c\u5219\u6b64\u65f6\u539f\u6709\u4e09\u9879\u6027\u8d28\u5747\u4e0d\u53d8\u3002\n\n- \u4e00\u4e2a\u5143\u7d20\u88ab\u63d2\u5165\u961f\u5217\u96f6\uff0c\u82e5\u6765\u81ea\u961f\u5217\u96f6\u5219\u539f\u6709\u4e09\u9879\u6027\u8d28\u5747\u4e0d\u53d8\u3002\n\n- \u4e00\u4e2a\u5143\u7d20\u88ab\u63d2\u5165\u961f\u5217\u96f6\uff0c\u82e5\u6765\u81ea\u961f\u5217\u4e00\uff0c\u5219\u961f\u5217\u4e00\u961f\u5934\u5143\u7d20 $dis$ \u4e0e\u961f\u5217\u96f6\u961f\u5934\u5143\u7d20 $dis$ \u76f8\u540c\uff0c\u6216\u961f\u5217\u96f6\u4e3a\u7a7a\u3002\u5bf9\u4e8e\u4e24\u79cd\u5b50\u60c5\u51b5\u539f\u6709\u4e09\u9879\u6027\u8d28\u5747\u4e0d\u53d8\u3002\n\n- \u521d\u59cb\u60c5\u51b5\u4e0b\u4e24\u961f\u5217\u5747\u4e3a\u7a7a\uff0c\u5411\u4efb\u610f\u961f\u5217\u52a0\u5165\u521d\u59cb\u5143\u7d20\uff0c\u5747\u5177\u6709\u4e0a\u8ff0\u4e09\u9879\u6027\u8d28\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u53d6\u5230\u5143\u7d20\u7684 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\uff0c\u6240\u4ee5\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5904\u7406\u8fb9\u6743\u4ec5\u6709 $0\/1$ \u7684\u56fe\u4e0a\u7684\u5355\u6e90\u6700\u77ed\u8def\u95ee\u9898\u3002\n\n#### $1\/2$ BFS\n\n\u5bf9\u4e8e\u8fd9\u6837\u7684\u56fe\u540c\u6837\u53ef\u4ee5\u5728 BFS \u65f6\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u961f\u5217\uff0c\u6bcf\u6b21\u53d6\u4e24\u4e2a\u961f\u5217\u961f\u5934\u4e2d\u5df2\u7ecf\u8fc7\u957f\u5ea6 $dis$ \u8f83\u5c0f\u7684\u4e00\u4e2a\u5143\u7d20\u3002\u5bf9\u4e8e\u6b64\u70b9\u8fde\u5411\u7684\u8fd8\u6ca1\u904d\u5386\u8fc7\u7684\u70b9\uff0c\u5982\u679c\u8fb9\u6743\u4e3a $1$ \u5219\u52a0\u5165\u7b2c\u4e00\u4e2a\u961f\u5217\uff0c\u5982\u679c\u8fb9\u6743\u4e3a $2$ \u5219\u52a0\u5165\u7b2c\u4e8c\u4e2a\u961f\u5217\u3002\n\n\u6b64\u65f6\u8bc1\u660e\u751a\u81f3\u66f4\u52a0\u7b80\u5355\uff0c\u4ec5\u6709\u4e24\u6761\u6027\u8d28\uff1a\n\n\u961f\u5217\u4e00\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4e24\u961f\u5217\u961f\u5934\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u5927\u4e00\uff0c\u4e14\u961f\u5217\u4e8c\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4e24\u961f\u5217\u961f\u5934\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u5927\u4e8c\u3002\n\n\u4ec5\u9700\u540c\u7406\u8bc1\u660e\u5982\u4e0a\u4e24\u6761\u6027\u8d28\u65f6\u523b\u6210\u7acb\uff0c\u5373\u53ef\u4fdd\u8bc1\u6bcf\u6b21\u53d6\u5230\u5143\u7d20\u7684 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\uff0c\u6240\u4ee5\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5904\u7406\u8fb9\u6743\u4ec5\u6709 $1\/2$ \u7684\u56fe\u4e0a\u7684\u5355\u6e90\u6700\u77ed\u8def\u95ee\u9898\u3002\u8bc1\u660e\u8fc7\u7a0b\u4e0d\u518d\u8d58\u8ff0\u3002\n\n#### $a\/b$ BFS $a,b\u003E0$ \u4e14 $a \\neq b$\n\n\u4e0e $1\/2$ BFS \u7c7b\u4f3c\uff0c\u8bc1\u660e\u5982\u4e0b\u4e24\u6761\u6027\u8d28\u65f6\u523b\u6210\u7acb\uff1a\n\n\u961f\u5217\u4e00\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4e24\u961f\u5217\u961f\u5934\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u5927 $a$\uff0c\u4e14\u961f\u5217\u4e8c\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4e24\u961f\u5217\u961f\u5934\u4e2d\u8f83\u5c0f\u7684\u90a3\u4e2a\u5927 $b$\u3002\n\n\u7531\u4e8e\u4e24\u6761\u6027\u8d28\u65f6\u523b\u6210\u7acb\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u6b21\u53d6\u5230\u5143\u7d20\u7684 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\uff0c\u6240\u4ee5\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5904\u7406\u8fb9\u6743\u4ec5\u6709 $a\/b$ \u7684\u56fe\u4e0a\u7684\u5355\u6e90\u6700\u77ed\u8def\u95ee\u9898\u3002\u8bc1\u660e\u8fc7\u7a0b\u540c\u6837\u4e0d\u518d\u8d58\u8ff0\u3002\n\n#### \u591a\u8fb9\u6743 BFS\n\n\u4ece\u4e0a\u9762\u7684\u601d\u8003\u5bb9\u6613\u60f3\u5230\u53ef\u4ee5\u5bf9\u6bcf\u4e00\u79cd\u8fb9\u6743\u5efa\u7acb\u4e00\u4e2a\u961f\u5217\uff0c\u5bb9\u6613\u8bc1\u660e\u8fc7\u7a0b\u4e2d\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u961f\u5217 $i$ \u5747\u4fdd\u6301\u961f\u5217\u4e2d\u6bcf\u4e2a\u5143\u7d20 $dis$ \u5355\u8c03\u4e0d\u9012\u51cf\u4e14\u6700\u591a\u6bd4\u4efb\u610f\u4e00\u4e2a\u961f\u5217\u961f\u5934\u4e2d\u6700\u5c0f\u7684\u90a3\u4e2a\u5927 $i$\u3002\n\n\u5047\u8bbe\u6709 $k$ \u79cd\u4e0d\u540c\u8fb9\u6743\uff0c\u6bcf\u6b21\u9009\u51fa\u5176\u4e2d\u961f\u5934\u5143\u7d20\u7684 $dis$ \u6700\u5c0f\u7684\u4e00\u4e2a\u5219\u9700\u8981 $O(k)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5f53 $k$ \u5f88\u5c0f\uff0c\u4e14\u4e0e\u9898\u76ee\u8f93\u5165\u65e0\u5173\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u8ba1\u5165\u590d\u6742\u5ea6\u5c06\u5176\u770b\u4f5c\u5e38\u6570\u3002\u6240\u4ee5\u5f53 $k$ \u8db3\u591f\u5c0f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u6b64\u65f6\u6700\u77ed\u8def\u7b97\u6cd5\u4e3a\u7ebf\u6027\u3002\uff08\u53c2\u8003\u201c\u5357\u4eac\u5916\u56fd\u8bed\u5b66\u6821 \u6768\u654f\u884c\u201d\u300a\u6d45\u8c08\u590d\u6742\u5ea6\u53ca\u5176\u5728\u89e3\u51b3\u95ee\u9898\u65b9\u9762\u7684\u5e94\u7528\u300b\uff09\n\n\u4f46\u5f53 $k$ \u5f88\u5927\u65f6\uff0c\u8fd9\u6837\u7684\u505a\u6cd5\u663e\u7136\u662f\u4e0d\u4f18\u7684\uff0c\u4e8e\u662f\u53ef\u4ee5\u60f3\u5230\u7528\u4f18\u5148\u961f\u5217\u7ef4\u62a4\u6bcf\u4e2a\u961f\u5217\u961f\u5934\u7684\u5143\u7d20\u3002\u6b64\u65f6\u53d1\u73b0\u4ee3\u7801\u592a\u8fc7\u590d\u6742\uff0c\u4e8e\u662f\u518d\u7b80\u5316\u4e00\u4e0b\u4ee3\u7801\uff0c\u628a\u6240\u6709\u5143\u7d20\u5168\u90e8\u4e22\u8fdb\u4f18\u5148\u961f\u5217\uff01\u4e8e\u662f\uff01\u6211\u4eec\u60ca\u5947\u7684\u53d1\u73b0\uff01\u6211\u4eec\u91cd\u65b0\u53d1\u660e\u4e86 Dijkstra \u7b97\u6cd5\uff01\n\n\uff08\uff08\u8096\u8001\u5e08\uff1a\u65e9\u751f\u4e94\u5341\u5e74\uff0c\u4f60\u4e5f\u80fd\u53d1\u660e\u8fd9\u4e9b\u7b97\u6cd5\u3002\n\n## \n\n\u6839\u636e\u4e0a\u8ff0\u6240\u6709\u5185\u5bb9\uff0c\u53ef\u4ee5\u53d1\u73b0\u6b64\u9898\u4e2d\u5f53 $n,m$ \u6269\u5927\u5230\u5f88\u5927\u5374\u5904\u4e8e\u540c\u4e00\u6570\u91cf\u7ea7\u65f6\u68cb\u76d8\u4e3a\u7a00\u758f\u77e9\u9635\uff0c\u4e14\u4ec5\u51fa\u73b0\u8fb9\u6743 $0\/1\/2\/3$\uff0c\u4e8e\u662f\u53ef\u4ee5\u7ebf\u6027\u89e3\u51b3\u3002\n\n\n```cpp\n#include \u003Ccstdio\u003E\n#include \u003Cvector\u003E\n#include \u003Cqueue\u003E\n#include \u003Cunordered_map\u003E\nusing std::unordered_map;\nstruct edge{\n\tint U,V,W;\n};\nstruct point{\n\tint id,W;\n};\n\nint n=0,m=0;\nint s=0,t=0;\n\nunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E M;\nunordered_map\u003Cint,std::vector\u003Cedge\u003E\u003E v;\nvoid add(int s1,int s2,int w0){\n\tint id1=s1\u003E\u003E1,c1=(s1\u00261);\n\tint id2=s2\u003E\u003E1,c2=(s2\u00261);\n\tif(!(s2==t\u0026\u0026t==0)){\n\t\tif(c1!=c2)\n\t\t\tw0++;\n\t}\n\t(v[id1]).push_back({id1,id2,w0});\n\treturn;\n}\nvoid buildmap(){\n\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator it1=M.begin();\n\twhile(it1!=M.end()){\n\t\tunordered_map\u003Cint,int\u003E::iterator it2=(it1-\u003Esecond).begin();\n\t\twhile(it2!=(it1-\u003Esecond).end()){\n\t\t\tint x=it1-\u003Efirst,y=it2-\u003Efirst;\n\t\t\t\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i1=M.find(x-1);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i2=M.find(x);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i3=i2;\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i4=M.find(x+1);\n\t\t\t\/\/x-1,y\n\t\t\tif(i1!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i1-\u003Esecond).find(y);\n\t\t\t\tif(in0!=(i1-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,0);\n\t\t\t}\n\t\t\t\/\/x,y-1\n\t\t\tif(i2!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i2-\u003Esecond).find(y-1);\n\t\t\t\tif(in0!=(i2-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,0);\n\t\t\t}\n\t\t\t\/\/x,y+1\n\t\t\tif(i3!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i3-\u003Esecond).find(y+1);\n\t\t\t\tif(in0!=(i3-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,0);\n\t\t\t\telse if(x==m\u0026\u0026(y+1)==m)\n\t\t\t\t\tadd(it2-\u003Esecond,t,2);\n\t\t\t}\n\t\t\t\/\/x+1,y\n\t\t\tif(i4!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i4-\u003Esecond).find(y);\n\t\t\t\tif(in0!=(i4-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,0);\n\t\t\t\telse if((x+1)==m\u0026\u0026y==m)\n\t\t\t\t\tadd(it2-\u003Esecond,t,2);\n\t\t\t}\n\t\t\telse if((x+1)==m\u0026\u0026y==m)\n\t\t\t\tadd(it2-\u003Esecond,t,2);\n\t\t\t\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i21=M.find(x-2);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i22=M.find(x-1);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i23=i22;\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i24=M.find(x);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i25=i24;\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i26=M.find(x+1);\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i27=i26;\n\t\t\tunordered_map\u003Cint,unordered_map\u003Cint,int\u003E\u003E::iterator i28=M.find(x+2);\n\t\t\t\/\/x-2,y\n\t\t\tif(i21!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i21-\u003Esecond).find(y);\n\t\t\t\tif(in0!=(i21-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x-1,y-1\n\t\t\tif(i22!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i22-\u003Esecond).find(y-1);\n\t\t\t\tif(in0!=(i22-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x-1,y+1\n\t\t\tif(i23!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i23-\u003Esecond).find(y+1);\n\t\t\t\tif(in0!=(i23-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x,y-2\n\t\t\tif(i24!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i24-\u003Esecond).find(y-2);\n\t\t\t\tif(in0!=(i24-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x,y+2\n\t\t\tif(i25!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i25-\u003Esecond).find(y+2);\n\t\t\t\tif(in0!=(i25-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x+1,y-1\n\t\t\tif(i26!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i26-\u003Esecond).find(y-1);\n\t\t\t\tif(in0!=(i26-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x+1,y+1\n\t\t\tif(i27!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i27-\u003Esecond).find(y+1);\n\t\t\t\tif(in0!=(i27-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\t\/\/x+2,y\n\t\t\tif(i28!=M.end()){\n\t\t\t\tunordered_map\u003Cint,int\u003E::iterator in0=(i28-\u003Esecond).find(y);\n\t\t\t\tif(in0!=(i28-\u003Esecond).end())\n\t\t\t\t\tadd(it2-\u003Esecond,in0-\u003Esecond,2);\n\t\t\t}\n\t\t\tit2++;\n\t\t}\n\t\tit1++;\n\t}\n\treturn;\n}\n\nstd::vector\u003Cint\u003E h;\nstd::queue\u003Cpoint\u003E q[4];\npoint getq(){\n\tint j=-1;\n\tpoint ret={-1,2147483647};\n\tfor(int i=0;i\u003C=3;i++){\n\t\tif(!q[i].empty()){\n\t\t\tpoint f=q[i].front();\n\t\t\tif(f.W\u003Cret.W){\n\t\t\t\tret=f;\n\t\t\t\tj=i;\n\t\t\t}\n\t\t}\n\t}\n\tif(j==-1) return {-1,0};\n\tq[j].pop();\n\treturn ret;\n}\nlong long BFS(){\n\tlong long ans=-1;\n\tq[0].push({s,0});\n\twhile(1){\n\t\tpoint tp=getq();\n\t\tif(tp.id==t){\n\t\t\tans=tp.W;\n\t\t\tbreak;\n\t\t}\n\t\tif(tp.id\u003C0) break;\n\t\tif(h[tp.id]!=0) continue;\n\t\th[tp.id]=1;\n\t\tunordered_map\u003Cint,std::vector\u003Cedge\u003E\u003E::iterator v0=v.find(tp.id);\n\t\tif(v0!=v.end()){\n\t\t\tfor(int i=0;i\u003C(v0-\u003Esecond).size();i++){\n\t\t\t\tedge tedge=(v0-\u003Esecond)[i];\n\t\t\t\tq[tedge.W].push({tedge.V,tp.W+tedge.W});\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tscanf(\u0022%d%d\u0022,\u0026m,\u0026n);\n\th.push_back(0);\n\tfor(int i=1;i\u003C=n;i++){\n\t\tint x,y,c;\n\t\tscanf(\u0022%d%d%d\u0022,\u0026x,\u0026y,\u0026c);\n\t\t(M[x])[y]=(i\u003C\u003C1)+c;\n\t\th.push_back(0);\n\t\tif(x==1\u0026\u0026y==1) s=i;\n\t\tif(x==m\u0026\u0026y==m) t=i;\n\t}\n\tbuildmap();\n\tprintf(\u0022%lld\u0022,BFS());\n\treturn 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"o3qxqzll","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1736170187,"author":{"uid":1020835,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1020835.png","name":"__galaxy_1202__","slogan":"\u5750\u6807SH || \u521d\u4e00 || \u4e0d\u62ff\u84dd\u52fe\u4e0d\u6539\u7b7e || \u561f\u561f\u561f","badge":null,"isAdmin":false,"isBanned":false,"color":"Orange","ccfLevel":4,"xcpcLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/j0cbrbsg.png"},"upvote":17,"replyCount":8,"favorCount":2,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"## \u89e3\u9898\u601d\u8def\uff1a\n\u66b4\u529b\u51fa\u5947\u8ff9\uff01\u6570\u636e\u8303\u56f4\u4e0d\u5927\uff0c\u8ddf\u7740\u9898\u610f\u76f4\u63a5\u7206\u641c\u52a0\u526a\u679d\u5373\u53ef\u3002  \n\n\u5bf9\u4e8e\u8fd9\u79cd\u6c42\u6700\u5c0f\u503c\u7684\u7206\u641c\uff0c\u4e00\u4e2a\u975e\u5e38\u7384\u5b66\u4e14\u6709\u6548\u7684\u526a\u679d\u5c31\u662f\u8bb0\u5f55\u6bcf\u4e2a\u683c\u5b50\u5f53\u524d\u6240\u7528\u7684\u6700\u77ed\u65f6\u95f4\u3002  \n\n\u7136\u540e\u5c31\u6ca1\u4e86\u3002\u8981\u6ce8\u610f\u628a\u7b2c\u4e00\u4e2a\u70b9\u521d\u59cb\u5316\u597d~~\u5f53\u521d `dict` \u7b2c\u4e00\u4e2a\u70b9\u6ca1\u521d\u59cb\u5316\u8c03\u4e86\u6211\u534a\u5929\u3002~~\n\n## CODE\uff1a\n\n```cpp\n#include\u003Ciostream\u003E\nusing namespace std;\nint m, n, x, y, c, ans = 1e9, dict[101][101], num[101][101];\nint xy[4][2]{{0, 1}, {0, -1}, {1, 0}, {-1, 0}};\nbool vis[101][101];\nvoid dfs(int x, int y, int now, int lst)\n{\n    if (now \u003E ans) return;\n    if (x == m \u0026\u0026 y == m)\n    {\n        ans = min(ans, now);\n        return;\n    }\n    for (int i = 0; i \u003C 4; i++)\n    {\n        int dx = x + xy[i][0], dy = y + xy[i][1];\n        if (dx \u003E= 1 \u0026\u0026 dx \u003C= m \u0026\u0026 dy \u003E= 1 \u0026\u0026 dy \u003C= m \u0026\u0026 vis[dx][dy] == 0 \u0026\u0026 (num[x][y] != -1 || num[dx][dy] != -1))\n        {\n            if (num[dx][dy] == -1) \n            {\n                if (now + 2 \u003C dict[dx][dy])\n                {\n                    vis[dx][dy] = 1;\n                    dict[dx][dy] = now + 2;\n                    dfs(dx, dy, now + 2, lst);\n                    vis[dx][dy] = 0;\n                }\n            }\n            else\n            {\n                if (num[dx][dy] == lst)\n                {\n                    if (now \u003C dict[dx][dy])\n                    {\n                        vis[dx][dy] = 1;\n                        dict[dx][dy] = now;\n                        dfs(dx, dy, now, lst);\n                        vis[dx][dy] = 0;\n                    }\n                }\n                else\n                {\n                    if (now + 1 \u003C dict[dx][dy])\n                    {\n                        vis[dx][dy] = 1;\n                        dict[dx][dy] = now + 1;\n                        dfs(dx, dy, now + 1, num[dx][dy]);\n                        vis[dx][dy] = 0;\n                    }\n                }\n            }\n        }\n    }\n}\nint main()\n{\n    cin \u003E\u003E m \u003E\u003E n;\n    for (int i = 1; i \u003C= m; i++)\n    {\n        for (int j = 1; j \u003C= m; j++)\n        {\n            num[i][j] = -1;\n            dict[i][j] = 1e9;\n        }\n    }\n    while (n--)\n    {\n        cin \u003E\u003E x \u003E\u003E y \u003E\u003E c;\n        num[x][y] = c;\n    }\n    vis[1][1] = 1;\n    dict[1][1] = 0;\n    dfs(1, 1, 0, num[1][1]);\n    if (ans == 1e9) cout \u003C\u003C -1;\n    else cout \u003C\u003C ans;\n    return 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"5y9oxafu","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1736050938,"author":{"uid":349824,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/349824.png","name":"WsW_","slogan":"\u6b22\u8fce\u5165\u7fa4872763867||\u9898\u89e3\u6c42\u8d5e\uff01\u9898\u89e3\u770b\u4e0d\u61c2\u8bf7\u79c1\u4fe1","badge":"\u82b1\u901d\u7206\u96f6\u4eba","isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":6,"xcpcLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/p9ppqy9e.png"},"upvote":18,"replyCount":3,"favorCount":0,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"### \u601d\u8def\n\u5982\u679c\u6ca1\u6709\u989c\u8272\u7684\u9650\u5236\uff0c\u8fd9\u9898\u5c31\u662f\u5e38\u89c4\u7684 bfs \u5355\u6e90\u6700\u77ed\u8def\u3002\u4f46\u662f\u6709\u4e86\u989c\u8272\u9650\u5236\uff0c\u8003\u8651\u591a\u4e86\u8fd9\u4e9b\u9650\u5236\u4f1a\u600e\u6837\u3002  \n\u5982\u679c\u4f60\u719f\u6089\u201c\u5206\u5c42\u56fe\u201d\uff0c\u90a3\u5c31\u5e94\u8be5\u77e5\u9053\u51e0\u4e4e\u6240\u6709**\u591a\u4e86\u5176\u4ed6\u9650\u5236**\u7684\u5355\u6e90\u6700\u77ed\u8def\uff0c\u90fd\u53ef\u4ee5\u7528\u201c\u5206\u5c42\u56fe\u201d\u7684\u601d\u60f3\u89e3\u51b3\u3002  \n\u201c\u5206\u5c42\u56fe\u201d\u7b80\u5355\u6765\u8bf4\u5c31\u662f\uff0c\u4e0d\u4ec5\u4ec5\u4ee5\u5230\u8fbe\u7684**\u70b9**\u5b9a\u4e49\u72b6\u6001\uff0c\u8fd8\u901a\u8fc7\u9898\u4e2d\u6240\u7ed9\u7684\u4e00\u4e9b**\u7279\u6b8a\u9650\u5236**\u6765\u5b9a\u4e49\u72b6\u6001\u3002  \n\u5728\u5e38\u89c4\u7684 bfs \u5355\u6e90\u6700\u77ed\u8def\u4e2d\uff0c\u4ec5\u4ec5\u4ee5\u5230\u8fbe\u7684\u70b9\u6765\u5b9a\u4e49\u72b6\u6001\uff0c\u5b58\u50a8\u7684\u662f\u5230\u67d0\u4e2a\u70b9\u7684\u6700\u5c0f\u82b1\u8d39\u3002  \n\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u72b6\u6001\u4e3a\u201c\u5230\u8fbe\u7684\u683c\u5b50\u5750\u6807\uff0c\u8fd9\u4e2a\u683c\u5b50\u7684\u989c\u8272\uff0c\u662f\u5426\u5728\u8fd9\u4e2a\u683c\u5b50\u4e0a\u4f7f\u7528\u4e86\u9b54\u6cd5\u201d\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u672c\u6765\u5c31\u6709\u989c\u8272\u7684\u683c\u5b50\uff0c\u5b83\u7684\u72b6\u6001\u4e3a\u201c\u8fd9\u4e2a\u683c\u5b50\u7684\u5750\u6807\uff0c\u8fd9\u4e2a\u683c\u5b50\u672c\u6765\u7684\u989c\u8272\uff0c\u672a\u4f7f\u7528\u9b54\u6cd5\u201d\uff1b\u5bf9\u4e8e\u4e00\u4e2a\u672c\u6765\u6ca1\u6709\u989c\u8272\u7684\u683c\u5b50\uff0c\u5b83\u7684\u72b6\u6001\u4e3a\u201c\u8fd9\u4e2a\u683c\u5b50\u7684\u5750\u6807\uff0c\u7ea2\u8272\u6216\u8005\u9ec4\u8272\uff0c\u4f7f\u7528\u4e86\u9b54\u6cd5\u201d\u3002  \n\u5e94\u5f53\u5206\u522b\u5b58\u50a8\u5230\u8fbe\u4e0d\u540c\u7684\u72b6\u6001\u6240\u9700\u8981\u7684\u6700\u5c0f\u82b1\u8d39\u3002  \n\n\u5728\u8fdb\u884c bfs \u5355\u6e90\u6700\u77ed\u8def\u65f6\uff0c\u6839\u636e\u9898\u76ee\u9650\u5236\uff0c\u4ece\u4e00\u79cd\u72b6\u6001\u8f6c\u79fb\u5230\u53e6\u4e00\u79cd\u72b6\u6001\u5373\u53ef\u3002\n\n---\n### \u4ee3\u7801\n\u8fd9\u662f\u4ee5\u524d\u7684\u4ee3\u7801\uff0c\u5e76\u4e0d\u662f\u6839\u636e\u201c\u5206\u5c42\u56fe\u201d\u7684\u601d\u60f3\u5199\u7684\u3002  \n\u4e4b\u540e\u5c06\u4f1a\u66f4\u65b0\u4ee3\u7801\u3002\n```cpp\n#include\u003Cbits\/stdc++.h\u003E\nusing namespace std;\nstruct node{\n\tint x,y,w,col;\n\tbool magic;\n};\nqueue\u003Cnode\u003Eq;\nint mp[103][103],ans[103][103];\nint dir[4][2]={0,1,0,-1,1,0,-1,0};\nint m;\nvoid bfs(){\n\tq.push({1,1,0,mp[1][1],0});\n\tans[1][1]=0;\n\twhile(!q.empty()){\n\t\tnode z=q.front();\n\t\tq.pop();\n\t\tint x=z.x,y=z.y,col=z.col,w=z.w;\n\t\tbool f=z.magic;\n\t\tfor(int i=0;i\u003C4;i++){\n\t\t\tint nx=x+dir[i][0];\n\t\t\tint ny=y+dir[i][1];\n\t\t\tif(nx\u003C1||ny\u003C1||nx\u003Em||ny\u003Em||(f\u0026\u0026!mp[nx][ny]))continue;\n\t\t\tint cost,ncol;\n\t\t\tbool nf;\n\t\t\tif(mp[nx][ny]){\n\t\t\t\tnf=0;\n\t\t\t\tcost=(col!=mp[nx][ny]);\n\t\t\t\tncol=mp[nx][ny];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tnf=1;\n\t\t\t\tcost=2;\n\t\t\t\tncol=col;\n\t\t\t}\n\t\t\tif(w+cost\u003Cans[nx][ny]){\n\t\t\t\tans[nx][ny]=w+cost;\n\t\t\t\tq.push({nx,ny,w+cost,ncol,nf});\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tint n;\n\tscanf(\u0022%d%d\u0022,\u0026m,\u0026n);\n\tfor(int i=1;i\u003C=n;i++){\n\t\tint x,y,c;\n\t\tscanf(\u0022%d%d%d\u0022,\u0026x,\u0026y,\u0026c);\n\t\tmp[x][y]=c+1;\n\t}\n\tfor(int i=1;i\u003C=m;i++){\n\t\tfor(int j=1;j\u003C=m;j++){\n\t\t\tans[i][j]=1e9;\n\t\t}\n\t}\n\tbfs();\n\tif(ans[m][m]==1e9){\n\t\tprintf(\u0022-1\u0022);\n\t\treturn 0;\n\t}\n\tprintf(\u0022%d\\n\\n\u0022,ans[m][m]);\n\treturn 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"8fc7b3rr","title":"[NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8 \u9898\u89e3","time":1736164729,"author":{"uid":791222,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/791222.png","name":"lby_commandBlock","slogan":"\u964d\u6a59\u4e86\u597d\u96be\u53d7 | \u4e34\u65f6\u4e3b\u9875 https:\/\/www.luogu.com.cn\/paste\/pr8127fq","badge":null,"isAdmin":false,"isBanned":false,"color":"Orange","ccfLevel":5,"xcpcLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/bphzuaay.png"},"upvote":11,"replyCount":8,"favorCount":0,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"## \u524d\u8a00\n\n\u901a\u8fc7\u89c2\u5bdf\u9898\u76ee~~\u6807\u7b7e~~\u53ef\u77e5\uff0c\u8be5\u9898\u662f\u4e00\u9053\u6700\u77ed\u8def\u9898\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u7528\u641c\u7d22\u505a\u3002\u8fd9\u7bc7\u9898\u89e3\u6211\u4eec\u4f7f\u7528 BFS \u8fdb\u884c\u4e3e\u4f8b\u3002\n\n## \u601d\u8def\n\n**BFS \u72b6\u6001\u5b9a\u4e49**\n\n\u8be5\u9898\u53d1\u73b0\u6709 $4$ \u4e2a\u4e1c\u897f\u975e\u5e38\u91cd\u8981\uff08\u82e5\u6ca1\u6709\u641e\u61c2\uff0c\u5219\u53ef\u4ee5\u5148\u770b BFS \u8f6c\u79fb\uff09\uff1a\n\n1. \u5f53\u524d\u4f4d\u7f6e\u3002\n2. \u4f4d\u7f6e\u7684\u989c\u8272\u3002\n3. \u662f\u5426\u4f7f\u7528\u8fc7\u9b54\u6cd5\u3002\n4. \u4f7f\u7528\u7684\u91d1\u5e01\u6570\u91cf\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u7684 BFS \u72b6\u6001\u5c31\u5b9a\u4e49\u4e3a\u8fd9\u56db\u4e2a\u4e1c\u897f\u3002\n\n**BFS \u8f6c\u79fb**\n\n\u8fd9\u9053\u9898\u7684\u7ec6\u8282\u975e\u5e38\u591a\uff0c\u8fd9\u91cc\u6211\u8bb2\u8be6\u7ec6\u4e00\u70b9\u3002\n\n\u6211\u4eec\u5148\u6765\u5224\u65ad\u54ea\u79cd\u72b6\u6001\u4e0d\u5408\u7406\u3002\n\n- \u7b2c\u4e00\u662f\u8d85\u51fa\u5730\u56fe\u8303\u56f4\uff0c\u5e94\u8be5\u653e\u5f03\u8fd9\u79cd\u72b6\u6001\u3002\n- \u7b2c\u4e8c\u662f\u8be5\u9898\u4e2d\u7279\u6709\u7684\uff0c\u90a3\u5c31\u662f\u5904\u7406**\u4e0d\u80fd\u8fde\u7eed\u4f7f\u7528\u9b54\u6cd5**\u7684\u60c5\u51b5\u3002\u4f46\u662f\u7531\u4e8e\u6211\u4eec\u4e0a\u9762\u5b9a\u4e49\u4e86\u662f\u5426\u4f7f\u7528\u8fc7\u9b54\u6cd5\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u4f7f\u7528\u8fc7\u9b54\u6cd5\u4e14\u8be5\u683c\u5b50\u662f\u5426\u6ca1\u6709\u989c\u8272\uff08\u4e5f\u5c31\u662f\u9700\u8981\u9b54\u6cd5\uff09\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u6b63\u513f\u516b\u7ecf\u7684\u8f6c\u79fb\u4e86\uff0c\u4e0b\u9762\u90fd\u662f\u5408\u7406\u7684\u60c5\u51b5\u3002\n\n---\n\n\u6211\u4eec\u5148\u8003\u8651**\u4e0b\u4e00\u6b21** BFS \u7684\u683c\u5b50**\u5982\u679c\u6709\u989c\u8272**\u7684\u60c5\u51b5\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/jk1byovz.png)\n\n- \u7b2c\u4e00\u79cd\uff0c\u82e5\u4e0b\u4e00\u6b21 BFS \u7684\u683c\u5b50\u4e0e\u5f53\u524d\u7684\u683c\u5b50\u76f8\u540c\uff0c\u6839\u636e\u9898\u610f\uff0c\u5c31\u53ef\u4ee5\u4e0d\u7528\u4efb\u4f55\u82b1\u8d39\u5730\u8d70\u8fc7\u53bb\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/ao3gtgkh.png)\n\n- \u7b2c\u4e8c\u79cd\uff0c\u82e5\u4e0b\u4e00\u6b21 BFS \u7684\u683c\u5b50\u4e0e\u5f53\u524d\u7684\u683c\u5b50\u4e0d\u540c\uff0c\u6839\u636e\u9898\u610f\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u91d1\u5e01\u8d70\u8fc7\u53bb\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/f4ubv353.png)\n\n---\n\n\u6211\u4eec\u518d\u8003\u8651\u4e0b\u4e00\u6b21 BFS \u7684\u683c\u5b50**\u5982\u679c\u6ca1\u6709\u989c\u8272**\u7684\u60c5\u51b5\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/nykaq5f2.png)\n\n\u5219\u6211\u4eec\u9700\u8981\u4f7f\u7528\u9b54\u6cd5\u3002\u7531\u4e8e\u5df2\u7ecf\u5904\u7406\u8fc7\u4e0d\u5408\u7406\u60c5\u51b5\u4e86\uff0c\u6240\u4ee5\u653e\u5fc3\u5927\u80c6\u76f4\u63a5\u4f7f\u7528\u9b54\u6cd5\u3002\u4f46\u662f\u4e0b\u4e00\u6b21 BFS \u683c\u5b50\u8be5\u5982\u4f55\u6d82\u8272\u5462\uff1f\u4e3a\u4e86\u4fdd\u8bc1\u91d1\u5e01\u6570\u91cf\u6700\u5c11\uff0c\u6211\u4eec\u5c31\u76f4\u63a5\u6d82\u8272\u6210\u5f53\u524d\u683c\u5b50\u7684\u989c\u8272\u5c31\u884c\u4e86\uff0c\u4e0d\u7136\u7684\u8bdd\u6211\u82b1\u9b54\u6cd5\u7684\u91d1\u5e01\u662f $2$\uff0c\u8d70\u5230\u90a3\u91cc\u8fd8\u8981 $1$\uff0c\u52a0\u8d77\u6765\u4e0d\u5c31 $3$ \u4e86\u5417\u3002\u6211\u4eec\u4e0d\u8981\u82b1\u51a4\u6789\u94b1\u3002\n\n![](https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/y2tdkxzj.png)\n\n---\n\n\u8fd9\u6837\uff0c\u4e00\u4e2a BFS \u6a21\u578b\u5c31\u51fa\u73b0\u5728\u6211\u4eec\u7684\u8111\u6d77\u91cc\u9762\u4e86\u3002\u53ef\u662f\u5f53\u4f60\u4fe1\u5fc3\u6ee1\u6ee1\u5199\u5b8c\u65f6\uff0c\u4f60\u4f1a\u53d1\u73b0 RE \u4e86\uff01\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u5904\u7406\u91cd\u590d\u8d70\u7684\u60c5\u51b5\u3002\u90a3\u4e48\uff0c\u4e00\u4e2a `bool` \u5c31\u53ef\u4ee5\u89e3\u51b3\u5417\uff1f\u4e0d\uff0c\u6211\u4eec\u9700\u8981\u201c\u5347\u7ea7\u201d\u6807\u8bb0\u6570\u7ec4\uff0c\u5c31\u662f\u8bf4\u628a `bool` \u6539\u6210 `int`\u3002\n\n\u90a3\u6807\u8bb0\u6570\u7ec4\u91cc\u9762\u5b58\u4ec0\u4e48\u5462\uff1f\u7c7b\u4f3c\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u6211\u4eec\u5b9a\u4e49 $ans_{i,j}$ \u4e3a\u8d70\u5230 $i,j$ \u8fd9\u4e00\u683c\u7684\u6700\u5c0f\u91d1\u5e01\u6570\u5373\u53ef\u3002\u5728 BFS \u4e0d\u5408\u7406\u60c5\u51b5\u4e2d\uff0c\u6211\u4eec\u8fd8\u8981\u52a0\u4e0a\u4e00\u4e2a\u6761\u4ef6\uff1a\n\n- \u5f53\u524d\u8d70\u5230\u8fd9\u4e00\u683c\u7684\u91d1\u5e01\u6570\u91cf $\\ge ans_{i,j}$ \u7684\u3002\n\n\u8fd9\u6837\u5b50\uff0c\u4e00\u4e2a\u5b8c\u7f8e\u7684 BFS \u5c31\u5199\u5b8c\u4e86\u3002\n\n\u53c8\u5230\u4e86\u5927\u5bb6\u6700\u559c\u6b22\u7684\u2014\u2014\n\n## \u4ee3\u7801\u65f6\u95f4\uff01\n\n```cpp\n#include \u003Cbits\/stdc++.h\u003E\n#define endl \u0027\\n\u0027\nusing namespace std;\n\nconst int N = 109;\n\nint dx[] = {-1, 1, 0, 0};\nint dy[] = {0, 0, -1, 1};\n\nstruct node {\n\tint x, y, color, magic, money;\n\t\/*\n\t * {x,y}\uff1a\u5f53\u524d\u7684\u5750\u6807\n\t * color\uff1a\u5750\u6807\u7684\u989c\u8272\n\t * magic\uff1a\u662f\u5426\u4f7f\u7528\u4e86\u9b54\u6cd5\n\t * money\uff1a\u4f7f\u7528\u7684\u91d1\u5e01\u6570\n\t *\/\n};\n\nint m, n, color[N][N], ans[N][N];\n\n\/*\n * m,n\uff1a\u5982\u9898\u76ee\u6240\u8ff0\n * color\uff1a\u5b58\u50a8\u6bcf\u4e00\u4e2a\u5750\u6807\u7684\u989c\u8272\n * ans\uff1a\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u7b54\u6848\u6570\u7ec4\n *\/\n\nvoid bfs() {\n\tqueue\u003Cnode\u003E q;\n\tq.push({1, 1, color[1][1], 0, 0});\n\tans[1][1] = 0;\n\twhile (!q.empty()) {\n\t\tnode p = q.front();\n\t\tq.pop();\n\t\tfor (int i = 0; i \u003C 4; i++) {\n\t\t\tint x1 = p.x + dx[i], y1 = p.y + dy[i];\n\t\t\t\/\/ \u4e0d\u5408\u7406\u60c5\u51b5\u5224\u65ad\n\t\t\tif (x1 \u003C 1 || x1 \u003E m || y1 \u003C 1 || y1 \u003E m || (p.magic \u0026\u0026 color[x1][y1] == 0))\n\t\t\t\tcontinue;\n\t\t\tnode next = {x1, y1, 0, 0, 0};\n\t\t\tint cost; \/\/ cost\uff1a\u8fd9\u4e00\u6b21\u82b1\u8d39\u7684\u91d1\u5e01\u6570\n\t\t\tif (color[x1][y1] \u003E 0) {\n\t\t\t\t\/\/ \u7b2c\u4e00\u79cd\uff1a\u4e0b\u4e00\u4e2a\u70b9**\u6709\u989c\u8272**\n\t\t\t\tif (color[x1][y1] == p.color)\n\t\t\t\t\tcost = 0;\n\t\t\t\telse\n\t\t\t\t\tcost = 1;\n\t\t\t\t\/\/ \u6ca1\u6709\u4f7f\u7528\u9b54\u6cd5\uff0c\u4e0b\u4e00\u4e2a\u70b9\u7684\u989c\u8272\u5c31\u662fcolor[x1][y1]\n\t\t\t\tnext.magic = 0;\n\t\t\t\tnext.color = color[x1][y1];\n\t\t\t} else {\n\t\t\t\t\/\/ \u7b2c\u4e8c\u79cd\uff1a\u4e0b\u4e00\u4e2a\u70b9**\u6ca1\u6709\u989c\u8272**\n\t\t\t\tcost = 2;\n\t\t\t\tnext.magic = 1;\n\t\t\t\tnext.color = p.color;\n\t\t\t\t\/\/ \u82b1\u8d39\u7684\u91d1\u5e01\u6570\u662f 2\uff0c\u4f7f\u7528\u8fc7\u9b54\u6cd5\uff0c\u4e0b\u4e00\u4e2a\u70b9\u7684\u989c\u8272\u4e3a\u5f53\u524d\u70b9\u7684\u989c\u8272\n\t\t\t}\n\t\t\t\/\/ \u52a0\u4e0a\u91d1\u5e01\u6570\n\t\t\tnext.money = cost + p.money;\n\t\t\t\/\/ \u8bb0\u5fc6\u5316\n\t\t\tif (next.money \u003C ans[x1][y1]) {\n\t\t\t\tans[x1][y1] = next.money;\n\t\t\t\tq.push(next);\n\t\t\t}\n\t\t}\n\t}\n}\n\nint mian() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcin \u003E\u003E m \u003E\u003E n;\n\tfor (int i = 1; i \u003C= n; i++) {\n\t\tint x, y, c;\n\t\tcin \u003E\u003E x \u003E\u003E y \u003E\u003E c;\n\t\t\/\/ \u5c06 c + 1\uff0c\u8fd9\u6837 0 \u5c31\u8868\u793a\u6ca1\u6709\u989c\u8272\u4e86\n\t\tcolor[x][y] = c + 1;\n\t}\n\tmemset(ans, 0x3f, sizeof(ans));\n\tbfs();\n\t\/\/ ans[m][m] \u5373\u662f\u7b54\u6848\n\tcout \u003C\u003C (ans[m][m] == 0x3f3f3f3f ? -1 : ans[m][m]) \u003C\u003C endl;\n\treturn 0;\n}\n```\n\n**\u62d2\u7edd\u6284\u88ad\uff0c\u4ece\u6211\u505a\u8d77**","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"6n0sadzt","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1736068904,"author":{"uid":554145,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/554145.png","name":"Night_sea_64","slogan":"\u8ddd\u79bb\u7701\u9009\u8fd8\u6709 +inf \u5929\u3002","badge":null,"isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":7,"xcpcLevel":0,"background":""},"upvote":6,"replyCount":1,"favorCount":0,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"\u8fd9\u9898\u5f88\u4e45\u4ee5\u524d\u6211\u4eec\u6821\u5185\u51fa\u4e86\u539f\u9898\uff0c\u7136\u540e\u6211\u91cd\u65b0\u6253\u4e86\u4e00\u904d\uff0c\u7531\u4e8e OI \u8d5b\u5236\u6211\u770b\u4e0d\u89c1\u5206\uff0c\u6700\u540e\u53d1\u73b0\u56e0\u4e3a\u6ca1\u5220\u8c03\u8bd5\u8f93\u51fa\u7206\u96f6\u4e86\u3002\u3002\u3002\n\n\u72b6\u6001 $(x,y,k\\in\\{0,1\\},c)$ \u8868\u793a\u4f4d\u7f6e $(x,y)$\uff0c\u662f\u5426\u4f7f\u7528\u4e86\u9b54\u6cd5\uff0c\u5f53\u524d\u989c\u8272\u662f\u4ec0\u4e48\u3002\n\n\u7136\u540e\u76f4\u63a5\u6a21\u62df\u6240\u6709\u7684\u65b9\u5411\u5e94\u8be5\u600e\u4e48\u4f7f\u7528\u9b54\u6cd5\u5e76\u6539\u53d8\u989c\u8272\u3002\u53d1\u73b0\u8fb9\u6743\u53ef\u80fd\u4f1a\u662f $2$\uff0c\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u7528 bfs \u505a\uff0c\u65e0\u8111 SPFA \u5373\u53ef\u3002\n\n\u5f53\u7136\u8f6c\u6362\u4e00\u4e0b\u4e5f\u53ef\u4ee5\u4f7f\u7528 bfs\u3002\u5f53\u4ece\u6709\u8272\u683c\u5b50\u5230\u8fbe\u65e0\u8272\u683c\u5b50\u65f6\uff0c\u53ef\u4ee5\u5148\u8bbe\u8ba1\u51fa\u4e00\u4e2a\u4e2d\u95f4\u7684\u72b6\u6001\uff0c\u501f\u52a9\u8fd9\u4e2a\u72b6\u6001\u5230\u8fbe\u65e0\u8272\u683c\u5b50\uff0c\u8fd9\u6837\u6bcf\u4e00\u6b65\u7684\u8fb9\u6743\u90fd\u662f $0$ \u6216 $1$\uff0c\u53ef\u4ee5\u4f7f\u7528 01 bfs\u3002\n\n\u4ee5\u4e0b\u662f SPFA \u7684\u4ee3\u7801\u3002\n\n```cpp\n#include\u003Ciostream\u003E\n#include\u003Ccstring\u003E\n#include\u003Cqueue\u003E\nusing namespace std;\nint n,m;\nint dx[]={0,-1,0,1,0};\nint dy[]={0,0,-1,0,1};\nint a[110][110];\nint d[110][110][2][3];\nstruct node{int x,y,k,c;};\nvoid spfa()\n{\n    memset(d,999999,sizeof(d));\n    d[1][1][0][a[1][1]]=0;\n    queue\u003Cnode\u003Eq;\n    q.push({1,1,0,a[1][1]});\n    while(!q.empty())\n    {\n        int x=q.front().x,y=q.front().y,k=q.front().k,c=q.front().c;\n        \/\/cout\u003C\u003Cx\u003C\u003C\u0022 \u0022\u003C\u003Cy\u003C\u003C\u0022 \u0022\u003C\u003Ck\u003C\u003C\u0022 \u0022\u003C\u003Cc\u003C\u003C\u0022 \u0022\u003C\u003Cd[x][y][k][c]\u003C\u003Cendl;\n        q.pop();\n        for(int i=1;i\u003C=4;i++)\n        {\n            int nx=x+dx[i],ny=y+dy[i];\n            if(nx\u003C1||nx\u003En||ny\u003C1||ny\u003En)continue;\n            int nk,nw,nc;\n            if(a[nx][ny]==0)\n            {\n                if(k==1)continue;\n                else nk=1,nw=2,nc=c;\n            }\n            else\n            {\n                nk=0,nc=a[nx][ny];\n                if(a[nx][ny]==c)nw=0;\n                else nw=1;\n            }\n            if(d[x][y][k][c]+nw\u003Cd[nx][ny][nk][nc])\n            {\n                d[nx][ny][nk][nc]=d[x][y][k][c]+nw;\n                q.push({nx,ny,nk,nc});\n            }\n        }\n    }\n}\nint main()\n{\n    cin\u003E\u003En\u003E\u003Em;\n    for(int i=1;i\u003C=m;i++)\n    {\n        int x,y,c;\n        cin\u003E\u003Ex\u003E\u003Ey\u003E\u003Ec;\n        a[x][y]=c+1;\n    }\n    spfa();\n    int ans=min(min(d[n][n][0][2],d[n][n][0][1]),\n              min(d[n][n][1][2],d[n][n][1][1]));\n    if(ans\u003C1e9)cout\u003C\u003Cans\u003C\u003Cendl;\n    else cout\u003C\u003C-1\u003C\u003Cendl;\n    return 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"hpbiwnl6","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1735998510,"author":{"uid":1004349,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1004349.png","name":"HHC883","slogan":"\u957f\u98ce\u7834\u6d6a\u4f1a\u6709\u65f6\uff0c\u76f4\u6302\u4e91\u5e06\u6d4e\u6ca7\u6d77\u3002","badge":null,"isAdmin":false,"isBanned":false,"color":"Red","ccfLevel":5,"xcpcLevel":0,"background":""},"upvote":6,"replyCount":2,"favorCount":1,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"# \u9898\u76ee\u5206\u6790\n\u9996\u5148\uff0c\u8fd9\u9053\u9898\u80af\u5b9a\u662f\u4e0d\u80fd\u7528 DP \u505a\u7684\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5411\u4e0a\u3001\u4e0b\u3001\u5de6\u3001\u53f3\u56db\u4e2a\u65b9\u5411\u79fb\u52a8\uff0c\u4e0d\u5177\u6709\u65e0\u540e\u6548\u6027\uff0c\u800c\u4e14\u8f6c\u79fb\u7279\u522b\u590d\u6742\uff0c\u7528 DP \u80af\u5b9a\u4e0d\u73b0\u5b9e\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u4f7f\u7528\u6700\u77ed\u8def\u3002\n\n\u7b2c\u4e00\u4e2a\u95ee\u9898\u662f\u5982\u4f55\u4e3a\u683c\u5b50\u7f16\u53f7\u3002\u8fd9\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u7b2c $x$ \u884c\u7b2c $y$ \u5217\u7684\u683c\u5b50\u7f16\u53f7\u4e3a $(x - 1)m + y$\uff0c\u8fd9\u6837\u4e0d\u540c\u7684\u683c\u5b50\u7f16\u53f7\u4e92\u4e0d\u76f8\u540c\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u6bcf\u4e2a\u683c\u5b50\u4e3a\u70b9\u5efa\u56fe\u4e86\u3002\n\n\u7b2c\u4e8c\u4e2a\u95ee\u9898\u662f\u5982\u4f55\u8fde\u8fb9\u3002\u8fd9\u4e2a\u53ea\u9700\u8981\u6309\u7167\u9898\u76ee\u4e2d\u89c4\u5b9a\u7684\u8d70\u6cd5\u8fdb\u884c\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u4e00\u4e9b\u7ec6\u8282\u3002\n\n\u6700\u540e\uff0c\u8dd1\u4e00\u904d\u5806\u4f18\u5316\u7684 Dijkstra \u5373\u53ef\u3002\n# \u53c2\u8003\u4ee3\u7801\n\u5efa\u8fb9\u90e8\u5206\u7684\u4ee3\u7801\u7279\u522b\u957f\uff0c\u4f46\u5b9e\u9645\u4e0a\u662f\u65e0\u8111\u7684\u590d\u5236\u7c98\u8d34\u3002\n```cpp\n#include\u003Ciostream\u003E\n#include\u003Ccstring\u003E\n#include\u003Cqueue\u003E\nusing namespace std;\nint m,n,mp[105][105],nxt[40005],head[10005],cnt,dis[10005];\nbool vis[10005];\nstruct edge{\n\tint v,l;\n} es[40005];\nstruct d{\n\tint to,dis;\n};\nbool operator\u003C(d a,d b){\n\treturn b.dis\u003Ca.dis;\n}\npriority_queue\u003Cd\u003E q;\nvoid link(int u,int v,int l){\n\tes[++cnt].v=v,es[cnt].l=l;\n\tnxt[cnt]=head[u];\n\thead[u]=cnt;\n}\nint get(int x,int y){\n\treturn (x-1)*m+y;\n}\nint main(){\n\tios::sync_with_stdio(false);cin.tie(0);cout.tie(0);cout.tie(0);\n\tcin\u003E\u003Em\u003E\u003En;\n\tint x,y,c;\n\tfor(int i=1;i\u003C=n;i++){\n\t\tcin\u003E\u003Ex\u003E\u003Ey\u003E\u003Ec;\n\t\tmp[x][y]=c+1;\n\t}\n\tfor(int i=1;i\u003C=m;i++){\n\t\tfor(int j=1;j\u003C=m;j++){\n\t\t\tif(!mp[i][j]) continue;\n\t\t\tif(mp[i+1][j]\u0026\u0026mp[i][j]==mp[i+1][j]) link(get(i,j),get(i+1,j),0);\n\t\t\tif(mp[i][j+1]\u0026\u0026mp[i][j]==mp[i][j+1]) link(get(i,j),get(i,j+1),0);\n\t\t\tif(mp[i-1][j]\u0026\u0026mp[i][j]==mp[i-1][j]) link(get(i,j),get(i-1,j),0);\n\t\t\tif(mp[i][j-1]\u0026\u0026mp[i][j]==mp[i][j-1]) link(get(i,j),get(i,j-1),0);\n\t\t\tif(mp[i+1][j]\u0026\u0026mp[i][j]!=mp[i+1][j]) link(get(i,j),get(i+1,j),1);\n\t\t\tif(mp[i][j+1]\u0026\u0026mp[i][j]!=mp[i][j+1]) link(get(i,j),get(i,j+1),1);\n\t\t\tif(mp[i-1][j]\u0026\u0026mp[i][j]!=mp[i-1][j]) link(get(i,j),get(i-1,j),1);\n\t\t\tif(mp[i][j-1]\u0026\u0026mp[i][j]!=mp[i][j-1]) link(get(i,j),get(i,j-1),1);\n\t\t\tif(!mp[i+1][j]) link(get(i,j),get(i+1,j),2);\n\t\t\tif(!mp[i][j+1]) link(get(i,j),get(i,j+1),2);\n\t\t\tif(!mp[i-1][j]) link(get(i,j),get(i-1,j),2);\n\t\t\tif(!mp[i][j-1]) link(get(i,j),get(i,j-1),2);\n\t\t\tif(mp[i+2][j]\u0026\u0026!mp[i+1][j]\u0026\u0026mp[i][j]==mp[i+2][j]) link(get(i,j),get(i+2,j),2);\n\t\t\tif(mp[i][j+2]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]==mp[i][j+2]) link(get(i,j),get(i,j+2),2);\n\t\t\tif(mp[i-2][j]\u0026\u0026!mp[i-1][j]\u0026\u0026mp[i][j]==mp[i-2][j]) link(get(i,j),get(i-2,j),2);\n\t\t\tif(mp[i][j-2]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]==mp[i][j-2]) link(get(i,j),get(i,j-2),2);\n\t\t\tif(mp[i+1][j+1]\u0026\u0026!mp[i+1][j]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]==mp[i+1][j+1]) link(get(i,j),get(i+1,j+1),2);\n\t\t\tif(mp[i+1][j-1]\u0026\u0026!mp[i+1][j]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]==mp[i+1][j-1]) link(get(i,j),get(i+1,j-1),2);\n\t\t\tif(mp[i-1][j+1]\u0026\u0026!mp[i-1][j]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]==mp[i-1][j+1]) link(get(i,j),get(i-1,j+1),2);\n\t\t\tif(mp[i-1][j-1]\u0026\u0026!mp[i-1][j]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]==mp[i-1][j-1]) link(get(i,j),get(i-1,j-1),2);\n\t\t\tif(mp[i+2][j]\u0026\u0026!mp[i+1][j]\u0026\u0026mp[i][j]!=mp[i+2][j]) link(get(i,j),get(i+2,j),3);\n\t\t\tif(mp[i][j+2]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]!=mp[i][j+2]) link(get(i,j),get(i,j+2),3);\n\t\t\tif(mp[i-2][j]\u0026\u0026!mp[i-1][j]\u0026\u0026mp[i][j]!=mp[i-2][j]) link(get(i,j),get(i-2,j),3);\n\t\t\tif(mp[i][j-2]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]!=mp[i][j-2]) link(get(i,j),get(i,j-2),3);\n\t\t\tif(mp[i+1][j+1]\u0026\u0026!mp[i+1][j]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]!=mp[i+1][j+1]) link(get(i,j),get(i+1,j+1),3);\n\t\t\tif(mp[i+1][j-1]\u0026\u0026!mp[i+1][j]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]!=mp[i+1][j-1]) link(get(i,j),get(i+1,j-1),3);\n\t\t\tif(mp[i-1][j+1]\u0026\u0026!mp[i-1][j]\u0026\u0026!mp[i][j+1]\u0026\u0026mp[i][j]!=mp[i-1][j+1]) link(get(i,j),get(i-1,j+1),3);\n\t\t\tif(mp[i-1][j-1]\u0026\u0026!mp[i-1][j]\u0026\u0026!mp[i][j-1]\u0026\u0026mp[i][j]!=mp[i-1][j-1]) link(get(i,j),get(i-1,j-1),3);\n\t\t}\n\t}\n\tmemset(dis,0x3f,sizeof dis);\n\tdis[1]=0;\n\tq.push(d{1,0});\n\twhile(!q.empty()){\n\t\tint minn=q.top().to;\n\t\tq.pop();\n\t\tif(vis[minn]) continue;\n\t\tvis[minn]=true;\n\t\tfor(int i=head[minn];i;i=nxt[i]){\n\t\t\tif(dis[minn]+es[i].l\u003Cdis[es[i].v]){\n\t\t\t\tdis[es[i].v]=dis[minn]+es[i].l;\n\t\t\t\tq.push(d{es[i].v,dis[es[i].v]});\n\t\t\t}\n\t\t}\n\t}\n\tif(dis[m*m]\u003E1e9) cout\u003C\u003C-1;\n\telse cout\u003C\u003Cdis[m*m];\n\treturn 0;\n} \n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"quk9ceam","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1735978983,"author":{"uid":1078013,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1078013.png","name":"qsn123","slogan":"AFOing\/\u7ade\u4e89\u9ad8\u80032026\u7701\u961f\u4e2d","badge":null,"isAdmin":false,"isBanned":false,"color":"Orange","ccfLevel":6,"xcpcLevel":0,"background":"https:\/\/cdn.luogu.com.cn\/upload\/image_hosting\/jwesqfdg.png"},"upvote":6,"replyCount":1,"favorCount":0,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"\u8003\u8651\u76f4\u63a5\u5efa\u56fe\uff0c\u8f6c\u5316\u4e3a\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684\u56db\u8054\u901a\u6700\u77ed\u8def\u95ee\u9898\u3002\u4e0d\u96be\u53d1\u73b0\u6709\u7528\u7684\u70b9\u6570\u91cf\u53ea\u6709\u6709\u989c\u8272\u7684\n$N$ \u4e2a\uff0c\u76f4\u63a5\u5efa\u56fe\u53ef\u884c\u3002\n\n\u6240\u4ee5\uff0c\u95ee\u9898\u6765\u4e86\uff1a\u600e\u4e48\u8fde\u8fb9\uff1f\n\n\u7b54\uff1a\u4ee5\u8d39\u7528\u4e3a\u8fb9\u6743\uff0c\u5efa\u51fa\u53cc\u5411\u8fb9\uff08\u56e0\u4e3a\u4f60\u4e5f\u4e0d\u77e5\u9053\u5177\u4f53\u8d70\u6cd5\uff09\uff0c\u5206\u7c7b\u8ba8\u8bba\u6240\u6709\u60c5\u51b5\u5373\u53ef\u3002\n\n\u9996\u5148\uff0c\u53ea\u8003\u8651\u6240\u6709\u6709\u989c\u8272\u7684\u683c\u5b50\u3002\u8bbe\u73b0\u5728\u6240\u5728\u7684\u5750\u6807\u4e3a $(x,y)$\uff0c\u8003\u8651\u67d0\u4e00\u4e2a\u76f8\u90bb\u7684\u683c\u5b50\uff0c\u4e0d\u59a8\u8bbe\u4e3a $(x,y+1)$\u3002\n\n\u82e5 $(x,y)$ \u4e3a\u7ea2\u8272\uff0c\u6839\u636e $(x,y+1)$ \u7684\u989c\u8272\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. \u82e5 $(x+1,y)$ \u4e3a\u7ea2\u8272\uff0c\u8fb9\u6743\u4e3a $0$\u3002\n\n2. \u82e5 $(x+1,y)$ \u4e3a\u9ec4\u8272\uff0c\u8fb9\u6743\u4e3a $1$\u3002\n\n\u6309\u7167\u8fd9\u79cd\u89c4\u5f8b\u5904\u7406\u6240\u6709\u6709\u8272\u70b9\u7684\u56db\u8054\u901a\u5173\u7cfb\uff0c\u5199\u597d\u7a0b\u5e8f\uff0c\u6d4b\u8bd5\uff0c~~\u4f60\u4f1a\u53d1\u73b0\u4f60\u8fde\u6837\u4f8b\u90fd\u8fc7\u4e0d\u53bb\u3002~~\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u8003\u8651\u5bf9\u4e8e\u6240\u6709\u65e0\u8272\u7684\u683c\u5b50\u3002\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u6240\u5728\u7684\u65e0\u8272\u683c\u5b50\u4e3a $(x,y)$\u3002\u53d1\u73b0\u6211\u4eec\u5982\u679c\u5e0c\u671b\u8d70\u5230\u4e00\u4e2a\u65e0\u8272\u683c\u5b50\u4e0a\uff0c\u5c31\u5fc5\u987b\u7ed9\u5b83\u8d4b\u4e88\u4e00\u4e2a\u989c\u8272\uff0c\u5206\u7c7b\u8ba8\u8bba\u662f\u56f0\u96be\u7684\u3002\u800c\u4e14\u9898\u5e72\u4e2d\u544a\u8bc9\u6211\u4eec\uff0c\u63a5\u4e0b\u6765\u5fc5\u987b\u8d70\u5230\u4e00\u4e2a**\u672c\u6765**\u5c31\u6709\u989c\u8272\u7684\u683c\u5b50\u3002\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\uff0c\u65e0\u8272\u683c\u5b50\u662f\u8fde\u63a5\u5176\u56db\u8054\u901a\u4f4d\u7f6e\u7684\u67a2\u7ebd\uff0c\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u5efa\u51fa\u65e0\u8272\u683c\u5b50\u5bf9\u5e94\u7684\u70b9\uff0c\u53ea\u9700\u8981\u5728\u5b83\u7684\u56db\u8054\u901a\u4f4d\u7f6e\u4e0a\u76f4\u63a5\u8fde\u8fb9\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u65e0\u8272\u683c\u5b50 $(x,y)$ \u7684\u4e24\u4e2a\u76f8\u90bb\u683c\u5b50\uff0c\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba\u5176\u989c\u8272\u60c5\u51b5\uff1a\n\n1. \u5bf9\u4e8e\u4e24\u4e2a\u76f8\u540c\u989c\u8272\u7684\u683c\u5b50\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u65e0\u8272\u683c\u5b50\u53d8\u8272\u4e3a\u8be5\u989c\u8272\u5373\u53ef\uff0c\u5efa\u51fa\u8fb9\u7684\u8fb9\u6743\u4e3a $2$\u3002\n\n2. \u5bf9\u4e8e\u4e24\u4e2a\u989c\u8272\u4e0d\u540c\u7684\u683c\u5b50\uff0c\u5f88\u663e\u7136\uff0c\u65e0\u8bba\u6211\u4eec\u5c06\u65e0\u8272\u683c\u5b50\u53d8\u4e3a\u54ea\u4e2a\u989c\u8272\uff0c\u5176\u5fc5\u7136\u4e0e\u5176\u4e2d\u4e00\u4e2a\u6709\u8272\u683c\u5b50\u989c\u8272\u76f8\u540c\u3002\u56e0\u6b64\uff0c\u8d70\u8def\u7684\u82b1\u8d39\u53ea\u6709 $1$\uff0c\u52a0\u4e0a\u53d8\u8272\u7684\u82b1\u8d39\uff0c\u5efa\u51fa\u8fb9\u7684\u8fb9\u6743\u4e3a $3$\u3002\n\n\u6ce8\u610f\u7ec8\u70b9\u4e3a\u65e0\u8272\u683c\u5b50\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u7ec8\u70b9\u76f8\u90bb\u4e24\u4e2a\u683c\u5b50\u7684\u8f83\u5c0f\u503c $+2$ \u5373\u53ef\uff0c\u6216\u8005\u53ef\u4ee5\u628a\u7ec8\u70b9\u7279\u5224\u5efa\u51fa\u6765\u3002\n\n\u6309\u7167\u6b64\u56fe\u8dd1 Dijkstra \u6216\u8005~~\u67d0\u4e2a\u5df2\u7ecf\u6b7b\u4e86\u7684~~\u7b97\u6cd5\u5747\u53ef\u4ee5\u901a\u8fc7\uff0c\u672c\u4eba\u4ee3\u7801\u4f7f\u7528\u7684\u662f Dijkstra\u3002\n\n\u591a\u8bf4\u65e0\u76ca\uff0c\u4e0a\u4ee3\u7801\uff1a\n\n\n```cpp\n#include\u003Cbits\/stdc++.h\u003E\nusing namespace std;\nconst int N=10050,inf=1e9+7;\nint tt=0;\nint h[N]={0},g[N*4]={0},v[N*4]={0},e[N*4]={0};\nint d[N]={0};\nbool b[N]={0};\nint a[1050][1050]={0};\nint dx[4]={1,-1,0,0};\/\/\u7528\u4e8e\u65b9\u4fbf\u8ba1\u7b97\u56db\u8054\u901a\u4f4d\u7f6e\u3002\nint dy[4]={0,0,1,-1};\npriority_queue\u003C pair\u003Cint,int\u003E \u003Eq;\nvoid add(int x,int y,int z){\/\/\u524d\u5411\u661f\u5b58\u56fe\n\t++tt;\n\tv[tt]=y;\n\te[tt]=z;\n\tg[tt]=h[x];\n\th[x]=tt;\n\treturn ;\n}\nvoid djk(){\/\/\u6700\u77ed\u8def\n\tint x,y,z;\n\tfor(int i=1;i\u003CN;i++)d[i]=inf;\n\td[1]=0;\n\tq.push(make_pair(0,1));\n\twhile(q.size()){\n\t\tx=q.top().second;\n\t\tq.pop();\n\t\tif(b[x]==1)continue;\n\t\tb[x]=1;\n\t\tfor(int i=h[x];i;i=g[i]){\n\t\t\ty=v[i];\n\t\t\tz=e[i];\n\t\t\tif(d[y]\u003Ed[x]+z){\n\t\t\t\td[y]=d[x]+z;\n\t\t\t\tq.push(make_pair(-d[y],y));\n\t\t\t}\n\t\t}\n\t}\n\treturn ;\n}\nvoid build(int x,int y)\n{\n\tfor(int i=1;i\u003C=x;i++){\n\t\tfor(int j=1;j\u003C=y;j++){\n\t\t\tif(a[i][j]==0)continue;\n\t\t\tfor(int k=0;k\u003C4;k++){\/\/\u5efa\u8fb9\n\t\t\t\tif(a[i+dx[k]][j+dy[k]]==a[i][j])add((i-1)*y+j,(i+dx[k]-1)*y+j+dy[k],0);\n\t\t\t\telse if(a[i+dx[k]][j+dy[k]]==(a[i][j]^1))add((i-1)*y+j,(i+dx[k]-1)*y+j+dy[k],1);\n\t\t\t\telse{\n\t\t\t\t\tfor(int h=0;h\u003C4;h++){\n\t\t\t\t\t\tif((h^1)==k)continue;\n\t\t\t\t\t\tif(a[i+dx[k]+dx[h]][j+dy[k]+dy[h]]==a[i][j])add((i-1)*y+j,(i+dx[k]+dx[h]-1)*y+j+dy[k]+dy[h],2);\n\t\t\t\t\t\telse if(a[i+dx[k]+dx[h]][j+dy[k]+dy[h]]==(a[i][j]^1))add((i-1)*y+j,(i+dx[k]+dx[h]-1)*y+j+dy[k]+dy[h],3);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif(a[x][y]==0){\/\/\u7279\u5224\u7ec8\u70b9\n\t\tif(a[x-1][y])add((x-1)*y,x*y,2);\n\t\tif(a[x][y-1])add(x*y-1,x*y,2);\n\t}\n\treturn ;\n}\nint main()\n{\n\tint n,m,ans;\n\tint x,y,z;\n\tscanf(\u0022%d%d\u0022,\u0026n,\u0026m);\n\tfor(int i=1;i\u003C=m;i++){\n\t\tscanf(\u0022%d%d%d\u0022,\u0026x,\u0026y,\u0026z);\n\t\ta[x][y]=z+2;\n\t}\n\tbuild(n,n);\n\tdjk();\n\tans=d[n*n];\n\tif(ans==inf)cout\u003C\u003C\u0022-1\u0022;\n\telse cout\u003C\u003Cans;\n\treturn 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false},{"lid":"thjkp2xe","title":"\u9898\u89e3\uff1aP3956 [NOIP2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","time":1736002837,"author":{"uid":1435313,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1435313.png","name":"Iron_Spade","slogan":"\u77a7\u4e0d\u8d77\u6e2f\u95e8\u662f\u4e0d\u662f\u4e0d\u8ba9\u6211\u56de\u590d\u5e16\u5b50\uff01\uff01\uff01","badge":null,"isAdmin":false,"isBanned":false,"color":"Green","ccfLevel":0,"xcpcLevel":0,"background":""},"upvote":4,"replyCount":1,"favorCount":0,"category":2,"status":2,"solutionFor":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"promoteStatus":2,"collection":null,"content":"\u4e24\u767e\u4e07\u5e74\u524d\u505a\u8fc7\u7684\u9898\u76ee\u62ff\u6765\u91cd\u65b0\u505a\u8fd8\u662f\u539f\u6765\u7684\u611f\u89c9\u3002\n\n\u53d1\u73b0 $1\\leq m \\leq 100$\uff0c\u8003\u8651\u8bb0\u641c\u3002\n\n\u5b9a\u4e49 $dp_{i,j}$ \u8868\u793a\u4ece $(1,1)$ \u8d70\u5230 $(i,j)$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u7136\u540e\u6211\u4eec\u6309\u9898\u610f\u6a21\u62df\uff0c\u9047\u5230\u989c\u8272\u76f8\u540c\u683c\u5b50\u5219\u4ee5 $0$ \u4ee3\u4ef7\u8d70\uff0c\u9047\u5230\u989c\u8272\u4e0d\u540c\u683c\u5b50\u5219\u4ee5 $1$ \u4ee3\u4ef7\u8d70\uff0c\u5982\u679c\u65e0\u8272\u5c31\u53ea\u80fd\u7528\u9b54\u6cd5\u4ee5 $2$ \u4ee3\u4ef7\u8d70\uff0c\u6ce8\u610f dfs \u65f6\u8981\u5c06\u65bd\u8fc7\u9b54\u6cd5\u7684\u683c\u5b50\u989c\u8272\u6539\u53d8\u56de\u6eaf\u65f6\u518d\u8fd8\u539f\u3002\n\n\u6ce8\u610f\u683c\u5b50\u8981\u4e0e\u65e0\u8272\u7684\u533a\u5206\u5f00\u6240\u4ee5\u6211\u4eec\u8003\u8651\u628a\u683c\u5b50\u7684\u989c\u8272\u90fd\u52a0\u4e0a\u4e00\uff0c\u65e0\u8272\u7684\u683c\u5b50\u8bb0\u4e3a\u96f6\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\uff1a\n\n```cpp\n#include \u003Cbits\/stdc++.h\u003E\n#define FASTIO ios::sync_with_stdio(0), cin.tie(nullptr), cout.tie(nullptr);\n#define rep(i, j, k) for (int i = j; i \u003C= k; ++i)\n#define pre(i, j, k) for (int i = j; i \u003E= k; --i)\n#define int long long\n#define inf LONG_LONG_MAX\n\n\nusing namespace std;\nconst int dx[] = {0, 0, 1, -1};\nconst int dy[] = {1, -1, 0, 0};\n\nconst int N = 2e2 + 5;\nint a[N][N], vis[N][N], dp[N][N];\nint ret = inf, m, n, x, y, k, flg;\n\nvoid dfs(int x, int y, int s, int p) {\n\tif(s \u003E ret) return;\n\tif(x == n \u0026\u0026 y == n) return ret = min(ret, s), void();\n\trep(i, 0, 3) {\n\t\tint xx = x + dx[i], yy = y + dy[i];\n\t\tif(xx \u003C 1 || xx \u003E n || yy \u003C 1 || yy \u003E n || vis[xx][yy]) continue;\n\t\tvis[xx][yy] = 1;\n\t\tif(a[x][y] == a[xx][yy] \u0026\u0026 a[xx][yy] \u0026\u0026 s \u003C dp[xx][yy]) dfs(xx, yy, dp[xx][yy] = s, 0);\n\t\telse if(a[x][y] != a[xx][yy] \u0026\u0026 a[xx][yy] \u0026\u0026 s + 1 \u003C dp[xx][yy]) dfs(xx, yy, dp[xx][yy] = s + 1, 0);\n\t\telse if(!p) {\n\t\t\tif(s + 2 \u003C dp[xx][yy]) {\n\t\t\t\ta[xx][yy] = a[x][y];\n\t\t\t\tdfs(xx, yy, dp[xx][yy] = s + 2, 1);\n\t\t\t\ta[xx][yy] = 0;\n\t\t\t}\n\t\t}\n\t\tvis[xx][yy] = 0;\n\t}\n} \n\nsigned main() {\n\tFASTIO\n\tmemset(dp, 0x3f, sizeof dp);\n\tcin \u003E\u003E n \u003E\u003E m;\n\trep(i, 1, m) cin \u003E\u003E x \u003E\u003E y \u003E\u003E k, a[x][y] = ++k;\n\tdfs(1, 1, 0, 0);\n\tcout \u003C\u003C (ret \u003E 1e9 ? -1 : ret);\n\treturn 0;\n}\n```","contentFull":true,"adminNote":null,"voted":null,"canReply":true,"canEdit":false}]},"problem":{"pid":"P3956","type":"P","title":"[NOIP 2017 \u666e\u53ca\u7ec4] \u68cb\u76d8","difficulty":4,"submitted":true,"accepted":true},"acceptSolution":false},"user":{"uid":1864449,"avatar":"https:\/\/cdn.luogu.com.cn\/upload\/usericon\/1864449.png","name":"novbra","slogan":"","badge":null,"isAdmin":false,"isBanned":false,"color":"Green","ccfLevel":0,"xcpcLevel":0,"background":"","verified":true,"eloValue":null,"followingCount":0,"followerCount":0,"ranking":40175,"unreadMessageCount":0,"unreadNoticeCount":0,"learnMode":false},"time":1763811033.975793,"theme":{"id":1,"header":{"type":2,"color":[[35,37,38,1],[65,67,69,1]],"degree":90,"blur":0,"brightness":0,"position":[50,50],"repeat":0,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\HeaderFooterConfig"},"sideNav":{"logoBackgroundColor":[52,152,219,1],"color":[52,73,94,1],"invertColor":false,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\SideNavConfig"},"footer":{"type":2,"color":[[51,51,51,1]],"degree":0,"blur":0,"brightness":0,"__CLASS_NAME":"Luogu\\DataClass\\User\\ThemeConfig\\HeaderFooterConfig"}}}</script>            <script src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/loader.20251020-1458.js.下载" charset="utf-8" defer=""></script>
    <link rel="stylesheet" href="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/loader.20251020-1458.css">
    <script src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/vendor.20251020-1458.js.下载" charset="utf-8" defer=""></script>
        <style>body {  }</style>
<style>.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;top:0;right:0;bottom:0;left:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:serif;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{top:0;right:auto;bottom:auto;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{top:0;right:0;bottom:auto;left:auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{top:0;right:auto;bottom:auto;left:0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{top:50%;right:auto;bottom:auto;left:0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{top:50%;right:auto;bottom:auto;left:50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{top:50%;right:0;bottom:auto;left:auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{top:auto;right:auto;bottom:0;left:0}body.swal2-toast-shown .swal2-container.swal2-bottom{top:auto;right:auto;bottom:0;left:50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{top:auto;right:0;bottom:0;left:auto}</style><style>:root { --lcolor--lapis-1: 202, 213, 232; --lfe-color--lapis-1: #cad5e8; --lcolor--lapis-2: 114, 141, 207; --lfe-color--lapis-2: #728dcf; --lcolor--lapis-3: 41, 73, 180; --lfe-color--lapis-3: #2949b4; --lcolor--lapis-4: 14, 29, 105; --lfe-color--lapis-4: #0e1d69; --lcolor--lapis-5: 2, 5, 28; --lfe-color--lapis-5: #02051c; --lcolor--blue-1: 224, 247, 255; --lfe-color--blue-1: #e0f7ff; --lcolor--blue-2: 137, 209, 245; --lfe-color--blue-2: #89d1f5; --lcolor--blue-3: 52, 152, 219; --lfe-color--blue-3: #3498db; --lcolor--blue-4: 20, 85, 143; --lfe-color--blue-4: #14558f; --lcolor--blue-5: 5, 34, 66; --lfe-color--blue-5: #052242; --lcolor--cyan-1: 181, 245, 236; --lfe-color--cyan-1: #b5f5ec; --lcolor--cyan-2: 92, 219, 211; --lfe-color--cyan-2: #5cdbd3; --lcolor--cyan-3: 19, 194, 194; --lfe-color--cyan-3: #13c2c2; --lcolor--cyan-4: 0, 109, 117; --lfe-color--cyan-4: #006d75; --lcolor--cyan-5: 0, 35, 41; --lfe-color--cyan-5: #002329; --lcolor--green-1: 217, 240, 199; --lfe-color--green-1: #d9f0c7; --lcolor--green-2: 148, 214, 109; --lfe-color--green-2: #94d66d; --lcolor--green-3: 82, 196, 26; --lfe-color--green-3: #52c41a; --lcolor--green-4: 34, 112, 10; --lfe-color--green-4: #22700a; --lcolor--green-5: 7, 36, 1; --lfe-color--green-5: #072401; --lcolor--lgreen-1: 218, 224, 211; --lfe-color--lgreen-1: #dae0d3; --lcolor--lgreen-2: 170, 199, 145; --lfe-color--lgreen-2: #aac791; --lcolor--lgreen-3: 112, 173, 71; --lfe-color--lgreen-3: #70ad47; --lcolor--lgreen-4: 52, 97, 30; --lfe-color--lgreen-4: #34611e; --lcolor--lgreen-5: 9, 20, 5; --lfe-color--lgreen-5: #091405; --lcolor--yellow-1: 255, 255, 184; --lfe-color--yellow-1: #ffffb8; --lcolor--yellow-2: 255, 251, 143; --lfe-color--yellow-2: #fffb8f; --lcolor--yellow-3: 250, 219, 20; --lfe-color--yellow-3: #fadb14; --lcolor--yellow-4: 173, 139, 0; --lfe-color--yellow-4: #ad8b00; --lcolor--yellow-5: 97, 71, 0; --lfe-color--yellow-5: #614700; --lcolor--orange-1: 255, 237, 181; --lfe-color--orange-1: #ffedb5; --lcolor--orange-2: 255, 206, 99; --lfe-color--orange-2: #ffce63; --lcolor--orange-3: 243, 156, 17; --lfe-color--orange-3: #f39c11; --lcolor--orange-4: 166, 91, 0; --lfe-color--orange-4: #a65b00; --lcolor--orange-5: 89, 43, 0; --lfe-color--orange-5: #592b00; --lcolor--gold-1: 255, 246, 186; --lfe-color--gold-1: #fff6ba; --lcolor--gold-2: 255, 225, 105; --lfe-color--gold-2: #ffe169; --lcolor--gold-3: 255, 193, 22; --lfe-color--gold-3: #ffc116; --lcolor--gold-4: 179, 119, 0; --lfe-color--gold-4: #b37700; --lcolor--gold-5: 102, 61, 0; --lfe-color--gold-5: #663d00; --lcolor--purple-1: 251, 237, 255; --lfe-color--purple-1: #fbedff; --lcolor--purple-2: 206, 142, 232; --lfe-color--purple-2: #ce8ee8; --lcolor--purple-3: 157, 61, 207; --lfe-color--purple-3: #9d3dcf; --lcolor--purple-4: 86, 25, 130; --lfe-color--purple-4: #561982; --lcolor--purple-5: 31, 7, 54; --lfe-color--purple-5: #1f0736; --lcolor--pink-1: 255, 240, 240; --lfe-color--pink-1: #fff0f0; --lcolor--pink-2: 255, 158, 163; --lfe-color--pink-2: #ff9ea3; --lcolor--pink-3: 254, 76, 97; --lfe-color--pink-3: #fe4c61; --lcolor--pink-4: 179, 36, 62; --lfe-color--pink-4: #b3243e; --lcolor--pink-5: 102, 14, 36; --lfe-color--pink-5: #660e24; --lcolor--red-1: 255, 235, 230; --lfe-color--red-1: #ffebe6; --lcolor--red-2: 255, 166, 148; --lfe-color--red-2: #ffa694; --lcolor--red-3: 231, 76, 60; --lfe-color--red-3: #e74c3c; --lcolor--red-4: 156, 29, 25; --lfe-color--red-4: #9c1d19; --lcolor--red-5: 79, 8, 10; --lfe-color--red-5: #4f080a; --lcolor--grey-1: 250, 250, 250; --lfe-color--grey-1: #fafafa; --lcolor--grey-2: 232, 232, 232; --lfe-color--grey-2: #e8e8e8; --lcolor--grey-3: 191, 191, 191; --lfe-color--grey-3: #bfbfbf; --lcolor--grey-4: 89, 89, 89; --lfe-color--grey-4: #595959; --lcolor--grey-5: 38, 38, 38; --lfe-color--grey-5: #262626; --lcolor--primary: 52, 152, 219; --lfe-color--primary: #3498db; --lcolor--primary-bg: 224, 247, 255; --lfe-color--primary-bg: #e0f7ff; --lcolor--success: 82, 196, 26; --lfe-color--success: #52c41a; --lcolor--warning: 255, 193, 22; --lfe-color--warning: #ffc116; --lcolor--error: 231, 76, 60; --lfe-color--error: #e74c3c; --lcolor--link: 52, 152, 219; --lfe-color--link: #3498db; --lcolor--disabled: 191, 191, 191; --lfe-color--disabled: #bfbfbf; --lcolor--clicked: 41, 73, 180; --lfe-color--clicked: #2949b4; --lcolor--background: 232, 232, 232; --lfe-color--background: #e8e8e8; --lcolor--vip: 223, 194, 137; --lfe-color--vip: #dfc289; }

/* Generated style for color lapis-1(202, 213, 232) */
.lcolor-var-lapis-1 { --lcolor-rgb: 202, 213, 232; }
.lcolor-var-lapis-1 > * { --lcolor-rgb: initial; }
.lcolor--lapis-1 { color: rgb(202, 213, 232); }
.lcolor-bg-lapis-1 { background-color: rgb(202, 213, 232); }

/* Generated style for color lapis-2(114, 141, 207) */
.lcolor-var-lapis-2 { --lcolor-rgb: 114, 141, 207; }
.lcolor-var-lapis-2 > * { --lcolor-rgb: initial; }
.lcolor--lapis-2 { color: rgb(114, 141, 207); }
.lcolor-bg-lapis-2 { background-color: rgb(114, 141, 207); }

/* Generated style for color lapis-3(41, 73, 180) */
.lcolor-var-lapis-3 { --lcolor-rgb: 41, 73, 180; }
.lcolor-var-lapis-3 > * { --lcolor-rgb: initial; }
.lcolor--lapis-3 { color: rgb(41, 73, 180); }
.lcolor-bg-lapis-3 { background-color: rgb(41, 73, 180); }

/* Generated style for color lapis-4(14, 29, 105) */
.lcolor-var-lapis-4 { --lcolor-rgb: 14, 29, 105; }
.lcolor-var-lapis-4 > * { --lcolor-rgb: initial; }
.lcolor--lapis-4 { color: rgb(14, 29, 105); }
.lcolor-bg-lapis-4 { background-color: rgb(14, 29, 105); }

/* Generated style for color lapis-5(2, 5, 28) */
.lcolor-var-lapis-5 { --lcolor-rgb: 2, 5, 28; }
.lcolor-var-lapis-5 > * { --lcolor-rgb: initial; }
.lcolor--lapis-5 { color: rgb(2, 5, 28); }
.lcolor-bg-lapis-5 { background-color: rgb(2, 5, 28); }

/* Generated style for color blue-1(224, 247, 255) */
.lcolor-var-blue-1 { --lcolor-rgb: 224, 247, 255; }
.lcolor-var-blue-1 > * { --lcolor-rgb: initial; }
.lcolor--blue-1 { color: rgb(224, 247, 255); }
.lcolor-bg-blue-1 { background-color: rgb(224, 247, 255); }

/* Generated style for color blue-2(137, 209, 245) */
.lcolor-var-blue-2 { --lcolor-rgb: 137, 209, 245; }
.lcolor-var-blue-2 > * { --lcolor-rgb: initial; }
.lcolor--blue-2 { color: rgb(137, 209, 245); }
.lcolor-bg-blue-2 { background-color: rgb(137, 209, 245); }

/* Generated style for color blue-3(52, 152, 219) */
.lcolor-var-blue-3 { --lcolor-rgb: 52, 152, 219; }
.lcolor-var-blue-3 > * { --lcolor-rgb: initial; }
.lcolor--blue-3 { color: rgb(52, 152, 219); }
.lcolor-bg-blue-3 { background-color: rgb(52, 152, 219); }

/* Generated style for color blue-4(20, 85, 143) */
.lcolor-var-blue-4 { --lcolor-rgb: 20, 85, 143; }
.lcolor-var-blue-4 > * { --lcolor-rgb: initial; }
.lcolor--blue-4 { color: rgb(20, 85, 143); }
.lcolor-bg-blue-4 { background-color: rgb(20, 85, 143); }

/* Generated style for color blue-5(5, 34, 66) */
.lcolor-var-blue-5 { --lcolor-rgb: 5, 34, 66; }
.lcolor-var-blue-5 > * { --lcolor-rgb: initial; }
.lcolor--blue-5 { color: rgb(5, 34, 66); }
.lcolor-bg-blue-5 { background-color: rgb(5, 34, 66); }

/* Generated style for color cyan-1(181, 245, 236) */
.lcolor-var-cyan-1 { --lcolor-rgb: 181, 245, 236; }
.lcolor-var-cyan-1 > * { --lcolor-rgb: initial; }
.lcolor--cyan-1 { color: rgb(181, 245, 236); }
.lcolor-bg-cyan-1 { background-color: rgb(181, 245, 236); }

/* Generated style for color cyan-2(92, 219, 211) */
.lcolor-var-cyan-2 { --lcolor-rgb: 92, 219, 211; }
.lcolor-var-cyan-2 > * { --lcolor-rgb: initial; }
.lcolor--cyan-2 { color: rgb(92, 219, 211); }
.lcolor-bg-cyan-2 { background-color: rgb(92, 219, 211); }

/* Generated style for color cyan-3(19, 194, 194) */
.lcolor-var-cyan-3 { --lcolor-rgb: 19, 194, 194; }
.lcolor-var-cyan-3 > * { --lcolor-rgb: initial; }
.lcolor--cyan-3 { color: rgb(19, 194, 194); }
.lcolor-bg-cyan-3 { background-color: rgb(19, 194, 194); }

/* Generated style for color cyan-4(0, 109, 117) */
.lcolor-var-cyan-4 { --lcolor-rgb: 0, 109, 117; }
.lcolor-var-cyan-4 > * { --lcolor-rgb: initial; }
.lcolor--cyan-4 { color: rgb(0, 109, 117); }
.lcolor-bg-cyan-4 { background-color: rgb(0, 109, 117); }

/* Generated style for color cyan-5(0, 35, 41) */
.lcolor-var-cyan-5 { --lcolor-rgb: 0, 35, 41; }
.lcolor-var-cyan-5 > * { --lcolor-rgb: initial; }
.lcolor--cyan-5 { color: rgb(0, 35, 41); }
.lcolor-bg-cyan-5 { background-color: rgb(0, 35, 41); }

/* Generated style for color green-1(217, 240, 199) */
.lcolor-var-green-1 { --lcolor-rgb: 217, 240, 199; }
.lcolor-var-green-1 > * { --lcolor-rgb: initial; }
.lcolor--green-1 { color: rgb(217, 240, 199); }
.lcolor-bg-green-1 { background-color: rgb(217, 240, 199); }

/* Generated style for color green-2(148, 214, 109) */
.lcolor-var-green-2 { --lcolor-rgb: 148, 214, 109; }
.lcolor-var-green-2 > * { --lcolor-rgb: initial; }
.lcolor--green-2 { color: rgb(148, 214, 109); }
.lcolor-bg-green-2 { background-color: rgb(148, 214, 109); }

/* Generated style for color green-3(82, 196, 26) */
.lcolor-var-green-3 { --lcolor-rgb: 82, 196, 26; }
.lcolor-var-green-3 > * { --lcolor-rgb: initial; }
.lcolor--green-3 { color: rgb(82, 196, 26); }
.lcolor-bg-green-3 { background-color: rgb(82, 196, 26); }

/* Generated style for color green-4(34, 112, 10) */
.lcolor-var-green-4 { --lcolor-rgb: 34, 112, 10; }
.lcolor-var-green-4 > * { --lcolor-rgb: initial; }
.lcolor--green-4 { color: rgb(34, 112, 10); }
.lcolor-bg-green-4 { background-color: rgb(34, 112, 10); }

/* Generated style for color green-5(7, 36, 1) */
.lcolor-var-green-5 { --lcolor-rgb: 7, 36, 1; }
.lcolor-var-green-5 > * { --lcolor-rgb: initial; }
.lcolor--green-5 { color: rgb(7, 36, 1); }
.lcolor-bg-green-5 { background-color: rgb(7, 36, 1); }

/* Generated style for color lgreen-1(218, 224, 211) */
.lcolor-var-lgreen-1 { --lcolor-rgb: 218, 224, 211; }
.lcolor-var-lgreen-1 > * { --lcolor-rgb: initial; }
.lcolor--lgreen-1 { color: rgb(218, 224, 211); }
.lcolor-bg-lgreen-1 { background-color: rgb(218, 224, 211); }

/* Generated style for color lgreen-2(170, 199, 145) */
.lcolor-var-lgreen-2 { --lcolor-rgb: 170, 199, 145; }
.lcolor-var-lgreen-2 > * { --lcolor-rgb: initial; }
.lcolor--lgreen-2 { color: rgb(170, 199, 145); }
.lcolor-bg-lgreen-2 { background-color: rgb(170, 199, 145); }

/* Generated style for color lgreen-3(112, 173, 71) */
.lcolor-var-lgreen-3 { --lcolor-rgb: 112, 173, 71; }
.lcolor-var-lgreen-3 > * { --lcolor-rgb: initial; }
.lcolor--lgreen-3 { color: rgb(112, 173, 71); }
.lcolor-bg-lgreen-3 { background-color: rgb(112, 173, 71); }

/* Generated style for color lgreen-4(52, 97, 30) */
.lcolor-var-lgreen-4 { --lcolor-rgb: 52, 97, 30; }
.lcolor-var-lgreen-4 > * { --lcolor-rgb: initial; }
.lcolor--lgreen-4 { color: rgb(52, 97, 30); }
.lcolor-bg-lgreen-4 { background-color: rgb(52, 97, 30); }

/* Generated style for color lgreen-5(9, 20, 5) */
.lcolor-var-lgreen-5 { --lcolor-rgb: 9, 20, 5; }
.lcolor-var-lgreen-5 > * { --lcolor-rgb: initial; }
.lcolor--lgreen-5 { color: rgb(9, 20, 5); }
.lcolor-bg-lgreen-5 { background-color: rgb(9, 20, 5); }

/* Generated style for color yellow-1(255, 255, 184) */
.lcolor-var-yellow-1 { --lcolor-rgb: 255, 255, 184; }
.lcolor-var-yellow-1 > * { --lcolor-rgb: initial; }
.lcolor--yellow-1 { color: rgb(255, 255, 184); }
.lcolor-bg-yellow-1 { background-color: rgb(255, 255, 184); }

/* Generated style for color yellow-2(255, 251, 143) */
.lcolor-var-yellow-2 { --lcolor-rgb: 255, 251, 143; }
.lcolor-var-yellow-2 > * { --lcolor-rgb: initial; }
.lcolor--yellow-2 { color: rgb(255, 251, 143); }
.lcolor-bg-yellow-2 { background-color: rgb(255, 251, 143); }

/* Generated style for color yellow-3(250, 219, 20) */
.lcolor-var-yellow-3 { --lcolor-rgb: 250, 219, 20; }
.lcolor-var-yellow-3 > * { --lcolor-rgb: initial; }
.lcolor--yellow-3 { color: rgb(250, 219, 20); }
.lcolor-bg-yellow-3 { background-color: rgb(250, 219, 20); }

/* Generated style for color yellow-4(173, 139, 0) */
.lcolor-var-yellow-4 { --lcolor-rgb: 173, 139, 0; }
.lcolor-var-yellow-4 > * { --lcolor-rgb: initial; }
.lcolor--yellow-4 { color: rgb(173, 139, 0); }
.lcolor-bg-yellow-4 { background-color: rgb(173, 139, 0); }

/* Generated style for color yellow-5(97, 71, 0) */
.lcolor-var-yellow-5 { --lcolor-rgb: 97, 71, 0; }
.lcolor-var-yellow-5 > * { --lcolor-rgb: initial; }
.lcolor--yellow-5 { color: rgb(97, 71, 0); }
.lcolor-bg-yellow-5 { background-color: rgb(97, 71, 0); }

/* Generated style for color orange-1(255, 237, 181) */
.lcolor-var-orange-1 { --lcolor-rgb: 255, 237, 181; }
.lcolor-var-orange-1 > * { --lcolor-rgb: initial; }
.lcolor--orange-1 { color: rgb(255, 237, 181); }
.lcolor-bg-orange-1 { background-color: rgb(255, 237, 181); }

/* Generated style for color orange-2(255, 206, 99) */
.lcolor-var-orange-2 { --lcolor-rgb: 255, 206, 99; }
.lcolor-var-orange-2 > * { --lcolor-rgb: initial; }
.lcolor--orange-2 { color: rgb(255, 206, 99); }
.lcolor-bg-orange-2 { background-color: rgb(255, 206, 99); }

/* Generated style for color orange-3(243, 156, 17) */
.lcolor-var-orange-3 { --lcolor-rgb: 243, 156, 17; }
.lcolor-var-orange-3 > * { --lcolor-rgb: initial; }
.lcolor--orange-3 { color: rgb(243, 156, 17); }
.lcolor-bg-orange-3 { background-color: rgb(243, 156, 17); }

/* Generated style for color orange-4(166, 91, 0) */
.lcolor-var-orange-4 { --lcolor-rgb: 166, 91, 0; }
.lcolor-var-orange-4 > * { --lcolor-rgb: initial; }
.lcolor--orange-4 { color: rgb(166, 91, 0); }
.lcolor-bg-orange-4 { background-color: rgb(166, 91, 0); }

/* Generated style for color orange-5(89, 43, 0) */
.lcolor-var-orange-5 { --lcolor-rgb: 89, 43, 0; }
.lcolor-var-orange-5 > * { --lcolor-rgb: initial; }
.lcolor--orange-5 { color: rgb(89, 43, 0); }
.lcolor-bg-orange-5 { background-color: rgb(89, 43, 0); }

/* Generated style for color gold-1(255, 246, 186) */
.lcolor-var-gold-1 { --lcolor-rgb: 255, 246, 186; }
.lcolor-var-gold-1 > * { --lcolor-rgb: initial; }
.lcolor--gold-1 { color: rgb(255, 246, 186); }
.lcolor-bg-gold-1 { background-color: rgb(255, 246, 186); }

/* Generated style for color gold-2(255, 225, 105) */
.lcolor-var-gold-2 { --lcolor-rgb: 255, 225, 105; }
.lcolor-var-gold-2 > * { --lcolor-rgb: initial; }
.lcolor--gold-2 { color: rgb(255, 225, 105); }
.lcolor-bg-gold-2 { background-color: rgb(255, 225, 105); }

/* Generated style for color gold-3(255, 193, 22) */
.lcolor-var-gold-3 { --lcolor-rgb: 255, 193, 22; }
.lcolor-var-gold-3 > * { --lcolor-rgb: initial; }
.lcolor--gold-3 { color: rgb(255, 193, 22); }
.lcolor-bg-gold-3 { background-color: rgb(255, 193, 22); }

/* Generated style for color gold-4(179, 119, 0) */
.lcolor-var-gold-4 { --lcolor-rgb: 179, 119, 0; }
.lcolor-var-gold-4 > * { --lcolor-rgb: initial; }
.lcolor--gold-4 { color: rgb(179, 119, 0); }
.lcolor-bg-gold-4 { background-color: rgb(179, 119, 0); }

/* Generated style for color gold-5(102, 61, 0) */
.lcolor-var-gold-5 { --lcolor-rgb: 102, 61, 0; }
.lcolor-var-gold-5 > * { --lcolor-rgb: initial; }
.lcolor--gold-5 { color: rgb(102, 61, 0); }
.lcolor-bg-gold-5 { background-color: rgb(102, 61, 0); }

/* Generated style for color purple-1(251, 237, 255) */
.lcolor-var-purple-1 { --lcolor-rgb: 251, 237, 255; }
.lcolor-var-purple-1 > * { --lcolor-rgb: initial; }
.lcolor--purple-1 { color: rgb(251, 237, 255); }
.lcolor-bg-purple-1 { background-color: rgb(251, 237, 255); }

/* Generated style for color purple-2(206, 142, 232) */
.lcolor-var-purple-2 { --lcolor-rgb: 206, 142, 232; }
.lcolor-var-purple-2 > * { --lcolor-rgb: initial; }
.lcolor--purple-2 { color: rgb(206, 142, 232); }
.lcolor-bg-purple-2 { background-color: rgb(206, 142, 232); }

/* Generated style for color purple-3(157, 61, 207) */
.lcolor-var-purple-3 { --lcolor-rgb: 157, 61, 207; }
.lcolor-var-purple-3 > * { --lcolor-rgb: initial; }
.lcolor--purple-3 { color: rgb(157, 61, 207); }
.lcolor-bg-purple-3 { background-color: rgb(157, 61, 207); }

/* Generated style for color purple-4(86, 25, 130) */
.lcolor-var-purple-4 { --lcolor-rgb: 86, 25, 130; }
.lcolor-var-purple-4 > * { --lcolor-rgb: initial; }
.lcolor--purple-4 { color: rgb(86, 25, 130); }
.lcolor-bg-purple-4 { background-color: rgb(86, 25, 130); }

/* Generated style for color purple-5(31, 7, 54) */
.lcolor-var-purple-5 { --lcolor-rgb: 31, 7, 54; }
.lcolor-var-purple-5 > * { --lcolor-rgb: initial; }
.lcolor--purple-5 { color: rgb(31, 7, 54); }
.lcolor-bg-purple-5 { background-color: rgb(31, 7, 54); }

/* Generated style for color pink-1(255, 240, 240) */
.lcolor-var-pink-1 { --lcolor-rgb: 255, 240, 240; }
.lcolor-var-pink-1 > * { --lcolor-rgb: initial; }
.lcolor--pink-1 { color: rgb(255, 240, 240); }
.lcolor-bg-pink-1 { background-color: rgb(255, 240, 240); }

/* Generated style for color pink-2(255, 158, 163) */
.lcolor-var-pink-2 { --lcolor-rgb: 255, 158, 163; }
.lcolor-var-pink-2 > * { --lcolor-rgb: initial; }
.lcolor--pink-2 { color: rgb(255, 158, 163); }
.lcolor-bg-pink-2 { background-color: rgb(255, 158, 163); }

/* Generated style for color pink-3(254, 76, 97) */
.lcolor-var-pink-3 { --lcolor-rgb: 254, 76, 97; }
.lcolor-var-pink-3 > * { --lcolor-rgb: initial; }
.lcolor--pink-3 { color: rgb(254, 76, 97); }
.lcolor-bg-pink-3 { background-color: rgb(254, 76, 97); }

/* Generated style for color pink-4(179, 36, 62) */
.lcolor-var-pink-4 { --lcolor-rgb: 179, 36, 62; }
.lcolor-var-pink-4 > * { --lcolor-rgb: initial; }
.lcolor--pink-4 { color: rgb(179, 36, 62); }
.lcolor-bg-pink-4 { background-color: rgb(179, 36, 62); }

/* Generated style for color pink-5(102, 14, 36) */
.lcolor-var-pink-5 { --lcolor-rgb: 102, 14, 36; }
.lcolor-var-pink-5 > * { --lcolor-rgb: initial; }
.lcolor--pink-5 { color: rgb(102, 14, 36); }
.lcolor-bg-pink-5 { background-color: rgb(102, 14, 36); }

/* Generated style for color red-1(255, 235, 230) */
.lcolor-var-red-1 { --lcolor-rgb: 255, 235, 230; }
.lcolor-var-red-1 > * { --lcolor-rgb: initial; }
.lcolor--red-1 { color: rgb(255, 235, 230); }
.lcolor-bg-red-1 { background-color: rgb(255, 235, 230); }

/* Generated style for color red-2(255, 166, 148) */
.lcolor-var-red-2 { --lcolor-rgb: 255, 166, 148; }
.lcolor-var-red-2 > * { --lcolor-rgb: initial; }
.lcolor--red-2 { color: rgb(255, 166, 148); }
.lcolor-bg-red-2 { background-color: rgb(255, 166, 148); }

/* Generated style for color red-3(231, 76, 60) */
.lcolor-var-red-3 { --lcolor-rgb: 231, 76, 60; }
.lcolor-var-red-3 > * { --lcolor-rgb: initial; }
.lcolor--red-3 { color: rgb(231, 76, 60); }
.lcolor-bg-red-3 { background-color: rgb(231, 76, 60); }

/* Generated style for color red-4(156, 29, 25) */
.lcolor-var-red-4 { --lcolor-rgb: 156, 29, 25; }
.lcolor-var-red-4 > * { --lcolor-rgb: initial; }
.lcolor--red-4 { color: rgb(156, 29, 25); }
.lcolor-bg-red-4 { background-color: rgb(156, 29, 25); }

/* Generated style for color red-5(79, 8, 10) */
.lcolor-var-red-5 { --lcolor-rgb: 79, 8, 10; }
.lcolor-var-red-5 > * { --lcolor-rgb: initial; }
.lcolor--red-5 { color: rgb(79, 8, 10); }
.lcolor-bg-red-5 { background-color: rgb(79, 8, 10); }

/* Generated style for color grey-1(250, 250, 250) */
.lcolor-var-grey-1 { --lcolor-rgb: 250, 250, 250; }
.lcolor-var-grey-1 > * { --lcolor-rgb: initial; }
.lcolor--grey-1 { color: rgb(250, 250, 250); }
.lcolor-bg-grey-1 { background-color: rgb(250, 250, 250); }

/* Generated style for color grey-2(232, 232, 232) */
.lcolor-var-grey-2 { --lcolor-rgb: 232, 232, 232; }
.lcolor-var-grey-2 > * { --lcolor-rgb: initial; }
.lcolor--grey-2 { color: rgb(232, 232, 232); }
.lcolor-bg-grey-2 { background-color: rgb(232, 232, 232); }

/* Generated style for color grey-3(191, 191, 191) */
.lcolor-var-grey-3 { --lcolor-rgb: 191, 191, 191; }
.lcolor-var-grey-3 > * { --lcolor-rgb: initial; }
.lcolor--grey-3 { color: rgb(191, 191, 191); }
.lcolor-bg-grey-3 { background-color: rgb(191, 191, 191); }

/* Generated style for color grey-4(89, 89, 89) */
.lcolor-var-grey-4 { --lcolor-rgb: 89, 89, 89; }
.lcolor-var-grey-4 > * { --lcolor-rgb: initial; }
.lcolor--grey-4 { color: rgb(89, 89, 89); }
.lcolor-bg-grey-4 { background-color: rgb(89, 89, 89); }

/* Generated style for color grey-5(38, 38, 38) */
.lcolor-var-grey-5 { --lcolor-rgb: 38, 38, 38; }
.lcolor-var-grey-5 > * { --lcolor-rgb: initial; }
.lcolor--grey-5 { color: rgb(38, 38, 38); }
.lcolor-bg-grey-5 { background-color: rgb(38, 38, 38); }

/* Generated style for color primary(52, 152, 219) */
.lcolor-var-primary { --lcolor-rgb: 52, 152, 219; }
.lcolor-var-primary > * { --lcolor-rgb: initial; }
.lcolor--primary { color: rgb(52, 152, 219); }
.lcolor-bg-primary { background-color: rgb(52, 152, 219); }

/* Generated style for color primary-bg(224, 247, 255) */
.lcolor-var-primary-bg { --lcolor-rgb: 224, 247, 255; }
.lcolor-var-primary-bg > * { --lcolor-rgb: initial; }
.lcolor--primary-bg { color: rgb(224, 247, 255); }
.lcolor-bg-primary-bg { background-color: rgb(224, 247, 255); }

/* Generated style for color success(82, 196, 26) */
.lcolor-var-success { --lcolor-rgb: 82, 196, 26; }
.lcolor-var-success > * { --lcolor-rgb: initial; }
.lcolor--success { color: rgb(82, 196, 26); }
.lcolor-bg-success { background-color: rgb(82, 196, 26); }

/* Generated style for color warning(255, 193, 22) */
.lcolor-var-warning { --lcolor-rgb: 255, 193, 22; }
.lcolor-var-warning > * { --lcolor-rgb: initial; }
.lcolor--warning { color: rgb(255, 193, 22); }
.lcolor-bg-warning { background-color: rgb(255, 193, 22); }

/* Generated style for color error(231, 76, 60) */
.lcolor-var-error { --lcolor-rgb: 231, 76, 60; }
.lcolor-var-error > * { --lcolor-rgb: initial; }
.lcolor--error { color: rgb(231, 76, 60); }
.lcolor-bg-error { background-color: rgb(231, 76, 60); }

/* Generated style for color link(52, 152, 219) */
.lcolor-var-link { --lcolor-rgb: 52, 152, 219; }
.lcolor-var-link > * { --lcolor-rgb: initial; }
.lcolor--link { color: rgb(52, 152, 219); }
.lcolor-bg-link { background-color: rgb(52, 152, 219); }

/* Generated style for color disabled(191, 191, 191) */
.lcolor-var-disabled { --lcolor-rgb: 191, 191, 191; }
.lcolor-var-disabled > * { --lcolor-rgb: initial; }
.lcolor--disabled { color: rgb(191, 191, 191); }
.lcolor-bg-disabled { background-color: rgb(191, 191, 191); }

/* Generated style for color clicked(41, 73, 180) */
.lcolor-var-clicked { --lcolor-rgb: 41, 73, 180; }
.lcolor-var-clicked > * { --lcolor-rgb: initial; }
.lcolor--clicked { color: rgb(41, 73, 180); }
.lcolor-bg-clicked { background-color: rgb(41, 73, 180); }

/* Generated style for color background(232, 232, 232) */
.lcolor-var-background { --lcolor-rgb: 232, 232, 232; }
.lcolor-var-background > * { --lcolor-rgb: initial; }
.lcolor--background { color: rgb(232, 232, 232); }
.lcolor-bg-background { background-color: rgb(232, 232, 232); }

/* Generated style for color vip(223, 194, 137) */
.lcolor-var-vip { --lcolor-rgb: 223, 194, 137; }
.lcolor-var-vip > * { --lcolor-rgb: initial; }
.lcolor--vip { color: rgb(223, 194, 137); }
.lcolor-bg-vip { background-color: rgb(223, 194, 137); }
</style><link rel="stylesheet" type="text/css" href="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/MOD93411~e35be690d804387a.css"></head>
<body>
<div id="app" class="lfe-body" data-v-app=""><div data-v-2da13737="" class="page-loading done" style="--loaded-percentage: 100%;"></div><div data-v-b746c652="" data-v-c522c434="" data-v-6a16487e-s="" class="top-bar"><div data-v-b746c652="" class="left"><!----><a data-v-b746c652="" href="https://www.luogu.com.cn/" style="color: inherit;"><img data-v-b746c652="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/static.325908fec383795b.logo-single-color.svg" class="header-logo mini"></a><div data-v-c522c434="" data-v-b746c652-s="" class="breadcrumb"><a data-v-12b24cc3="" data-v-c522c434="" data-v-b746c652-s="" href="https://www.luogu.com.cn/problem/list" class="" disabled="false" style="color: inherit;">题目列表</a><span data-v-c522c434="" data-v-b746c652-s="">/</span><a data-v-12b24cc3="" data-v-c522c434="" data-v-b746c652-s="" href="https://www.luogu.com.cn/problem/P3956" class="" disabled="false" style="color: inherit;">P3956</a><span data-v-c522c434="" data-v-b746c652-s="">/</span><a data-v-12b24cc3="" data-v-c522c434="" data-v-b746c652-s="" aria-current="page" href="https://www.luogu.com.cn/problem/solution/P3956" class="router-link-active router-link-exact-active" disabled="false" style="color: inherit;">题解</a><!----></div></div><div data-v-b746c652="" class="right"><div data-v-65720dbc="" data-v-b746c652="" class="user-nav"><div data-v-65720dbc="" class="nav-search"><div data-v-65720dbc="" class="search-wrap"><input data-v-62a70fee="" data-v-65720dbc="" placeholder="输入题号搜索题目" type="text" value="" style="padding: 0.125em 0.5em;"></div><a data-v-12b24cc3="" data-v-65720dbc="" href="javascript:void 0" disabled="false" class="link"><svg data-v-65720dbc="" class="svg-inline--fa fa-magnifying-glass" aria-hidden="true" focusable="false" data-prefix="far" data-icon="magnifying-glass" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M368 208A160 160 0 1 0 48 208a160 160 0 1 0 320 0zM337.1 371.1C301.7 399.2 256.8 416 208 416C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208c0 48.8-16.8 93.7-44.9 129.1L505 471c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L337.1 371.1z"></path></svg></a></div><a data-v-12b24cc3="" data-v-65720dbc="" href="https://www.luogu.com.cn/chat" class="link" disabled="false"><svg data-v-65720dbc="" class="svg-inline--fa fa-envelope" aria-hidden="true" focusable="false" data-prefix="far" data-icon="envelope" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M64 112c-8.8 0-16 7.2-16 16l0 22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1l0-22.1c0-8.8-7.2-16-16-16L64 112zM48 212.2L48 384c0 8.8 7.2 16 16 16l384 0c8.8 0 16-7.2 16-16l0-171.8L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64l384 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64L0 128z"></path></svg><!----></a><a data-v-12b24cc3="" data-v-65720dbc="" href="https://www.luogu.com.cn/user/notification" class="link" disabled="false"><svg data-v-65720dbc="" class="svg-inline--fa fa-bell" aria-hidden="true" focusable="false" data-prefix="far" data-icon="bell" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M224 0c-17.7 0-32 14.3-32 32l0 19.2C119 66 64 130.6 64 208l0 25.4c0 45.4-15.5 89.5-43.8 124.9L5.3 377c-5.8 7.2-6.9 17.1-2.9 25.4S14.8 416 24 416l400 0c9.2 0 17.6-5.3 21.6-13.6s2.9-18.2-2.9-25.4l-14.9-18.6C399.5 322.9 384 278.8 384 233.4l0-25.4c0-77.4-55-142-128-156.8L256 32c0-17.7-14.3-32-32-32zm0 96c61.9 0 112 50.1 112 112l0 25.4c0 47.9 13.9 94.6 39.7 134.6L72.3 368C98.1 328 112 281.3 112 233.4l0-25.4c0-61.9 50.1-112 112-112zm64 352l-64 0-64 0c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7s18.7-28.3 18.7-45.3z"></path></svg><!----></a><span data-v-db920be0="" data-v-65720dbc=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-65720dbc="" data-v-db920be0-s="" href="javascript:void 0" disabled="false" class="link"><svg data-v-65720dbc="" class="svg-inline--fa fa-pen-swirl icon-button" aria-hidden="true" focusable="false" data-prefix="far" data-icon="pen-swirl" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M441.2 59.1L453.1 71c9.4 9.4 9.4 24.6 0 33.9L432 126.1 386.3 80.4l20.8-21.1c9.4-9.5 24.6-9.5 34.1-.1zM231.9 236.8L352.6 114.5 398.1 160 276.6 281.6c-3.3 3.3-7.5 5.6-12 6.5L215 298.5l10.4-49.7c.9-4.5 3.2-8.7 6.4-11.9zM373 25.5L197.7 203.1c-9.7 9.8-16.4 22.3-19.2 35.8l-18 85.7c-1.7 7.9 .8 16.2 6.5 21.9s14 8.2 21.9 6.5l85.5-17.9c13.7-2.9 26.3-9.7 36.1-19.6L487.1 138.9c28.1-28.1 28.1-73.7 0-101.8L475.1 25.2C446.9-3.1 401-2.9 373 25.5zm-48.3-7.9C302.9 11.4 279.8 8 256 8C119 8 8 119 8 256S119 504 256 504c13.3 0 24-10.7 24-24s-10.7-24-24-24C145.5 456 56 366.5 56 256S145.5 56 256 56c9.7 0 19.3 .7 28.7 2l40-40.4zM454.1 228.4c1.2 9 1.9 18.2 1.9 27.6c0 57.4-46.6 104-104 104c-13.3 0-24 10.7-24 24s10.7 24 24 24c83.9 0 152-68.1 152-152c0-23.6-3.3-46.4-9.4-68l-40.4 40.5z"></path></svg></a></span></span><!----><span data-v-65720dbc="" class="avatar"><a data-v-12b24cc3="" data-v-65720dbc="" href="https://www.luogu.com.cn/user/1864449" class="" disabled="false"><img data-v-65720dbc="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/1864449.png" alt="User Avatar"></a></span></div></div></div><nav data-v-a119941e="" data-v-c522c434="" data-v-6a16487e-s="" class="sidebar lside bar hide nav-scrollbar"><div data-v-a119941e="" class="nav-group"><!----><ul data-v-a119941e=""><li data-v-40281d0d="" data-v-a119941e="" title="主页"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/" disabled="false" class=""><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-house" aria-hidden="true" focusable="false" data-prefix="far" data-icon="house" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path class="" fill="currentColor" d="M303.5 5.7c-9-7.6-22.1-7.6-31.1 0l-264 224c-10.1 8.6-11.3 23.7-2.8 33.8s23.7 11.3 33.8 2.8L64 245.5 64 432c0 44.2 35.8 80 80 80l288 0c44.2 0 80-35.8 80-80l0-186.5 24.5 20.8c10.1 8.6 25.3 7.3 33.8-2.8s7.3-25.3-2.8-33.8l-264-224zM112 432l0-227.2L288 55.5 464 204.8 464 432c0 17.7-14.3 32-32 32l-48 0 0-152c0-22.1-17.9-40-40-40l-112 0c-22.1 0-40 17.9-40 40l0 152-48 0c-17.7 0-32-14.3-32-32zm128 32l0-144 96 0 0 144-96 0z"></path></svg></span><span data-v-40281d0d="" class="title">主页</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="题库"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/problem/list" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-book" aria-hidden="true" focusable="false" data-prefix="far" data-icon="book" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M0 88C0 39.4 39.4 0 88 0L392 0c30.9 0 56 25.1 56 56l0 288c0 22.3-13.1 41.6-32 50.6l0 69.4 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24L80 512c-44.2 0-80-35.8-80-80c0-2.7 .1-5.4 .4-8L0 424 0 88zM80 400c-17.7 0-32 14.3-32 32s14.3 32 32 32l288 0 0-64L80 400zM48 358.7c9.8-4.3 20.6-6.7 32-6.7l312 0c4.4 0 8-3.6 8-8l0-288c0-4.4-3.6-8-8-8L88 48C65.9 48 48 65.9 48 88l0 270.7zM152 112l176 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-176 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l176 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-176 0c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></span><span data-v-40281d0d="" class="title">题库</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="网校"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://class.luogu.com.cn/" disabled="false" class=""><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-graduation-cap" aria-hidden="true" focusable="false" data-prefix="far" data-icon="graduation-cap" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" fill="currentColor" d="M320 80c2.5 0 5 .4 7.4 1.3l218 78.7-218 78.7c-2.4 .9-4.9 1.3-7.4 1.3s-5-.4-7.4-1.3L184.9 192.6l140.8-52.8c8.3-3.1 12.5-12.3 9.4-20.6s-12.3-12.5-20.6-9.4L154.9 169.6c-5.2 2-10.3 4.2-15.3 6.6L94.7 160l218-78.7c2.4-.9 4.9-1.3 7.4-1.3zM15.8 182.6l77.4 27.9c-27.2 28.7-43.7 66.7-45.1 107.7c-.1 .6-.1 1.2-.1 1.8c0 28.4-10.8 57.8-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7c-3.2-14-7.5-28.3-13.4-41.5c1.9-37 19.2-70.9 46.7-94.2l169.5 61.2c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32s-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6zm480.8 80l-46.5 16.8 12.7 120.5c-4.8 3.5-12.8 8-24.6 12.6C410 423.6 368 432 320 432s-90-8.4-118.3-19.4c-11.8-4.6-19.8-9.2-24.6-12.6l12.7-120.5-46.5-16.8L128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6zM467.4 396c0 0-.1 .1-.3 .4c.2-.3 .3-.4 .3-.4zm-294.8 0c0 0 .1 .1 .3 .4c-.2-.3-.3-.4-.3-.4z"></path></svg></span><span data-v-40281d0d="" class="title">网校</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="训练题单"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/training/list" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-clipboard-list-check" aria-hidden="true" focusable="false" data-prefix="far" data-icon="clipboard-list-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path class="" fill="currentColor" d="M320 64l-40 0-9.6 0C263 27.5 230.7 0 192 0s-71 27.5-78.4 64L104 64 64 64C28.7 64 0 92.7 0 128L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64zM80 112l0 24c0 13.3 10.7 24 24 24l88 0 88 0c13.3 0 24-10.7 24-24l0-24 16 0c8.8 0 16 7.2 16 16l0 320c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-320c0-8.8 7.2-16 16-16l16 0zm88-32a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zm3.3 155.3c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0L112 249.4 99.3 236.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l24 24c6.2 6.2 16.4 6.2 22.6 0l48-48zM192 272c0 8.8 7.2 16 16 16l64 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-64 0c-8.8 0-16 7.2-16 16zm-32 96c0 8.8 7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-96 0c-8.8 0-16 7.2-16 16zm-48 24a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></span><span data-v-40281d0d="" class="title">训练题单</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="比赛"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/contest/list" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-signal" aria-hidden="true" focusable="false" data-prefix="far" data-icon="signal" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" fill="currentColor" d="M576 0c13.3 0 24 10.7 24 24l0 464c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-464c0-13.3 10.7-24 24-24zM448 96c13.3 0 24 10.7 24 24l0 368c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-368c0-13.3 10.7-24 24-24zM320 192c13.3 0 24 10.7 24 24l0 272c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-272c0-13.3 10.7-24 24-24zM192 288c13.3 0 24 10.7 24 24l0 176c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-176c0-13.3 10.7-24 24-24zM64 384c13.3 0 24 10.7 24 24l0 80c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-80c0-13.3 10.7-24 24-24z"></path></svg></span><span data-v-40281d0d="" class="title">比赛</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="评测记录"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/record/list?user=1864449" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-chart-pie" aria-hidden="true" focusable="false" data-prefix="far" data-icon="chart-pie" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path class="" fill="currentColor" d="M493.1 192L352 192l0-141.1C423.5 64 480 120.5 493.1 192zM352 240l175.4 0c9 0 16.6-7 16.6-16C544 100.3 443.7 0 320 0c-9 0-16 7.6-16 16.6L304 192l0 48 48 0zM222.1 321.9L348.4 448.2C325 458.4 299.2 464 272 464C166 464 80 378 80 272c0-83.6 53.4-154.7 128-181.1L208 288c0 12.7 5.1 24.9 14.1 33.9zM239 34.3C122.1 50.3 32 150.7 32 272c0 132.5 107.5 240 240 240c51.8 0 99.8-16.4 139-44.3c7.7-5.5 8.2-16.5 1.5-23.1L256 288l0-238.4c0-9.2-7.8-16.6-17-15.4zM558.4 288L320 288 478.7 446.7c5.8 5.8 15.2 6.3 21.2 .7c39.3-36.7 66.2-86.5 73.9-142.3c1.3-9.2-6.1-17-15.4-17z"></path></svg></span><span data-v-40281d0d="" class="title">评测记录</span></a></li></ul></div><div data-v-a119941e="" class="nav-group"><!----><ul data-v-a119941e=""><li data-v-40281d0d="" data-v-a119941e="" title="讨论区"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/discuss" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-comments" aria-hidden="true" focusable="false" data-prefix="far" data-icon="comments" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" fill="currentColor" d="M88.2 309.1c9.8-18.3 6.8-40.8-7.5-55.8C59.4 230.9 48 204 48 176c0-63.5 63.8-128 160-128s160 64.5 160 128s-63.8 128-160 128c-13.1 0-25.8-1.3-37.8-3.6c-10.4-2-21.2-.6-30.7 4.2c-4.1 2.1-8.3 4.1-12.6 6c-16 7.2-32.9 13.5-49.9 18c2.8-4.6 5.4-9.1 7.9-13.6c1.1-1.9 2.2-3.9 3.2-5.9zM208 352c114.9 0 208-78.8 208-176S322.9 0 208 0S0 78.8 0 176c0 41.8 17.2 80.1 45.9 110.3c-.9 1.7-1.9 3.5-2.8 5.1c-10.3 18.4-22.3 36.5-36.6 52.1c-6.6 7-8.3 17.2-4.6 25.9C5.8 378.3 14.4 384 24 384c43 0 86.5-13.3 122.7-29.7c4.8-2.2 9.6-4.5 14.2-6.8c15.1 3 30.9 4.5 47.1 4.5zM432 480c16.2 0 31.9-1.6 47.1-4.5c4.6 2.3 9.4 4.6 14.2 6.8C529.5 498.7 573 512 616 512c9.6 0 18.2-5.7 22-14.5c3.8-8.8 2-19-4.6-25.9c-14.2-15.6-26.2-33.7-36.6-52.1c-.9-1.7-1.9-3.4-2.8-5.1C622.8 384.1 640 345.8 640 304c0-94.4-87.9-171.5-198.2-175.8c4.1 15.2 6.2 31.2 6.2 47.8l0 .6c87.2 6.7 144 67.5 144 127.4c0 28-11.4 54.9-32.7 77.2c-14.3 15-17.3 37.6-7.5 55.8c1.1 2 2.2 4 3.2 5.9c2.5 4.5 5.2 9 7.9 13.6c-17-4.5-33.9-10.7-49.9-18c-4.3-1.9-8.5-3.9-12.6-6c-9.5-4.8-20.3-6.2-30.7-4.2c-12.1 2.4-24.8 3.6-37.8 3.6c-61.7 0-110-26.5-136.8-62.3c-16 5.4-32.8 9.4-50 11.8C279 439.8 350 480 432 480z"></path></svg></span><span data-v-40281d0d="" class="title">讨论区</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="文章广场"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/article" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-newspaper" aria-hidden="true" focusable="false" data-prefix="far" data-icon="newspaper" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M168 80c-13.3 0-24 10.7-24 24l0 304c0 8.4-1.4 16.5-4.1 24L440 432c13.3 0 24-10.7 24-24l0-304c0-13.3-10.7-24-24-24L168 80zM72 480c-39.8 0-72-32.2-72-72L0 112C0 98.7 10.7 88 24 88s24 10.7 24 24l0 296c0 13.3 10.7 24 24 24s24-10.7 24-24l0-304c0-39.8 32.2-72 72-72l272 0c39.8 0 72 32.2 72 72l0 304c0 39.8-32.2 72-72 72L72 480zM176 136c0-13.3 10.7-24 24-24l96 0c13.3 0 24 10.7 24 24l0 80c0 13.3-10.7 24-24 24l-96 0c-13.3 0-24-10.7-24-24l0-80zm200-24l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM200 272l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></span><span data-v-40281d0d="" class="title">文章广场</span></a></li></ul></div><div data-v-a119941e="" class="nav-group on-expand"><span data-v-a119941e="" class="group-title"><!----><span data-v-a119941e="" class="title">更多功能</span></span><ul data-v-a119941e=""><li data-v-40281d0d="" data-v-a119941e="" title="图片上传"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/image" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">图片上传</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="云剪贴板"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/paste" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">云剪贴板</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="主题商店"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/theme/list" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">主题商店</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="咕值排名"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/ranking" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">咕值排名</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="等级分排名"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/ranking/elo" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">等级分排名</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="洛谷有题"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://ti.luogu.com.cn/" disabled="false" class=""><!----><span data-v-40281d0d="" class="title minor">洛谷有题</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="工单/反馈"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/ticket" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">工单/反馈</span></a></li></ul></div><div data-v-a119941e="" class="nav-group on-expand"><span data-v-a119941e="" class="group-title"><!----><span data-v-a119941e="" class="title">相关链接</span></span><ul data-v-a119941e=""><li data-v-40281d0d="" data-v-a119941e="" title="帮助中心"><a data-v-12b24cc3="" data-v-40281d0d="" target="_blank" href="https://help.luogu.com.cn/" disabled="false" class=""><!----><span data-v-40281d0d="" class="title minor">帮助中心</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="联系我们"><a data-v-12b24cc3="" data-v-40281d0d="" target="_blank" href="https://help.luogu.com.cn/contact-us" disabled="false" class=""><!----><span data-v-40281d0d="" class="title minor">联系我们</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="社区规则"><a data-v-12b24cc3="" data-v-40281d0d="" target="_blank" href="https://help.luogu.com.cn/rules/community/" disabled="false" class=""><!----><span data-v-40281d0d="" class="title minor">社区规则</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="陶片放逐"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/judgement" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">陶片放逐</span></a></li><li data-v-40281d0d="" data-v-a119941e="" title="管理名单"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/judgement/admins" class="" disabled="false"><!----><span data-v-40281d0d="" class="title minor">管理名单</span></a></li></ul></div></nav><div data-v-8a6f9694="" data-v-c522c434="" data-v-6a16487e-s="" class="user-nav rside hide nav-scrollbar"><div data-v-8a6f9694="" class="title"><div data-v-1ecbf760="" data-v-8a6f9694="" class="luogu-username username"><!----><span data-v-1ecbf760="" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--green-3);">novbra</span><!----><!----><!----></div><svg data-v-8a6f9694="" class="svg-inline--fa fa-xmark close" aria-hidden="true" focusable="false" data-prefix="far" data-icon="xmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path class="" fill="currentColor" d="M345 137c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-119 119L73 103c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l119 119L39 375c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l119-119L311 409c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-119-119L345 137z"></path></svg></div><div data-v-8a6f9694="" class="nav-group"><!----><ul data-v-8a6f9694=""><li data-v-40281d0d="" data-v-8a6f9694="" title="个人中心"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/user/1864449" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-house-user" aria-hidden="true" focusable="false" data-prefix="far" data-icon="house-user" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path class="" fill="currentColor" d="M272.5 5.7c9-7.6 22.1-7.6 31.1 0l264 224c10.1 8.6 11.4 23.7 2.8 33.8s-23.7 11.3-33.8 2.8L512 245.5 512 432c0 44.2-35.8 80-80 80l-288 0c-44.2 0-80-35.8-80-80l0-186.5L39.5 266.3c-10.1 8.6-25.3 7.3-33.8-2.8s-7.3-25.3 2.8-33.8l264-224zM112 204.8L112 432c0 17.7 14.3 32 32 32l288 0c17.7 0 32-14.3 32-32l0-227.2L288 55.5 112 204.8zM224 224a64 64 0 1 1 128 0 64 64 0 1 1 -128 0zm32 96l64 0c44.2 0 80 35.8 80 80c0 8.8-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16c0-44.2 35.8-80 80-80z"></path></svg></span><span data-v-40281d0d="" class="title">个人中心</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="用户设置"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/user/setting" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-user-gear" aria-hidden="true" focusable="false" data-prefix="far" data-icon="user-gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" fill="currentColor" d="M224 208a80 80 0 1 0 0-160 80 80 0 1 0 0 160zM224 0a128 128 0 1 1 0 256A128 128 0 1 1 224 0zM49.3 464l287.3 0c3.3 4.2 6.7 8.2 10.3 12c15.7 16.9 39.6 18.4 57.2 8.7l0 .9c0 9.2 2.7 18.5 7.9 26.3L29.7 512C13.3 512 0 498.7 0 482.3C0 383.8 79.8 304 178.3 304l45.7 0 45.7 0c11.8 0 23.4 1.2 34.5 3.3c-2.1 18.5 7.4 35.6 21.8 44.8c-3.6 2.3-7 5.1-9.9 8.4c-14.4-5.5-30.1-8.5-46.5-8.5l-91.4 0c-65.7 0-120.1 48.7-129 112zM436 218.2c0-7 4.5-13.3 11.3-14.8c10.5-2.4 21.5-3.7 32.7-3.7s22.2 1.3 32.7 3.7c6.8 1.5 11.3 7.8 11.3 14.8l0 30.6c7.9 3.4 15.4 7.7 22.3 12.8l24.9-14.3c6.1-3.5 13.7-2.7 18.5 2.4c7.6 8.1 14.3 17.2 20.1 27.2s10.3 20.4 13.5 31c2.1 6.7-1.1 13.7-7.2 17.2l-25 14.4c.4 4 .7 8.1 .7 12.3s-.2 8.2-.7 12.3l25 14.4c6.1 3.5 9.2 10.5 7.2 17.2c-3.3 10.6-7.8 21-13.5 31s-12.5 19.1-20.1 27.2c-4.8 5.1-12.5 5.9-18.5 2.4l-24.9-14.3c-6.9 5.1-14.3 9.4-22.3 12.8l0 30.6c0 7-4.5 13.3-11.3 14.8c-10.5 2.4-21.5 3.7-32.7 3.7s-22.2-1.3-32.7-3.7c-6.8-1.5-11.3-7.8-11.3-14.8l0-30.5c-8-3.4-15.6-7.7-22.5-12.9l-24.7 14.3c-6.1 3.5-13.7 2.7-18.5-2.4c-7.6-8.1-14.3-17.2-20.1-27.2s-10.3-20.4-13.5-31c-2.1-6.7 1.1-13.7 7.2-17.2l24.8-14.3c-.4-4.1-.7-8.2-.7-12.4s.2-8.3 .7-12.4L343.8 325c-6.1-3.5-9.2-10.5-7.2-17.2c3.3-10.6 7.7-21 13.5-31s12.5-19.1 20.1-27.2c4.8-5.1 12.4-5.9 18.5-2.4l24.8 14.3c6.9-5.1 14.5-9.4 22.5-12.9l0-30.5zm92.1 133.5a48.1 48.1 0 1 0 -96.1 0 48.1 48.1 0 1 0 96.1 0z"></path></svg></span><span data-v-40281d0d="" class="title">用户设置</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="练习情况"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/user/1864449/practice" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-chart-user" aria-hidden="true" focusable="false" data-prefix="far" data-icon="chart-user" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" fill="currentColor" d="M576 48L224 48c-8.8 0-16 7.2-16 16l0 41.3c-14.8-6-31-9.3-48-9.3l0-32c0-35.3 28.7-64 64-64L576 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64l-239.2 0c-8.3-18-19.8-34.2-33.7-48L576 368c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16zM412.7 139.3c-4.6-4.6-5.9-11.5-3.5-17.4s8.3-9.9 14.8-9.9l88 0c8.8 0 16 7.2 16 16l0 88c0 6.5-3.9 12.3-9.9 14.8s-12.9 1.1-17.4-3.5l-27-27L401 273c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47 55.7-55.7-27-27zM160 272a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm0-144a96 96 0 1 1 0 192 96 96 0 1 1 0-192zM133.3 400c-39.8 0-73.2 27.2-82.6 64l218.6 0c-9.5-36.8-42.9-64-82.6-64l-53.3 0zm0-48l53.3 0C260.3 352 320 411.7 320 485.3c0 14.7-11.9 26.7-26.7 26.7L26.7 512C11.9 512 0 500.1 0 485.3C0 411.7 59.7 352 133.3 352z"></path></svg></span><span data-v-40281d0d="" class="title">练习情况</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="我的题库"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/user/mine/problem" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-chart-pie" aria-hidden="true" focusable="false" data-prefix="far" data-icon="chart-pie" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path class="" fill="currentColor" d="M493.1 192L352 192l0-141.1C423.5 64 480 120.5 493.1 192zM352 240l175.4 0c9 0 16.6-7 16.6-16C544 100.3 443.7 0 320 0c-9 0-16 7.6-16 16.6L304 192l0 48 48 0zM222.1 321.9L348.4 448.2C325 458.4 299.2 464 272 464C166 464 80 378 80 272c0-83.6 53.4-154.7 128-181.1L208 288c0 12.7 5.1 24.9 14.1 33.9zM239 34.3C122.1 50.3 32 150.7 32 272c0 132.5 107.5 240 240 240c51.8 0 99.8-16.4 139-44.3c7.7-5.5 8.2-16.5 1.5-23.1L256 288l0-238.4c0-9.2-7.8-16.6-17-15.4zM558.4 288L320 288 478.7 446.7c5.8 5.8 15.2 6.3 21.2 .7c39.3-36.7 66.2-86.5 73.9-142.3c1.3-9.2-6.1-17-15.4-17z"></path></svg></span><span data-v-40281d0d="" class="title">我的题库</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="我的专栏"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/article/mine" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-newspaper" aria-hidden="true" focusable="false" data-prefix="far" data-icon="newspaper" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M168 80c-13.3 0-24 10.7-24 24l0 304c0 8.4-1.4 16.5-4.1 24L440 432c13.3 0 24-10.7 24-24l0-304c0-13.3-10.7-24-24-24L168 80zM72 480c-39.8 0-72-32.2-72-72L0 112C0 98.7 10.7 88 24 88s24 10.7 24 24l0 296c0 13.3 10.7 24 24 24s24-10.7 24-24l0-304c0-39.8 32.2-72 72-72l272 0c39.8 0 72 32.2 72 72l0 304c0 39.8-32.2 72-72 72L72 480zM176 136c0-13.3 10.7-24 24-24l96 0c13.3 0 24 10.7 24 24l0 80c0 13.3-10.7 24-24 24l-96 0c-13.3 0-24-10.7-24-24l0-80zm200-24l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM200 272l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24z"></path></svg></span><span data-v-40281d0d="" class="title">我的专栏</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="收藏夹"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/user/mine/trainingFav" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-folder-bookmark" aria-hidden="true" focusable="false" data-prefix="far" data-icon="folder-bookmark" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M251.7 127.6s0 0 0 0c1.4 1.4 2.8 2.7 4.3 3.9L256 304c0 6.1 3.4 11.6 8.8 14.3s11.9 2.1 16.8-1.5L336 276l54.4 40.8c4.8 3.6 11.3 4.2 16.8 1.5s8.8-8.3 8.8-14.3l0-160 32 0c8.8 0 16 7.2 16 16l0 256c0 8.8-7.2 16-16 16L64 432c-8.8 0-16-7.2-16-16L48 96c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l33.9-33.9L208.8 84.7l42.9 42.9zm33.9-33.9L242.7 50.7c-12-12-28.3-18.7-45.3-18.7L64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64L291.3 96c-2.1 0-4.2-.8-5.7-2.3z"></path></svg></span><span data-v-40281d0d="" class="title">收藏夹</span></a></li><li data-v-40281d0d="" data-v-8a6f9694="" title="我的工单"><a data-v-12b24cc3="" data-v-40281d0d="" href="https://www.luogu.com.cn/ticket" class="" disabled="false"><span data-v-40281d0d="" class="icon"><svg data-v-40281d0d="" class="svg-inline--fa fa-ballot-check" aria-hidden="true" focusable="false" data-prefix="far" data-icon="ballot-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M384 48c8.8 0 16 7.2 16 16l0 384c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16L48 64c0-8.8 7.2-16 16-16l320 0zM64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-384c0-35.3-28.7-64-64-64L64 0zM80 112l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16L96 96c-8.8 0-16 7.2-16 16zM96 352c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zm80-224c0 13.3 10.7 24 24 24l144 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-144 0c-13.3 0-24 10.7-24 24zm32 128c0 13.3 10.7 24 24 24l112 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-112 0c-13.3 0-24 10.7-24 24zM176 384c0 13.3 10.7 24 24 24l144 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-144 0c-13.3 0-24 10.7-24 24zm-4.7-140.7c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0L112 257.4 99.3 244.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l24 24c6.2 6.2 16.4 6.2 22.6 0l48-48z"></path></svg></span><span data-v-40281d0d="" class="title">我的工单</span></a></li></ul></div><div data-v-8a6f9694="" class="nav-group"><p data-v-8a6f9694="" style="text-align: center;"><svg data-v-8a6f9694="" class="svg-inline--fa fa-spinner-third fa-spin" aria-hidden="true" focusable="false" data-prefix="far" data-icon="spinner-third" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M457 372c11.5 6.6 26.3 2.7 31.8-9.3C503.7 330.2 512 294.1 512 256C512 122.7 410.1 13.2 280 1.1C266.8-.1 256 10.7 256 24s10.8 23.9 24 25.4C383.5 61.2 464 149.2 464 256c0 29.3-6.1 57.3-17 82.6c-5.3 12.2-1.5 26.8 10 33.5z"></path></svg></p></div><div data-v-8a6f9694="" class="nav-group login-actions"><a data-v-12b24cc3="" data-v-8a6f9694="" href="javascript:void 0" disabled="false" class="action"><svg data-v-8a6f9694="" class="svg-inline--fa fa-lock faicon-inline" aria-hidden="true" focusable="false" data-prefix="far" data-icon="lock" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M144 128l0 64 160 0 0-64c0-44.2-35.8-80-80-80s-80 35.8-80 80zM96 192l0-64C96 57.3 153.3 0 224 0s128 57.3 128 128l0 64 32 0c35.3 0 64 28.7 64 64l0 192c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 256c0-35.3 28.7-64 64-64l32 0zM48 256l0 192c0 8.8 7.2 16 16 16l320 0c8.8 0 16-7.2 16-16l0-192c0-8.8-7.2-16-16-16L64 240c-8.8 0-16 7.2-16 16z"></path></svg><span data-v-8a6f9694="">锁定</span></a><a data-v-12b24cc3="" data-v-8a6f9694="" href="javascript:void 0" disabled="false" class="action"><svg data-v-8a6f9694="" class="svg-inline--fa fa-right-from-bracket faicon-inline" aria-hidden="true" focusable="false" data-prefix="far" data-icon="right-from-bracket" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M352 146.2L462 256 352 365.8l0-53.8c0-13.3-10.7-24-24-24l-120 0 0-64 120 0c13.3 0 24-10.7 24-24l0-53.8zM512 256c0-11.5-4.6-22.5-12.7-30.6L383.2 109.6c-8.7-8.7-20.5-13.6-32.8-13.6c-25.6 0-46.4 20.8-46.4 46.4l0 33.6-96 0c-26.5 0-48 21.5-48 48l0 64c0 26.5 21.5 48 48 48l96 0 0 33.6c0 25.6 20.8 46.4 46.4 46.4c12.3 0 24.1-4.9 32.8-13.6L499.3 286.6c8.1-8.1 12.7-19.1 12.7-30.6zM168 80c13.3 0 24-10.7 24-24s-10.7-24-24-24L88 32C39.4 32 0 71.4 0 120L0 392c0 48.6 39.4 88 88 88l80 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-80 0c-22.1 0-40-17.9-40-40l0-272c0-22.1 17.9-40 40-40l80 0z"></path></svg><span data-v-8a6f9694="">登出</span></a></div></div><div data-v-6a16487e="" class="main-container lside-nav"><header data-v-f265fec6="" class="theme-bg" style="background: linear-gradient(90deg, rgb(35, 37, 38), rgb(65, 67, 69));"><div data-v-f265fec6="" class="theme-fg"><div data-v-f265fec6="" class="columba-content-wrap header-layout"><h1 data-v-f265fec6="" class="lfe-h1">P3956 [NOIP 2017 普及组] 棋盘 题解</h1><div data-v-f265fec6=""><div data-v-f265fec6=""><a data-v-505b6a97="" data-v-f265fec6-s="" href="https://www.luogu.com.cn/problem/P3956" class="solid l-button lform-size-middle" disabled="false">返回题目<!----></a><!----></div><div data-v-f265fec6=""></div></div></div></div></header><main data-v-f265fec6=""><div data-v-f265fec6="" class="columba-content-wrap"><div data-v-754e1ea4="" data-v-f265fec6-s="" class="sidebar-container reverse"><div data-v-754e1ea4="" class="side" style="flex: 1 1 0%;"><div data-v-b62e56e7="" data-v-754e1ea4-s="" class="l-card"><h2 class="lfe-h2"> 本题目已不接受新题解提交 </h2><p>当题目的题解数量、做题思路已足够丰富，题目过于简单，或处于月赛保护期时，题解提交入口会被关闭。</p><p><b>不要</b>把题解发布在题目讨论区。</p></div><div data-v-b62e56e7="" data-v-754e1ea4-s="" class="l-card"><h2 class="lcolor--red-3 lfe-h2"> 题解仅供学习参考使用 </h2><p>抄袭、复制题解，以达到刷 AC 率/AC 数量或其他目的的行为，在洛谷是严格禁止的。</p><p> 洛谷非常重视<b>学术诚信</b>。此类行为将会导致您成为<b class="lcolor--yellow-4">作弊者</b>。 具体细则请查看<a data-v-12b24cc3="" target="_blank" href="https://help.luogu.com.cn/rules/community" disabled="false" class="">洛谷社区规则</a>。 </p><p> 提交题解前请务必阅读<a data-v-12b24cc3="" target="_blank" href="https://help.luogu.com.cn/rules/academic/solution-standard" disabled="false" class="">《洛谷主题库题解规范》</a>。 </p></div><div data-v-fdcd5a58="" data-v-754e1ea4-s=""><a data-v-12b24cc3="" data-v-fdcd5a58="" target="_blank" href="https://class.luogu.com.cn/course/yugu25noa" disabled="false" class=""><img data-v-fdcd5a58="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/8bnf2r71.png"></a><span data-v-fdcd5a58=""><svg data-v-fdcd5a58="" class="svg-inline--fa fa-rectangle-ad" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rectangle-ad" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path class="" fill="currentColor" d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM229.5 173.3l72 144c5.9 11.9 1.1 26.3-10.7 32.2s-26.3 1.1-32.2-10.7L253.2 328l-90.3 0-5.4 10.7c-5.9 11.9-20.3 16.7-32.2 10.7s-16.7-20.3-10.7-32.2l72-144c4.1-8.1 12.4-13.3 21.5-13.3s17.4 5.1 21.5 13.3zM208 237.7L186.8 280l42.3 0L208 237.7zM392 256a24 24 0 1 0 0 48 24 24 0 1 0 0-48zm24-43.9l0-28.1c0-13.3 10.7-24 24-24s24 10.7 24 24l0 96 0 48c0 13.3-10.7 24-24 24c-6.6 0-12.6-2.7-17-7c-9.4 4.5-19.9 7-31 7c-39.8 0-72-32.2-72-72s32.2-72 72-72c8.4 0 16.5 1.4 24 4.1z"></path></svg>&nbsp;洛谷推荐</span><button data-v-505b6a97="" data-v-fdcd5a58="" class="lform-size-small close button-transparent" type="button"><svg data-v-fdcd5a58="" class="svg-inline--fa fa-x" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path class="" fill="currentColor" d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"></path></svg><!----></button></div></div><div data-v-754e1ea4="" class="main" style="flex: 2 1 0%;"><div data-v-b62e56e7="" data-v-754e1ea4-s="" class="l-card burger solution-list"><div data-v-b62e56e7="" class="header"><b>11 篇题解</b><nav data-v-f9e2bc10="" style="float: right;"><ul data-v-f9e2bc10=""><li data-v-f9e2bc10="" class="selected">默认排序</li><li data-v-f9e2bc10="" class="">时间排序</li></ul></nav></div><div data-v-b62e56e7="" class="body"><div data-v-ac34e482=""><div data-v-ac34e482="" class="list-wrap block border"><!----><div data-v-ac34e482="" class="row-wrap"><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/35871.png" alt="ZigZagKmp"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/35871" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--pink-3);">ZigZagKmp</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2018-09-10T13:11:53.000Z" title="2018-09-10 21:11:53">2018-09-10 21:11</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/2779qoy1" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h3>update on 2020.2.16</h3>
<p>看到评论区有同学对排版的建议，故对文章排版进行一些优化，使本题解符合现行题解规范。</p>
<h2>写在前面</h2>
<p>这是本蒟蒻一年前发的题解，因此有些地方讲的不是特别清楚，代码也比较冗长。其实这一题没有必要将其转换为图论模型，在上面跑最短路，可以直接使用优先队列优化的 <code>BFS</code> 。</p>
<p><code>NOIP2017</code>普及组比赛，是我参加的第一次复赛，当时我太菜了（虽然说现在的我也还是很菜），这一题最暴力的 <code>dfs</code> 都写不对，不知怎么拿到了<code>20</code>分，其余的测试点 <code>WA</code>+<code>TLE</code> ，在考场上时间几乎全用来氪这一题，结果最后一题想出<code>50</code>分 <code>DP</code> 没调完，<code>220</code>滚粗。考场上主要纠结于如何处理魔法，因此考后和<a href="https://www.luogu.com.cn/user/28910">同学</a>想到了这样一种代替魔法的算法。</p>
<p>这一次修改，将对原题解中解释的不是很清楚的地方作较为清晰的解释，并且修改了最后的参考程序，提供本题2种做法。</p>
<p>至于本题的主流算法（ <code>dfs</code> +记忆化优化），其实从最短路的角度上来讲是基于 <code>dfs</code> 实现的 <code>SPFA</code> （没错，就是那个<del>死了又活了的<code>SPFA</code></del>）,如果这一题数据范围扩大，并且做一些特殊构造，是可以被卡掉的。</p>
<p>另外，本蒟蒻不建议使用基于 <code>dfs</code> 实现的 <code>SPFA</code> ，因为这其实是最好卡掉了 <code>SPFA</code> 。</p>
<hr>
<h3>题意分析与转化</h3>
<blockquote>
<p>给你一个棋盘，有一些格子被染成了两种颜色。你可以从一个有颜色的格子走向另一个有颜色的格子，若两个格子颜色相同，则不付出代价，否则付出 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 点代价。</p>
</blockquote>
<p>如果题目就到这里，相当于代价为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> 或者 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 的四个方向的走迷宫，可以使用双端队列 <code>BFS</code> 实现，时间复杂度<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<blockquote>
<p>另外， 你可以花费 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 个金币施展魔法让下一个无色格子暂时变为你指定的颜色。但<strong>这个魔法不能连续使用</strong>， 而且这个魔法的持续时间很短，也就是说，如果你使用了这个魔法，走到了这个暂时有颜色的格子上，你就不能继续使用魔法； 只有当你离开这个位置，走到一个本来就有颜色的格子上的时候，你才能继续使用这个魔法，而当你离开了这个位置（施展魔法使得变为有颜色的格子）时，这个格子恢复为无色。</p>
</blockquote>
<p>如果就按照题意来<strong>直接搜索</strong>的话会比较麻烦（本蒟蒻当年就是这样写挂了的），但是我们可以稍微转化一下。</p>
<p>（注：下面的分析过程不妨<strong>只考虑一种颜色</strong>，因为颜色不同带来的代价的变化和魔法的转化没有太大关系）</p>
<p>我们现在站在一个施了魔法的格子上(称为 <code>via</code> )，我们上一步的格子称为 <code>now</code> ，下面我们思考下一步能走到的格子有哪些（称为 <code>next</code> ）。</p>
<p>因为魔法不能连用，并且如果我们走回上一步的格子，结果一定不是最优的，所以我们可以选择的只有如下的情况：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/71445.png" alt=""></p>
<p>其中蓝色的格子可能成为 <code>next</code> （<strong>前提，在未使用魔法的情况下这些格子本来有色</strong>）。</p>
<p>知道了 <code>next</code> 可能的决策集合，我们下面来看如何把魔法<strong>等价转换</strong>掉。</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32552.png" alt=""></p>
<p>如图，可以将格子 <code>via</code> 施加魔法，从 <code>now</code> 走向 <code>next</code> ，实现了向<strong>右下方</strong>的转移。</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32553.png" alt=""></p>
<p>如图，可以将格子 <code>via</code> 施加魔法，从 <code>now</code> 走向 <code>next</code> ，实现了向<strong>左下方</strong>的转移。</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32554.png" alt=""></p>
<p>如图，可以将格子 <code>via</code> 施加魔法，从 <code>now</code> 走向 <code>next</code> ，实现了向<strong>下连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格</strong>的转移。</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32555.png" alt=""></p>
<p>如图，可以将格子 <code>via</code> 施加魔法，从 <code>now</code> 走向 <code>next</code> ，实现了向<strong>右连<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格</strong>的转移。</p>
<p>同理，我们也可以实现向<strong>左上方</strong>，向<strong>右上方</strong>，向<strong>上连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格</strong>，向<strong>左连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格</strong>的转移。</p>
<p>综上，我们得到<strong>使用魔法</strong>可以转移到的情况：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32556.png" alt=""></p>
<p>综合一下，我们可以得到如下结论：从 <code>now</code> 这个格子出发，使用或不使用魔法可以走到的<strong>有色格子</strong>的情况如下图：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32558.png" alt=""></p>
<p>其中绿色格子因为使用魔法，不需要花费代价，蓝色的格子因为使用一次魔法，需要额外花费 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 点代价。（同样，这里不考虑格子实际颜色对代价的影响）</p>
<p>也许有同学会问了，如果出现下图中的这种情况呢？</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/71453.png" alt=""></p>
<p>显然从 <code>now</code> 出发先向右走后向下走是更优的，但是按照我们刚刚所述的方法，对 <code>now</code> 这个格子讨论，右下角的有色格子 <code>B</code> 会被认为要使用魔法，凭空多出了<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>点代价，我们刚刚的方法能得到最优解吗？</p>
<p>试问： <code>now</code> 右面的格子 <code>A</code> 是不是有色格子？</p>
<p>既然 <code>A</code> 是有色格子，那么我们也会对 <code>A</code> 讨论， <code>now</code> 可以不花费代价到达 <code>A</code> ， <code>A</code> 又可以不花费代价到达 <code>B</code> ，因此 <code>now</code> 到 <code>B</code> 格子的代价最终会被 <code>now-&gt;A-&gt;B</code> 的路径取代，不会出现丢失最优解的情况。</p>
<p>这时我们发现一个问题：普通的 <code>BFS</code> 似乎实现不了这种答案更新，具体的分析与解法将在下文讲解。</p>
<hr>
<h4>现在我们先把颜色加上去：</h4>
<ol>
<li>与魔法无关的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span>种转移，同色代价不变，异色代价加 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 。</li>
<li>涉及魔法的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">8</span></span></span></span>种转换，如果颜色相同，如图：</li>
</ol>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32560.png" alt=""></p>
<p>当格子 <code>via</code> 变成黄色的格子的时候，付出的代价最小，一共为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>个代价。</p>
<p>如果颜色不同，如图：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/32561.png" alt=""></p>
<p>当格子 <code>via</code> 变成黄色或者红色的时候，付出的代价都是一样的，一共为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">3</span></span></span></span>个代价。</p>
<hr>
<p>综上所述，我们将题目转化为如下：</p>
<blockquote>
<p>你需要从<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>走到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>，你只能走在有颜色的格子中，并且使得你所花费的代价最小。</p>
</blockquote>
<blockquote>
<p>当你站在一个有颜色的格子上的时候，你可以进行如下<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>种操作：</p>
<ol>
<li>向上、下、左、右前行。</li>
<li>向左上、左下、右上、右下、向上连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格、向下连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格、向左连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格、向右连跳<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>格前行。</li>
</ol>
</blockquote>
<blockquote>
<p>如果你使用的是操作 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> ，你将额外付出 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 点代价。</p>
</blockquote>
<blockquote>
<p>在一次操作中，如果你<strong>这次操作的起点格子与终点格子</strong>颜色不同，你将付出<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>点代价。</p>
</blockquote>
<p>完了吗？</p>
<p><strong>显然没有！</strong></p>
<p>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>没有颜色怎么办？</p>
<p>因为魔法不能连续使用，所以只可能从<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>转移。</p>
<ol>
<li>如果都没有颜色，就不可能到达<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>。</li>
<li>如果任何一个有颜色，相当于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>变化为有颜色的那个格子的颜色，总代价为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>。</li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>个都有颜色，转移总代价都是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>，最后做一下比较就可以了。</li>
</ol>
<hr>
<h2>算法分析</h2>
<p>下面我们主要研究 <code>BFS</code> 的实现。</p>
<p>现在我们已经将题意转化为经典的走迷宫模型，解决的经典方法是 <code>BFS</code> ，但是又有所不同。每一次拓展的代价不一定相同，此时可能出现如下的情况：
<img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/39190.png" alt=""></p>
<p><del>因为不满足三角形不等式，所以从实际来讲这里不应该画成三角形。但因为这张图简(wo)明(bi)直(jiao)观(lan)，所以这张图就不重画了。</del></p>
<p>显然，最短路径应该是 <code>1-&gt;2-&gt;3</code> ，而如果我们用一般的队列实现宽搜，就会得到错误的答案。</p>
<p>我们先思考一个问题：为什么经典的走迷宫模型可以直接普通队列 <code>BFS</code> ？</p>
<p>不难得出：在这样的 <code>BFS</code> 中，每一次扩展的代价都相等<strong>且为正数</strong>，<strong>后进入队列的状态一定不如先进入队列的状态优</strong>（先进入队列的状态的代价 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7719em; vertical-align: -0.136em;"></span><span class="mrel">≤</span></span></span></span> 后进入队列的状态的代价）。</p>
<p>基于这样的单调性，我们可以得出：第一次访问到某一个状态时，一定是这个状态的最优情况。</p>
<p>这是一个贪心思想。我们把这种思想应用到更具有普遍性的情况中：代价不一定相等。</p>
<p>现在我们有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>种解决方法：</p>
<ul>
<li>普通队列+迭代思想(<del>已经死掉的<code>SPFA</code></del>)</li>
</ul>
<p>我们无法保证第一次访问到某一个状态的最优性，但我们可以将<strong>被优化的状态</strong>不断压入队列中，直到所有状态都是最优的。这种算法最坏情况下可以达到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> （n为状态种数），一般情况下为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 。</p>
<ul>
<li>优先队列( <code>Dijkstra</code> )</li>
</ul>
<p>我们只要满足每一次都从状态队列中取出最小代价的状态，即可满足第一次访问最优性。优先队列可以实现这种操作。时间复杂度 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.207em;"><span style="top: -2.4559em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 。</p>
<p>有一种比较形象地解释，我们可以把 <code>BFS</code> 的棋盘看作图，即 <code>Dijkstra</code> 用来解决最短路。把这个图 <strong>“拎起来 ”</strong>，最初拎着起点，然后找当前最高的且没有被拎过的结点，作为下一次拎起来的结点，如此不断去拎，直到把终点结点拎起来，这样拎就可以找到起点和终点的最短距离。</p>
<p>注意，使用优先队列优化的 <code>BFS</code> 不能处理<strong>有负数代价</strong>的情况，反例如下：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/71455.png" alt=""></p>
<p>我们要从 <code>S</code> 走到 <code>T</code> ，第一步就可以找到所谓的最小代价<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>， <code>A</code> 虽然也在队列中，但是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">10</span></span></span></span>的代价比<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>大，因此不会被取出。</p>
<p>但实际上， <code>S</code> 走到 <code>T</code> 的最小代价是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord">90</span></span></span></span>，路径为 <code>S-&gt;A-&gt;T</code> ,我们得到了错误的答案。</p>
<hr>
<p>至此，我们成功跳出了命题人挖给我们的的思维陷阱，没有直接按照题意搜索，而是将题意转化，简化问题，大大降低了代码实现复杂度。（听说直接按照题意 <code>dfs</code> 会炸栈空间，虽然 <code>NOIP</code> 开大栈空间，但是你在跑大样例的时候看到程序报 <code>RE</code> 还找不到哪儿错了，对接下来做题的心态会有很大影响）</p>
<p>update on 2020.2.16. <code>CSP-S 2019</code> 的时候，我的几个同学因为不会开大栈空间 <code>Day1T2</code> 没法测大样例，丢分严重，且影响到 <code>Day2</code> 的发挥。</p>
<hr>
<h3>代码实现</h3>
<ol>
<li><code>BFS</code> +优先队列优化</li>
</ol>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">inf</span> <span class="token expression"><span class="token number">0x3f3f3f3f</span></span></span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Tp</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span>Tp <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">&lt;</span><span class="token char">'0'</span><span class="token operator">||</span>c<span class="token operator">&gt;</span><span class="token char">'9'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">==</span><span class="token char">'-'</span><span class="token punctuation">)</span>f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">&gt;=</span><span class="token char">'0'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token char">'9'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>c<span class="token operator">-</span><span class="token char">'0'</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>x<span class="token operator">*=</span>f<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//快速读入，不解释</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">,</span>w<span class="token punctuation">;</span> 
	<span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>node b<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span><span class="token comment">//const不可丢 </span>
		<span class="token keyword">return</span> w<span class="token operator">&gt;</span>b<span class="token punctuation">.</span>w<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token comment">//因为STL中优先队列默认取出最大的元素 </span>
	 <span class="token comment">//所以这里重载运算符，保证每次取出的是最小代价的 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
priority_queue<span class="token operator">&lt;</span>node<span class="token operator">&gt;</span>q<span class="token punctuation">;</span><span class="token comment">//node类型必须定义&lt; </span>
<span class="token keyword">int</span> dx<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//12方向及魔法代价 </span>
<span class="token keyword">int</span> dy<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dw<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//a存储棋盘上格子的颜色 </span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>dis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	node cur<span class="token punctuation">,</span>nxt<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cur<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>cur<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>cur<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token operator">&lt;</span>cur<span class="token punctuation">.</span>w<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//懒惰删除 </span>
			nxt<span class="token punctuation">.</span>x<span class="token operator">=</span>cur<span class="token punctuation">.</span>x<span class="token operator">+</span>dx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			nxt<span class="token punctuation">.</span>y<span class="token operator">=</span>cur<span class="token punctuation">.</span>y<span class="token operator">+</span>dy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			nxt<span class="token punctuation">.</span>w<span class="token operator">=</span>cur<span class="token punctuation">.</span>w<span class="token operator">+</span>dw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>nxt<span class="token punctuation">.</span>x<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token operator">||</span>nxt<span class="token punctuation">.</span>x<span class="token operator">&gt;</span>m<span class="token operator">||</span>nxt<span class="token punctuation">.</span>y<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token operator">||</span>nxt<span class="token punctuation">.</span>y<span class="token operator">&gt;</span>m<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token comment">//保证在棋盘范围内</span>
			nxt<span class="token punctuation">.</span>c<span class="token operator">=</span>a<span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nxt<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>c<span class="token operator">!=</span>nxt<span class="token punctuation">.</span>c<span class="token punctuation">)</span>nxt<span class="token punctuation">.</span>w<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//确定下一步的信息 </span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token operator">&gt;</span>nxt<span class="token punctuation">.</span>w<span class="token punctuation">)</span><span class="token punctuation">{</span>
				dis<span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>nxt<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token operator">=</span>nxt<span class="token punctuation">.</span>w<span class="token punctuation">;</span>
				q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>nxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
	<span class="token function">read</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">read</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token comment">//这里c+1，为了方便区分无色格子 </span>
	<span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//处理(m,m)无色情况 </span>
		<span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token operator">&gt;=</span>inf<span class="token punctuation">)</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token operator">==</span>inf<span class="token punctuation">)</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div>
<ol start="2">
<li>最短路（ <code>Dijkstra</code> ）</li>
</ol>
<p>注：下面的参考程序使用 <code>zkw线段树</code> 代替优先队列， <code>zkw线段树</code> 短小精悍，常数较小，并且支持直接单点修改，不需要优先队列的懒惰删除法。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">maxn</span> <span class="token expression"><span class="token number">100005</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">maxm</span> <span class="token expression"><span class="token number">2000005</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">inf</span> <span class="token expression"><span class="token number">0x3f3f3f3f</span></span></span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Tp</span><span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span>Tp <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">char</span> c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> f<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">&lt;</span><span class="token char">'0'</span><span class="token operator">||</span>c<span class="token operator">&gt;</span><span class="token char">'9'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">==</span><span class="token char">'-'</span><span class="token punctuation">)</span>f<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>c<span class="token operator">&gt;=</span><span class="token char">'0'</span><span class="token operator">&amp;&amp;</span>c<span class="token operator">&lt;=</span><span class="token char">'9'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>c<span class="token operator">-</span><span class="token char">'0'</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>x<span class="token operator">*=</span>f<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//快速读入，不解释 </span>
<span class="token keyword">struct</span> <span class="token class-name">Edge</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> f<span class="token punctuation">,</span>t<span class="token punctuation">,</span>w<span class="token punctuation">,</span>nxt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>edge<span class="token punctuation">[</span>maxm<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> head<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>etot<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//这里有一个小技巧，存图时边数初值设为一个奇数 </span>
<span class="token keyword">void</span> <span class="token function">add_edge</span><span class="token punctuation">(</span><span class="token keyword">int</span> f<span class="token punctuation">,</span><span class="token keyword">int</span> t<span class="token punctuation">,</span><span class="token keyword">int</span> w<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//这样可以利用位运算成对变化找到反向边 </span>
	edge<span class="token punctuation">[</span><span class="token operator">++</span>etot<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>Edge<span class="token punctuation">)</span><span class="token punctuation">{</span>f<span class="token punctuation">,</span>t<span class="token punctuation">,</span>w<span class="token punctuation">,</span>head<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token operator">=</span>etot<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//链式前向星存图 </span>
<span class="token comment">//--------以下内容为 zkw线段树</span>
<span class="token comment">//主要思路，用线段树维护dis</span>
<span class="token comment">//dis1数组表示在线段树中的dis</span>
<span class="token comment">//tr数组记录当前最小dis对应的节点编号 </span>
<span class="token comment">//有关zkw线段树，可以参考洛谷日报的讲解，这里不多说 </span>
<span class="token keyword">int</span> tr<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dis1<span class="token punctuation">[</span>maxn<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>bt<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>S<span class="token punctuation">,</span>T<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>bt<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>bt<span class="token operator">&lt;=</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>bt<span class="token operator">&lt;&lt;=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//bt初始化，zkw线段树的初始操作 </span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>tr<span class="token punctuation">[</span>i<span class="token operator">+</span>bt<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span><span class="token comment">//tr数组初始化 </span>
	<span class="token function">memset</span><span class="token punctuation">(</span>dis1<span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>dis1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//dis1数组初始化 </span>
	<span class="token comment">//因为这里dis初值都是inf，所以可以这样直接赋值 </span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">modify</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
	dis1<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">=</span>val<span class="token punctuation">;</span>x<span class="token operator">+=</span>bt<span class="token punctuation">;</span><span class="token comment">//单点修改 </span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>x<span class="token operator">&gt;&gt;=</span><span class="token number">1</span><span class="token punctuation">;</span>x<span class="token punctuation">;</span>x<span class="token operator">&gt;&gt;=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//以下是zkw线段树常规操作 </span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>dis1<span class="token punctuation">[</span>tr<span class="token punctuation">[</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>dis1<span class="token punctuation">[</span>tr<span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>tr<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">=</span>tr<span class="token punctuation">[</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> tr<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">=</span>tr<span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token comment">//其实上面的内容并不是很长，只是注释比较多 </span>
<span class="token keyword">int</span> dis<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//build()不可忘 </span>
	dis<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token function">modify</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//源点更新 </span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//这里tr[1]维护的是[1,n]dis的最小值的节点编号，所以直接调用 </span>
		x<span class="token operator">=</span>tr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">modify</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>inf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//这里将x设为极大值，来取代删除操作 </span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>nxt<span class="token punctuation">)</span><span class="token punctuation">{</span>
			y<span class="token operator">=</span>edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>t<span class="token punctuation">;</span>w<span class="token operator">=</span>edge<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">&gt;</span>dis<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//dijkstra松弛操作 </span>
				dis<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>dis<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token operator">+</span>w<span class="token punctuation">;</span>
				<span class="token function">modify</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>dis<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接更新 </span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> dx<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//12方向及魔法代价 </span>
<span class="token keyword">int</span> dy<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dw<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cnt<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>b<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//a存储棋盘上格子的颜色 </span>
<span class="token comment">//cnt表示棋盘上的格子对应的节点编号 </span>
<span class="token keyword">void</span> <span class="token function">preprocess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//建图 </span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">,</span>xx<span class="token punctuation">,</span>yy<span class="token punctuation">,</span>ww<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		x<span class="token operator">=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>y<span class="token operator">=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>c<span class="token operator">=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>c<span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			xx<span class="token operator">=</span>x<span class="token operator">+</span>dx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>yy<span class="token operator">=</span>y<span class="token operator">+</span>dy<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>ww<span class="token operator">=</span>dw<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token operator">!=</span>c<span class="token punctuation">)</span>ww<span class="token operator">++</span><span class="token punctuation">;</span>
				<span class="token function">add_edge</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>cnt<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">,</span>ww<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token comment">//这一段在上文题解中讲的比较详细，这里不再多说 </span>
	S<span class="token operator">=</span>cnt<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> mm<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
	<span class="token function">read</span><span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">read</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">read</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>cnt<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>
		b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">{</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token comment">//这里c+1，为了方便区分无色格子 </span>
	<span class="token function">preprocess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">dijkstra</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//因为在图论中m常代表的含义是边数 </span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//所以用mm取代原题目中的m，即棋盘大小 </span>
		<span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>cnt<span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">[</span>mm<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>cnt<span class="token punctuation">[</span>mm<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token operator">&gt;=</span>inf<span class="token punctuation">)</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token comment">//(m,m)没有颜色的特判 </span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>cnt<span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">==</span>inf<span class="token punctuation">)</span><span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>dis<span class="token punctuation">[</span>cnt<span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">[</span>mm<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div>
<p>附：卡掉本题 <code>dfs</code> +记忆化优化(即 <code>SPFA</code> )的做法：数据范围修改为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7719em; vertical-align: -0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1000</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100000</span></span></span></span> ，因为本题是棋盘，本身就是一种类似于网格图的东西，再加一些比较靠近的有色格子（只能说接近菊花图，因为这一题一个点出度最多为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">12</span></span></span></span>），再加一些链状有色格子（次优解长链），理论上来讲大部分可以卡掉了。</p></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 10109px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="float operations" style="width: 768.017px;"><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 520</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 93 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/28910.png" alt="览遍千秋"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/28910" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--purple-3);">览遍千秋</a></span></span><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/user-tag" disabled="false" class="" style="font-size: 0.875em;"><span data-v-386007e1="" data-v-1ecbf760="" style="background-color: rgb(156, 61, 207); border-color: rgb(138, 62, 179); color: rgb(255, 255, 255);">七海</span></a><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify-cpc" disabled="false" class=""><svg class="svg-inline--fa fa-balloon" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="balloon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="--fa-primary-color: var(--lfe-color--blue-3); --fa-secondary-color: #fff; --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M64 176c0 8.8 7.2 16 16 16s16-7.2 16-16c0-44.2 35.8-80 80-80c8.8 0 16-7.2 16-16s-7.2-16-16-16C114.1 64 64 114.1 64 176z"></path><path class="fa-primary" fill="currentColor" d="M0 192C0 86 86 0 192 0S384 86 384 192c0 102.6-102.8 194.9-143.6 227.5c-9.3 7.4-12.5 20.4-7.1 31l21.4 42.7c.9 1.8 1.4 3.8 1.4 5.8c0 7.1-5.8 12.9-12.9 12.9l-102.1 0c-7.1 0-12.9-5.8-12.9-12.9c0-2 .5-4 1.4-5.8l21.4-42.7c5.3-10.6 2.1-23.6-7.1-31C102.8 386.9 0 294.6 0 192zm96-16c0-44.2 35.8-80 80-80c8.8 0 16-7.2 16-16s-7.2-16-16-16C114.1 64 64 114.1 64 176c0 8.8 7.2 16 16 16s16-7.2 16-16z"></path></g></svg></a></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2018-10-23T04:25:29.000Z" title="2018-10-23 12:25:29">2018-10-23 12:25</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/jmv8a0j1" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h2>Update Log</h2>
<ul>
<li>2025-08-29 使用增量数组重写代码，修改 Latex 以符合审核规范并自己审核通过。</li>
</ul>
<h2>前沿</h2>
<p>本方法是出了考场只三分钟后，和同学脑袋一拍想出来的，<strong>翻了几乎所有题解，没有发现相同解法的</strong>，现在把它写出来，以祭奠逝去的 NOIP2017，迎接已至的 NOIP2018。</p>
<hr>
<h2>思路 1：搜索</h2>
<h3>基本搜索思路</h3>
<p>很显然，这是一道搜索题。</p>
<p>我们考虑用二元组 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span> 代表当前搜索到的格子，附带参数 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span> 为已经使用的金币，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span></span></span></span> 代表上一次有没有使用魔法。</p>
<p>这种搜索可能是大部分人看到题目就想到的算法，事实上，我最后提交的就是这种爆搜，55分，TLE。</p>
<p>这种要分很多类讨论，并且对于 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span></span></span></span> 的处理非常讨厌。</p>
<h3>魔法的转换</h3>
<p>上面提到的搜索，是对 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span> 周围四个点不断进行拓展，到了终点就记录答案。</p>
<p>如图：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/39182.png" alt=""></p>
<p>这样，我们就被命题人牵着鼻子走了。</p>
<p>考虑魔法，本质上是允许这个人从这个点走到距离为两格的<strong>有颜色</strong>格子里，代价为在走到相同或不同颜色的格子上的代价 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">+</span><span class="mord">2</span></span></span></span>。</p>
<p>即，如图：</p>
<p><img src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/39181.png" alt=""></p>
<p>上图中绿色格子就是距离为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 的格子，蓝色格子就是距离为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 的格子。</p>
<p><strong>请注意，无论是上图中蓝色或者绿色格子，都必须在原来的棋盘中是有颜色的</strong></p>
<p>通过这样的办法，我们可以将使用/不使用魔法统一起来：</p>
<ul>
<li>不使用魔法，只能走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 步，按照颜色支付代价</li>
<li>使用魔法，可以直接走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 步，按照颜色支付代价以外，额外支付 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 代价用于染色。</li>
</ul>
<p>在这样的情况下，可能存在 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span>，但本身 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span> 是有颜色的情况。走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 步会多算代价，但是结合了走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 步的方法，最终这两步会由走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 步的方法生成最小答案。</p>
<h3>最终搜索算法</h3>
<p>我们最终形成了这样的一个算法：</p>
<p>通过 dfs，搜索每一个格子，可以向周围<strong>十二</strong>个方向拓展：</p>
<ol>
<li>走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 步的方向：</li>
</ol>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
</ul>
<ol start="2">
<li>走 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 步的方向：</li>
</ol>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li>
</ul>
<h3>剪枝与答案统计</h3>
<p>设 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span> 代表到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span> 时的最小代价，初值为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">+</span><span class="mord">∞</span></span></span></span>。</p>
<p>如果 dfs 进入 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span> 的时候，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span>，则直接返回即可。</p>
<p>答案统计则有一些细节需要注意。当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 时自然可以统计答案。但是，这样的一个转化，让所有的步子都落在了有颜色的点上。如果 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 本身没有颜色，则会造成无法统计。</p>
<p>因此，需要在 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 或 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 的地方，判断 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 的颜色是否存在，如果不存在的话，则答案对 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 取 min。</p>
<h3>代码</h3>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> MAXM <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> INF <span class="token operator">=</span> <span class="token number">0x3f3f3f3f</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> col<span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> f<span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">,</span> ans <span class="token operator">=</span> INF<span class="token punctuation">;</span>
<span class="token keyword">bool</span> vis<span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">[</span>MAXM<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> dx<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dy<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> extra<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> y <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> x <span class="token operator">&gt;</span> m <span class="token operator">||</span> y <span class="token operator">&gt;</span> m<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> q<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    f<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> q<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> m <span class="token operator">&amp;&amp;</span> y <span class="token operator">==</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>col<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">+</span> y <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">*</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ans <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> q <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    vis<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> nx <span class="token operator">=</span> x <span class="token operator">+</span> dx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ny <span class="token operator">=</span> y <span class="token operator">+</span> dy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span>nx<span class="token punctuation">,</span> ny<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> col<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> vis<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> cost <span class="token operator">=</span> extra<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>col<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span> <span class="token operator">==</span> col<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">?</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">dfs</span><span class="token punctuation">(</span>nx<span class="token punctuation">,</span> ny<span class="token punctuation">,</span> q <span class="token operator">+</span> cost<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    vis<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cin <span class="token operator">&gt;&gt;</span> m <span class="token operator">&gt;&gt;</span> n<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cin <span class="token operator">&gt;&gt;</span> x <span class="token operator">&gt;&gt;</span> y <span class="token operator">&gt;&gt;</span> z<span class="token punctuation">;</span>
        col<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> z <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ans <span class="token operator">==</span> INF<span class="token punctuation">)</span> ans <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> ans <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 3825px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 29</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 11 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/310449.png" alt="dxzier"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/310449" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--pink-3);">dxzier</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2024-08-13T20:11:48.000Z" title="2024-08-14 04:11:48">2024-08-14 04:11</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/vxf3sb63" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><p>本篇题解思想部分来自于 NOIWC2024 第二课堂《最短路算法及其应用》。感谢 “北京大学附属中学 肖然”老师的讲解。</p>
<h2></h2>
<p>首先在阅读题目后我们可以得知，本题是在一个 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 的棋盘中，每个格子有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span> 空 三种情况，每次移动可以向上下左右四个方向移动一格，任意时刻所处的格子不能为空。每走一步：</p>
<ul>
<li>
<p>如果出发和到达的格子颜色相同，代价为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span>。</p>
</li>
<li>
<p>如果出发和到达的格子颜色不同，代价为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>。</p>
</li>
<li>
<p>可以暂时改变空为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span></span></span></span> 中的任意一种，代价为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>，<strong>不能连续使用</strong>。</p>
</li>
</ul>
<p>求从 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 走到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 的最小代价。</p>
<p>容易构造出下图，假设当前所处的点为 0，其中一步就能到达的点为 1，两步才能到达的点为 2。</p>
<table><colgroup><col class=""><col class=""><col class=""><col class=""><col class=""></colgroup><thead><tr><th style="text-align: center;"></th><th style="text-align: center;"></th><th style="text-align: center;">2</th><th style="text-align: center;"></th><th style="text-align: center;"></th></tr></thead><tbody><tr><td style="text-align: center;"></td><td style="text-align: center;">2</td><td style="text-align: center;">1</td><td style="text-align: center;">2</td><td style="text-align: center;"></td></tr><tr><td style="text-align: center;">2</td><td style="text-align: center;">1</td><td style="text-align: center;">0</td><td style="text-align: center;">1</td><td style="text-align: center;">2</td></tr><tr><td style="text-align: center;"></td><td style="text-align: center;">2</td><td style="text-align: center;">1</td><td style="text-align: center;">2</td><td style="text-align: center;"></td></tr><tr><td style="text-align: center;"></td><td style="text-align: center;"></td><td style="text-align: center;">2</td><td style="text-align: center;"></td><td style="text-align: center;"></td></tr></tbody></table>
<p>对于每一个不为空的点，我们可以按照如下方法建图：</p>
<ul>
<li>
<p>如果在标记为 1 的地方存在点，则由标记为 0 的点向此点连边即可，边权由颜色异同决定。</p>
</li>
<li>
<p>如果在标记为 2 的地方存在点，行走过程为先由标记为 0 的点走向标记为 1 的点，再走向标记为 2 的点，但可以<strong>直接连接</strong>一条从标记为 0 的点到此点的边，边权由颜色异同决定后再加二。</p>
</li>
<li>
<p>对于标记为 1 的点，如果它为空，但坐标却为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>，可以连接一条由标记为 0 的点向此点，边权为二的边。容易发现仅当该点处在标记为 0 的点的下方或右方时，此点才有可能是 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>。</p>
</li>
<li>
<p>对于标记为 2 的点，如果它为空，但坐标却为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>，容易发现无法<strong>直接</strong>到达，因为无法连续改变点的颜色。</p>
</li>
</ul>
<p>在第二条中，如果中间经过的标记为 1 的点不为空，这条由标记为 0 的点<strong>直接</strong>连向标记为 2 的点的边的边权<strong>大于等于二</strong>。而先由标记为 0 的点走向标记为 1 的点，再走向标记为 2 的点，<strong>这两条边的边权之和小于等于二</strong>。所以这样的非法连边在结果上一定不会更优，也就无需对此类非法边进行判断。</p>
<p>建图后在图上跑最短路即可。如果无法到达 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> 则输出 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>。</p>
<hr>
<p>上述内容与其它题解无异。诚然，这是一道普及组的题目，但在更大的数据范围中，原解法是否仍有一些优化的空间？</p>
<h3>稀疏矩阵存储</h3>
<p>首先是点的存储问题。在最初的做法中，由于 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7719em; vertical-align: -0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100</span></span></span></span>，我们可以使用二维数组存储整个棋盘，然后对其中每一个非空点做上述的建图操作即可。这会使我们的空间复杂度达到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。而如果不使用二维数组，直接判断两点曼哈顿距离，则会使时间复杂度达到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。但当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span> 扩大到很大却处于同一数量级时，容易发现二维数组中仅有极少一部分点是真正有用的。</p>
<p>对于这种稀疏矩阵的存储，容易想到使用一些数据结构，比如 std::unordered_map。我们可以创建如下对象来存储棋盘中的有效点。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp">std<span class="token double-colon punctuation">::</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span> M<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div>
<p>这样我们可以得到一个常数稍大的二维数组，但其平均时空复杂度仍然是 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 的。</p>
<h3>特殊条件下的线性单源最短路</h3>
<h4><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0/1</span></span></span></span> BFS</h4>
<p>让我们重新审视单源最短路问题。首先考虑一种特殊情况，边权只有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0/1</span></span></span></span> 两种取值。对于这样的图在 BFS 时可以使用两个队列，每次取两个队列队头中已经过长度 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 较小的一个元素。对于此点连向的还没遍历过的点，如果边权为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> 则加入第零个队列，如果边权为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 则加入第一个队列。</p>
<p>若保证队列零中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 相同，队列一队头元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 大于等于队列零队头元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span>，且队列一中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比两队列队头中较小的那个大一。</p>
<ul>
<li>
<p>一个元素被插入队列一，其 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 仅比此时队头中 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 较小的那个大一，则新插入队列一的元素可以保证队列一仍然具有原性质，则此时原有三项性质均不变。</p>
</li>
<li>
<p>一个元素被插入队列零，若来自队列零则原有三项性质均不变。</p>
</li>
<li>
<p>一个元素被插入队列零，若来自队列一，则队列一队头元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 与队列零队头元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 相同，或队列零为空。对于两种子情况原有三项性质均不变。</p>
</li>
<li>
<p>初始情况下两队列均为空，向任意队列加入初始元素，均具有上述三项性质。</p>
</li>
</ul>
<p>综上所述，该方法可以保证每次取到元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减，所以该方法可以处理边权仅有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0/1</span></span></span></span> 的图上的单源最短路问题。</p>
<h4><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1/2</span></span></span></span> BFS</h4>
<p>对于这样的图同样可以在 BFS 时可以使用两个队列，每次取两个队列队头中已经过长度 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 较小的一个元素。对于此点连向的还没遍历过的点，如果边权为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 则加入第一个队列，如果边权为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 则加入第二个队列。</p>
<p>此时证明甚至更加简单，仅有两条性质：</p>
<p>队列一中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比两队列队头中较小的那个大一，且队列二中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比两队列队头中较小的那个大二。</p>
<p>仅需同理证明如上两条性质时刻成立，即可保证每次取到元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减，所以该方法可以处理边权仅有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1/2</span></span></span></span> 的图上的单源最短路问题。证明过程不再赘述。</p>
<h4><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">b</span></span></span></span> BFS <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> 且 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></h4>
<p>与 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1/2</span></span></span></span> BFS 类似，证明如下两条性质时刻成立：</p>
<p>队列一中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比两队列队头中较小的那个大 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，且队列二中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比两队列队头中较小的那个大 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>。</p>
<p>由于两条性质时刻成立，可以保证每次取到元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减，所以该方法可以处理边权仅有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">b</span></span></span></span> 的图上的单源最短路问题。证明过程同样不再赘述。</p>
<h4>多边权 BFS</h4>
<p>从上面的思考容易想到可以对每一种边权建立一个队列，容易证明过程中对于任意一个队列 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 均保持队列中每个元素 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 单调不递减且最多比任意一个队列队头中最小的那个大 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>。</p>
<p>假设有 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> 种不同边权，每次选出其中队头元素的 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span></span></span></span> 最小的一个则需要 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span> 的时间复杂度。当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> 很小，且与题目输入无关时，我们可以不计入复杂度将其看作常数。所以当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> 足够小时，我们可以认为此时最短路算法为线性。（参考“南京外国语学校 杨敏行”《浅谈复杂度及其在解决问题方面的应用》）</p>
<p>但当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span> 很大时，这样的做法显然是不优的，于是可以想到用优先队列维护每个队列队头的元素。此时发现代码太过复杂，于是再简化一下代码，把所有元素全部丢进优先队列！于是！我们惊奇的发现！我们重新发明了 Dijkstra 算法！</p>
<p>（（肖老师：早生五十年，你也能发明这些算法。</p>
<h2></h2>
<p>根据上述所有内容，可以发现此题中当 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span> 扩大到很大却处于同一数量级时棋盘为稀疏矩阵，且仅出现边权 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0/1/2/3</span></span></span></span>，于是可以线性解决。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstdio&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;queue&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unordered_map&gt;</span></span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>unordered_map<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> U<span class="token punctuation">,</span>V<span class="token punctuation">,</span>W<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">point</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> id<span class="token punctuation">,</span>W<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span> M<span class="token punctuation">;</span>
unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>edge<span class="token operator">&gt;&gt;</span> v<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> s1<span class="token punctuation">,</span><span class="token keyword">int</span> s2<span class="token punctuation">,</span><span class="token keyword">int</span> w0<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> id1<span class="token operator">=</span>s1<span class="token operator">&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">,</span>c1<span class="token operator">=</span><span class="token punctuation">(</span>s1<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> id2<span class="token operator">=</span>s2<span class="token operator">&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">,</span>c2<span class="token operator">=</span><span class="token punctuation">(</span>s2<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>s2<span class="token operator">==</span>t<span class="token operator">&amp;&amp;</span>t<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>c1<span class="token operator">!=</span>c2<span class="token punctuation">)</span>
			w0<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token punctuation">(</span>v<span class="token punctuation">[</span>id1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{</span>id1<span class="token punctuation">,</span>id2<span class="token punctuation">,</span>w0<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">buildmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator it1<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>it1<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator it2<span class="token operator">=</span><span class="token punctuation">(</span>it1<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>it2<span class="token operator">!=</span><span class="token punctuation">(</span>it1<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> x<span class="token operator">=</span>it1<span class="token operator">-&gt;</span>first<span class="token punctuation">,</span>y<span class="token operator">=</span>it2<span class="token operator">-&gt;</span>first<span class="token punctuation">;</span>
			
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i1<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i2<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i3<span class="token operator">=</span>i2<span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i4<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//x-1,y</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i1<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i1<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i1<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x,y-1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i2<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i2<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i2<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x,y+1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i3<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i3<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i3<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>m<span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x+1,y</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i4<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i4<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i4<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span>y<span class="token operator">==</span>m<span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span>y<span class="token operator">==</span>m<span class="token punctuation">)</span>
				<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>t<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i21<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i22<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i23<span class="token operator">=</span>i22<span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i24<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i25<span class="token operator">=</span>i24<span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i26<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i27<span class="token operator">=</span>i26<span class="token punctuation">;</span>
			unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator i28<span class="token operator">=</span>M<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//x-2,y</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i21<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i21<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i21<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x-1,y-1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i22<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i22<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i22<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x-1,y+1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i23<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i23<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i23<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x,y-2</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i24<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i24<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i24<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x,y+2</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i25<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i25<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i25<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x+1,y-1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i26<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i26<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i26<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x+1,y+1</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i27<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i27<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i27<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//x+2,y</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>i28<span class="token operator">!=</span>M<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator in0<span class="token operator">=</span><span class="token punctuation">(</span>i28<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>in0<span class="token operator">!=</span><span class="token punctuation">(</span>i28<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token function">add</span><span class="token punctuation">(</span>it2<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span>in0<span class="token operator">-&gt;</span>second<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			it2<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		it1<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> h<span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>queue<span class="token operator">&lt;</span>point<span class="token operator">&gt;</span> q<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
point <span class="token function">getq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	point ret<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2147483647</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			point f<span class="token operator">=</span>q<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>W<span class="token operator">&lt;</span>ret<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">{</span>
				ret<span class="token operator">=</span>f<span class="token punctuation">;</span>
				j<span class="token operator">=</span>i<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	q<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">BFS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">long</span> <span class="token keyword">long</span> ans<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>s<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		point tp<span class="token operator">=</span><span class="token function">getq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>tp<span class="token punctuation">.</span>id<span class="token operator">==</span>t<span class="token punctuation">)</span><span class="token punctuation">{</span>
			ans<span class="token operator">=</span>tp<span class="token punctuation">.</span>W<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>tp<span class="token punctuation">.</span>id<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>h<span class="token punctuation">[</span>tp<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		h<span class="token punctuation">[</span>tp<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>edge<span class="token operator">&gt;&gt;</span><span class="token double-colon punctuation">::</span>iterator v0<span class="token operator">=</span>v<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>tp<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>v0<span class="token operator">!=</span>v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token punctuation">(</span>v0<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				edge tedge<span class="token operator">=</span><span class="token punctuation">(</span>v0<span class="token operator">-&gt;</span>second<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				q<span class="token punctuation">[</span>tedge<span class="token punctuation">.</span>W<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>tedge<span class="token punctuation">.</span>V<span class="token punctuation">,</span>tp<span class="token punctuation">.</span>W<span class="token operator">+</span>tedge<span class="token punctuation">.</span>W<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	h<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">(</span>M<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>c<span class="token punctuation">;</span>
		h<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> s<span class="token operator">=</span>i<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span>m<span class="token operator">&amp;&amp;</span>y<span class="token operator">==</span>m<span class="token punctuation">)</span> t<span class="token operator">=</span>i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">buildmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span><span class="token function">BFS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 6869px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 17</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 7 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/1020835.png" alt="__galaxy_1202__"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/1020835" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--orange-3);">__galaxy_1202__</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--green-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-06T13:29:47.000Z" title="2025-01-06 21:29:47">2025-01-06 21:29</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/o3qxqzll" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="collapsed" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h2>解题思路：</h2>
<p>暴力出奇迹！数据范围不大，跟着题意直接爆搜加剪枝即可。</p>
<p>对于这种求最小值的爆搜，一个非常玄学且有效的剪枝就是记录每个格子当前所用的最短时间。</p>
<p>然后就没了。要注意把第一个点初始化好<del>当初 <code>dict</code> 第一个点没初始化调了我半天。</del></p></div></div></div><div data-v-e98509d8="" class="expand"><div data-v-359e8271="" data-v-e98509d8-s="" class="expand"><a data-v-12b24cc3="" data-v-359e8271="" data-v-e98509d8-s="" href="javascript:void 0" disabled="false" class="">展开全文&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"></path></svg></a></div></div></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 205px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations"><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 17</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 8 条评论 </span><!----></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/349824.png" alt="WsW_"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/349824" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--pink-3);">WsW_</a></span></span><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/user-tag" disabled="false" class="" style="font-size: 0.875em;"><span data-v-386007e1="" data-v-1ecbf760="" style="background-color: rgb(254, 76, 97); border-color: rgb(233, 64, 84); color: rgb(255, 255, 255);">花逝爆零人</span></a><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-05T04:22:18.000Z" title="2025-01-05 12:22:18">2025-01-05 12:22</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/5y9oxafu" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h3>思路</h3>
<p>如果没有颜色的限制，这题就是常规的 bfs 单源最短路。但是有了颜色限制，考虑多了这些限制会怎样。<br>
如果你熟悉“分层图”，那就应该知道几乎所有<strong>多了其他限制</strong>的单源最短路，都可以用“分层图”的思想解决。<br>
“分层图”简单来说就是，不仅仅以到达的<strong>点</strong>定义状态，还通过题中所给的一些<strong>特殊限制</strong>来定义状态。<br>
在常规的 bfs 单源最短路中，仅仅以到达的点来定义状态，存储的是到某个点的最小花费。<br>
在本题中，我们可以定义状态为“到达的格子坐标，这个格子的颜色，是否在这个格子上使用了魔法”。显然，对于一个本来就有颜色的格子，它的状态为“这个格子的坐标，这个格子本来的颜色，未使用魔法”；对于一个本来没有颜色的格子，它的状态为“这个格子的坐标，红色或者黄色，使用了魔法”。<br>
应当分别存储到达不同的状态所需要的最小花费。</p>
<p>在进行 bfs 单源最短路时，根据题目限制，从一种状态转移到另一种状态即可。</p>
<hr>
<h3>代码</h3>
<p>这是以前的代码，并不是根据“分层图”的思想写的。<br>
之后将会更新代码。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>col<span class="token punctuation">;</span>
	<span class="token keyword">bool</span> magic<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
queue<span class="token operator">&lt;</span>node<span class="token operator">&gt;</span>q<span class="token punctuation">;</span>
<span class="token keyword">int</span> mp<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ans<span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">103</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dir<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> m<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>mp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		node z<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> x<span class="token operator">=</span>z<span class="token punctuation">.</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>z<span class="token punctuation">.</span>y<span class="token punctuation">,</span>col<span class="token operator">=</span>z<span class="token punctuation">.</span>col<span class="token punctuation">,</span>w<span class="token operator">=</span>z<span class="token punctuation">.</span>w<span class="token punctuation">;</span>
		<span class="token keyword">bool</span> f<span class="token operator">=</span>z<span class="token punctuation">.</span>magic<span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> nx<span class="token operator">=</span>x<span class="token operator">+</span>dir<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> ny<span class="token operator">=</span>y<span class="token operator">+</span>dir<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>nx<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>ny<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>nx<span class="token operator">&gt;</span>m<span class="token operator">||</span>ny<span class="token operator">&gt;</span>m<span class="token operator">||</span><span class="token punctuation">(</span>f<span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> cost<span class="token punctuation">,</span>ncol<span class="token punctuation">;</span>
			<span class="token keyword">bool</span> nf<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				nf<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
				cost<span class="token operator">=</span><span class="token punctuation">(</span>col<span class="token operator">!=</span>mp<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				ncol<span class="token operator">=</span>mp<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span><span class="token punctuation">{</span>
				nf<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
				cost<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
				ncol<span class="token operator">=</span>col<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">+</span>cost<span class="token operator">&lt;</span>ans<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				ans<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token operator">=</span>w<span class="token operator">+</span>cost<span class="token punctuation">;</span>
				q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>nx<span class="token punctuation">,</span>ny<span class="token punctuation">,</span>w<span class="token operator">+</span>cost<span class="token punctuation">,</span>ncol<span class="token punctuation">,</span>nf<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> n<span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>m<span class="token punctuation">,</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span><span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		mp<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1e9</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">bfs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1e9</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n\n"</span><span class="token punctuation">,</span>ans<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 1845px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 18</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 3 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/791222.png" alt="lby_commandBlock"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/791222" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--orange-3);">lby_commandBlock</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--green-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-06T11:58:49.000Z" title="2025-01-06 19:58:49">2025-01-06 19:58</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/8fc7b3rr" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="collapsed" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h2>前言</h2>
<p>通过观察题目<del>标签</del>可知，该题是一道最短路题，但是也可以用搜索做。这篇题解我们使用 BFS 进行举例。</p>
<h2>思路</h2>
<p><strong>BFS 状态定义</strong></p></div></div></div><div data-v-e98509d8="" class="expand"><div data-v-359e8271="" data-v-e98509d8-s="" class="expand"><a data-v-12b24cc3="" data-v-359e8271="" data-v-e98509d8-s="" href="javascript:void 0" disabled="false" class="">展开全文&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"></path></svg></a></div></div></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 247px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations"><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 11</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 8 条评论 </span><!----></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/554145.png" alt="Night_sea_64"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/554145" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--pink-3);">Night_sea_64</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-05T09:21:44.000Z" title="2025-01-05 17:21:44">2025-01-05 17:21</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/6n0sadzt" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><p>这题很久以前我们校内出了原题，然后我重新打了一遍，由于 OI 赛制我看不见分，最后发现因为没删调试输出爆零了。。。</p>
<p>状态 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> 表示位置 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span>，是否使用了魔法，当前颜色是什么。</p>
<p>然后直接模拟所有的方向应该怎么使用魔法并改变颜色。发现边权可能会是 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span>，所以不能直接用 bfs 做，无脑 SPFA 即可。</p>
<p>当然转换一下也可以使用 bfs。当从有色格子到达无色格子时，可以先设计出一个中间的状态，借助这个状态到达无色格子，这样每一步的边权都是 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> 或 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span>，可以使用 01 bfs。</p>
<p>以下是 SPFA 的代码。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;queue&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
<span class="token keyword">int</span> dx<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> dy<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> d<span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span><span class="token punctuation">{</span><span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>k<span class="token punctuation">,</span>c<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    queue<span class="token operator">&lt;</span>node<span class="token operator">&gt;</span>q<span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>k<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>k<span class="token punctuation">,</span>c<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>c<span class="token punctuation">;</span>
        <span class="token comment">//cout&lt;&lt;x&lt;&lt;" "&lt;&lt;y&lt;&lt;" "&lt;&lt;k&lt;&lt;" "&lt;&lt;c&lt;&lt;" "&lt;&lt;d[x][y][k][c]&lt;&lt;endl;</span>
        q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">int</span> nx<span class="token operator">=</span>x<span class="token operator">+</span>dx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>ny<span class="token operator">=</span>y<span class="token operator">+</span>dy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>nx<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>nx<span class="token operator">&gt;</span>n<span class="token operator">||</span>ny<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">||</span>ny<span class="token operator">&gt;</span>n<span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> nk<span class="token punctuation">,</span>nw<span class="token punctuation">,</span>nc<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> nk<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>nw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>nc<span class="token operator">=</span>c<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                nk<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>nc<span class="token operator">=</span>a<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">)</span>nw<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> nw<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">+</span>nw<span class="token operator">&lt;</span>d<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">[</span>nk<span class="token punctuation">]</span><span class="token punctuation">[</span>nc<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                d<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">[</span>ny<span class="token punctuation">]</span><span class="token punctuation">[</span>nk<span class="token punctuation">]</span><span class="token punctuation">[</span>nc<span class="token punctuation">]</span><span class="token operator">=</span>d<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">+</span>nw<span class="token punctuation">;</span>
                q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>nx<span class="token punctuation">,</span>ny<span class="token punctuation">,</span>nk<span class="token punctuation">,</span>nc<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cin<span class="token operator">&gt;&gt;</span>n<span class="token operator">&gt;&gt;</span>m<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
        cin<span class="token operator">&gt;&gt;</span>x<span class="token operator">&gt;&gt;</span>y<span class="token operator">&gt;&gt;</span>c<span class="token punctuation">;</span>
        a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">spfa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">min</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token function">min</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>d<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token operator">&lt;</span><span class="token number">1e9</span><span class="token punctuation">)</span>cout<span class="token operator">&lt;&lt;</span>ans<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 1626px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 6</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 1 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/1004349.png" alt="HHC883"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/1004349" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--pink-3);">HHC883</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--green-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-04T13:48:30.000Z" title="2025-01-04 21:48:30">2025-01-04 21:48</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/hpbiwnl6" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><h1>题目分析</h1>
<p>首先，这道题肯定是不能用 DP 做的，因为可以向上、下、左、右四个方向移动，不具有无后效性，而且转移特别复杂，用 DP 肯定不现实。</p>
<p>于是我们考虑使用最短路。</p>
<p>第一个问题是如何为格子编号。这很简单，我们可以将第 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 行第 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span> 列的格子编号为 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span>，这样不同的格子编号互不相同，于是我们就可以以每个格子为点建图了。</p>
<p>第二个问题是如何连边。这个只需要按照题目中规定的走法进行就可以了，但是要注意一些细节。</p>
<p>最后，跑一遍堆优化的 Dijkstra 即可。</p>
<h1>参考代码</h1>
<p>建边部分的代码特别长，但实际上是无脑的复制粘贴。</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;cstring&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;queue&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> m<span class="token punctuation">,</span>n<span class="token punctuation">,</span>mp<span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">105</span><span class="token punctuation">]</span><span class="token punctuation">,</span>nxt<span class="token punctuation">[</span><span class="token number">40005</span><span class="token punctuation">]</span><span class="token punctuation">,</span>head<span class="token punctuation">[</span><span class="token number">10005</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cnt<span class="token punctuation">,</span>dis<span class="token punctuation">[</span><span class="token number">10005</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> vis<span class="token punctuation">[</span><span class="token number">10005</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> v<span class="token punctuation">,</span>l<span class="token punctuation">;</span>
<span class="token punctuation">}</span> es<span class="token punctuation">[</span><span class="token number">40005</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">d</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> to<span class="token punctuation">,</span>dis<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>d a<span class="token punctuation">,</span>d b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> b<span class="token punctuation">.</span>dis<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>dis<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
priority_queue<span class="token operator">&lt;</span>d<span class="token operator">&gt;</span> q<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span><span class="token keyword">int</span> v<span class="token punctuation">,</span><span class="token keyword">int</span> l<span class="token punctuation">)</span><span class="token punctuation">{</span>
	es<span class="token punctuation">[</span><span class="token operator">++</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token operator">=</span>v<span class="token punctuation">,</span>es<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">=</span>l<span class="token punctuation">;</span>
	nxt<span class="token punctuation">[</span>cnt<span class="token punctuation">]</span><span class="token operator">=</span>head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span>cnt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>m<span class="token operator">+</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cin<span class="token operator">&gt;&gt;</span>m<span class="token operator">&gt;&gt;</span>n<span class="token punctuation">;</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		cin<span class="token operator">&gt;&gt;</span>x<span class="token operator">&gt;&gt;</span>y<span class="token operator">&gt;&gt;</span>c<span class="token punctuation">;</span>
		mp<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>mp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">!=</span>mp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">link</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span> dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
	dis<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> minn<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">;</span>
		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>minn<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		vis<span class="token punctuation">[</span>minn<span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>head<span class="token punctuation">[</span>minn<span class="token punctuation">]</span><span class="token punctuation">;</span>i<span class="token punctuation">;</span>i<span class="token operator">=</span>nxt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>minn<span class="token punctuation">]</span><span class="token operator">+</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token operator">&lt;</span>dis<span class="token punctuation">[</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				dis<span class="token punctuation">[</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">]</span><span class="token operator">=</span>dis<span class="token punctuation">[</span>minn<span class="token punctuation">]</span><span class="token operator">+</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">;</span>
				q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">{</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">,</span>dis<span class="token punctuation">[</span>es<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>dis<span class="token punctuation">[</span>m<span class="token operator">*</span>m<span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">1e9</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>dis<span class="token punctuation">[</span>m<span class="token operator">*</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 42px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 2444px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 6</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 2 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/1078013.png" alt="qsn123"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/1078013" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--orange-3);">qsn123</a></span></span><!----><a data-v-12b24cc3="" data-v-1ecbf760="" target="_blank" href="https://help.luogu.com.cn/manual/luogu/account/award-certify" disabled="false" class=""><svg class="svg-inline--fa fa-badge-check" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="badge-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="--fa-primary-color: #fff; --fa-secondary-color: var(--lfe-color--blue-3); --fa-secondary-opacity: 1;"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M0 256c0 36.8 20.7 68.8 51.1 84.9C41 373.8 49 411 75 437s63.3 34 96.1 23.9C187.2 491.3 219.2 512 256 512s68.8-20.7 84.9-51.1C373.8 471 411 463 437 437s34-63.3 23.9-96.1C491.3 324.8 512 292.8 512 256s-20.7-68.8-51.1-84.9C471 138.2 463 101 437 75s-63.3-34-96.1-23.9C324.8 20.7 292.8 0 256 0s-68.8 20.7-84.9 51.1C138.2 41 101 49 75 75s-34 63.3-23.9 96.1C20.7 187.2 0 219.2 0 256zm136 0c0-6.1 2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l47 47c37-37 74-74 111-111c4.7-4.7 10.8-7 17-7s12.3 2.3 17 7c2.3 2.3 4.1 5 5.3 7.9c.6 1.5 1 2.9 1.3 4.4c.2 1.1 .3 2.2 .3 2.2c.1 1.2 .1 1.2 .1 2.5c-.1 1.5-.1 1.9-.1 2.3c-.1 .7-.2 1.5-.3 2.2c-.3 1.5-.7 3-1.3 4.4c-1.2 2.9-2.9 5.6-5.3 7.9c-42.7 42.7-85.3 85.3-128 128c-4.7 4.7-10.8 7-17 7s-12.3-2.3-17-7c-21.3-21.3-42.7-42.7-64-64c-4.7-4.7-7-10.8-7-17z"></path><path class="fa-primary" fill="currentColor" d="M369 175c9.4 9.4 9.4 24.6 0 33.9L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0z"></path></g></svg></a><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-04T08:23:03.000Z" title="2025-01-04 16:23:03">2025-01-04 16:23</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/quk9ceam" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="collapsed" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><p>考虑直接建图，转化为从起点到终点的四联通最短路问题。不难发现有用的点数量只有有颜色的
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span> 个，直接建图可行。</p>
<p>所以，问题来了：怎么连边？</p>
<p>答：以费用为边权，建出双向边（因为你也不知道具体走法），分类讨论所有情况即可。</p></div></div></div><div data-v-e98509d8="" class="expand"><div data-v-359e8271="" data-v-e98509d8-s="" class="expand"><a data-v-12b24cc3="" data-v-359e8271="" data-v-e98509d8-s="" href="javascript:void 0" disabled="false" class="">展开全文&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"></path></svg></a></div></div></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 172px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations"><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 6</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 1 条评论 </span><!----></div><!----></div></div><div data-v-ac34e482="" class="row"><div data-v-359e8271="" data-v-ac34e482-s="" class="solution-article"><div data-v-359e8271="" class="header"><div data-v-359e8271="" class="left"><div data-v-1ecbf760="" data-v-359e8271="" class="luogu-username"><img data-v-1ecbf760="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/1435313.png" alt="Iron_Spade"><span data-v-db920be0="" data-v-1ecbf760=""><span data-v-db920be0=""><a data-v-12b24cc3="" data-v-1ecbf760="" data-v-db920be0-s="" href="https://www.luogu.com.cn/user/1435313" class="" disabled="false" style="font-weight: bold; font-size: 1em; color: var(--lfe-color--green-3);">Iron_Spade</a></span></span><!----><!----><!----></div><span data-v-359e8271="" class="lfe-caption">创建时间：<time data-v-359e8271="" datetime="2025-01-04T15:00:37.000Z" title="2025-01-04 23:00:37">2025-01-04 23:00</time></span></div><span data-v-359e8271="" class="right"><a data-v-12b24cc3="" data-v-359e8271="" href="https://www.luogu.com.cn/article/thjkp2xe" disabled="false" class=""> 查看文章 </a></span></div><div data-v-359e8271="" class="main" style="position: relative;"><div data-v-e98509d8="" data-v-359e8271="" class="collapsed-wrapper"><div data-v-e98509d8="" class="" style="--lcollapsed-height: 320px;"><!----><div data-v-359e8271="" data-v-e98509d8-s="" class="lfe-marked-wrap marked"><div class="lfe-marked"><p>两百万年前做过的题目拿来重新做还是原来的感觉。</p>
<p>发现 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7719em; vertical-align: -0.136em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">100</span></span></span></span>，考虑记搜。</p>
<p>定义 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span></span></span></span></span></span></span></span></span></span> 表示从 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 走到 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span> 的最小代价。</p>
<p>然后我们按题意模拟，遇到颜色相同格子则以 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span> 代价走，遇到颜色不同格子则以 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span> 代价走，如果无色就只能用魔法以 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span> 代价走，注意 dfs 时要将施过魔法的格子颜色改变回溯时再还原。</p>
<p>注意格子要与无色的区分开所以我们考虑把格子的颜色都加上一，无色的格子记为零。</p>
<p>代码实现非常简单：</p>
<div data-v-6e0a2e13="" class="code-container"><pre data-v-6e0a2e13="" data-line="" class="pre hide-numbers language-cpp line-numbers" tabindex="0"><code data-v-6e0a2e13="" class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FASTIO</span> <span class="token expression">ios<span class="token double-colon punctuation">::</span><span class="token function">sync_with_stdio</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cout<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">rep</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> j<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> k<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">pre</span><span class="token expression"><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> j<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> k<span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">int</span> <span class="token expression"><span class="token keyword">long</span> <span class="token keyword">long</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">inf</span> <span class="token expression">LONG_LONG_MAX</span></span>


<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> dx<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> dy<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">2e2</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> vis<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> ret <span class="token operator">=</span> inf<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> k<span class="token punctuation">,</span> flg<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">&gt;</span> ret<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">==</span> n <span class="token operator">&amp;&amp;</span> y <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token keyword">return</span> ret <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span> xx <span class="token operator">=</span> x <span class="token operator">+</span> dx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> yy <span class="token operator">=</span> y <span class="token operator">+</span> dy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>xx <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> xx <span class="token operator">&gt;</span> n <span class="token operator">||</span> yy <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> yy <span class="token operator">&gt;</span> n <span class="token operator">||</span> vis<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		vis<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> s <span class="token operator">&lt;</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">!=</span> a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> s <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token function">dfs</span><span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				a<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		vis<span class="token punctuation">[</span>xx<span class="token punctuation">]</span><span class="token punctuation">[</span>yy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> 

<span class="token keyword">signed</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	FASTIO
	<span class="token function">memset</span><span class="token punctuation">(</span>dp<span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> dp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cin <span class="token operator">&gt;&gt;</span> n <span class="token operator">&gt;&gt;</span> m<span class="token punctuation">;</span>
	<span class="token function">rep</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span> cin <span class="token operator">&gt;&gt;</span> x <span class="token operator">&gt;&gt;</span> y <span class="token operator">&gt;&gt;</span> k<span class="token punctuation">,</span> a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">++</span>k<span class="token punctuation">;</span>
	<span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>ret <span class="token operator">&gt;</span> <span class="token number">1e9</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 42px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><button data-v-6e0a2e13="" type="button" class="copy-button"><svg data-v-6e0a2e13="" class="svg-inline--fa fa-copy copy-icon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="" fill="currentColor" d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z"></path></svg></button></div></div></div></div><!----></div><div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div class="resize-sensor-expand" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 736px; height: 1305px;"></div></div><div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"><div style="position: absolute; left: 0px; top: 0px; transition: all; width: 200%; height: 200%;"></div></div></div></div><div data-v-359e8271="" class="operations" style=""><span data-v-359e8271="" class="button thumb-up"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2l144 0c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48l-97.5 0c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3l0-38.3 0-48 0-24.9c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192l64 0c17.7 0 32 14.3 32 32l0 224c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32L0 224c0-17.7 14.3-32 32-32z"></path></svg> 4</span><span data-v-359e8271="" class="button thumb-down"><svg data-v-359e8271="" class="svg-inline--fa fa-thumbs-down" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2l144 0c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48l-97.5 0c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7l0 38.3 0 48 0 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384l64 0c17.7 0 32-14.3 32-32l0-224c0-17.7-14.3-32-32-32L32 96C14.3 96 0 110.3 0 128L0 352c0 17.7 14.3 32 32 32z"></path></svg></span><span data-v-359e8271="" class="button reply"><svg data-v-359e8271="" class="svg-inline--fa fa-comment" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"></path></svg> 1 条评论 </span><span data-v-359e8271="" class="button" style="float: right;"> 收起&nbsp;<svg data-v-359e8271="" class="svg-inline--fa fa-chevron-up" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-up" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" fill="currentColor" d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path></svg></span></div><!----></div></div></div></div><div data-v-ac34e482="" class="bottom-wrap"><div data-v-745b01fc="" data-v-ac34e482-s="" class="page-bar"><span data-v-745b01fc="" class="total">共 <strong data-v-745b01fc="">2</strong> 页</span><div data-v-0cbab46c="" data-v-745b01fc=""><!----><button data-v-0cbab46c="" class="selected"><span data-v-0cbab46c="">1</span></button><button data-v-0cbab46c="" class=""><span data-v-0cbab46c="">2</span></button><!----></div></div></div></div></div><!----></div></div></div></div></main><footer data-v-f265fec6="" class="theme-bg" style="background: rgb(51, 51, 51);"><div data-v-f265fec6="" class="theme-fg"><div data-v-1bb3d6f7="" data-v-f265fec6="" class="content-wrap columba-content-wrap"><img data-v-1bb3d6f7="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/static.0e9e3dd97eb08d49.logo-single.png" class="logo"><div data-v-1bb3d6f7="" class="slogan">在洛谷，<br data-v-1bb3d6f7=""> 享受 Coding 的欢乐</div><img data-v-1bb3d6f7="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/static.4b8b9086137d348f.wechat-qr.png" class="weixin"><div data-v-1bb3d6f7="" class="links"><p data-v-1bb3d6f7=""><a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://help.luogu.com.cn/about-us" disabled="false" class="">关于洛谷</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://help.luogu.com.cn/" disabled="false" class="">帮助中心</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://help.luogu.com.cn/ula/luogu" disabled="false" class="">用户协议</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://help.luogu.com.cn/contact-us" disabled="false" class="">联系我们</a><br data-v-1bb3d6f7=""><a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://www.luogu.com.cn/discuss?forum=miaomiaowu" disabled="false" class="">小黑屋</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://www.luogu.com.cn/judgement" disabled="false" class="">陶片放逐</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://help.luogu.com.cn/rules/community/" disabled="false" class="">社区规则</a> | <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://www.lagou.com/gongsi/369082.html" disabled="false" class="">招贤纳才</a></p><p data-v-1bb3d6f7=""> Developed by the <a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="https://github.com/luogu-dev" disabled="false" class="">Luogu Dev Team</a>. <br data-v-1bb3d6f7=""> © 2013-2025 洛谷. All rights reserved. <br data-v-1bb3d6f7=""> 增值电信业务经营许可证 沪B2-20200477 <br data-v-1bb3d6f7=""><a data-v-12b24cc3="" data-v-1bb3d6f7="" target="_blank" href="http://beian.miit.gov.cn/" disabled="false" class="">沪ICP备18008322号</a></p></div></div></div></footer></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div><div data-v-db920be0="" class="dropdown" style="--dropdown-z-index: 1005;"><!----></div></div>


<script defer="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/load.min.js.下载"></script><script defer="" src="./P3956 [NOIP 2017 普及组] 棋盘 - 洛谷_files/api.js.下载"></script></body></html>