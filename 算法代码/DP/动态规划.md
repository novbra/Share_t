## 动态规划



从初始状态出发 经过一系列的状态转移到达终点求最优值、方案数、概率

1. 状态转移必须有方向，且整体不能成环

2. 状态的个数需要在可接受范围内



点 即 **状态**

```text
用数字精确描述的一个局面，对应问题的值
没有问题的状态不成局面，只有局面对应了问题的值才成了状态
```



走 即 **状态转移**

```text
状态在约束的条件下进行转移到另一个状态，伴随着问题的值的变化。这个变化可以叫做 权值weight，开销cost
```

约束对状态走法进行约束

变化是对状态改变后值的改变



三要素

- **最优子结构**：子问题都是最优的
- **无后效性**：求解只与之前的阶段有关，与之后的阶段无关。有向无环图（Directed Acyclic Graph）
- **重叠子问题**：有大量子问题重复，遇到重复子问题时，只需要在表格中查询





### 复杂度

状态数量*状态转移开销

如何优化，方向就是设计更小、更合理的状态或者降低转移开销

![c272781376c1216fa7f092569db68e8d](E:\WeChatDoc\xwechat_files\wxid_ggubr1ock2do21_2d85\temp\RWTemp\2025-12\c272781376c1216fa7f092569db68e8d.jpg)

### 状态转移方程

![27e90da89f05a0fa15e6217478b80843](E:\WeChatDoc\xwechat_files\wxid_ggubr1ock2do21_2d85\temp\RWTemp\2025-12\27e90da89f05a0fa15e6217478b80843.jpg)

### 代码实现

- 逆推 深度优先搜索采用该方法

  当前状态从哪来

- 顺推

  当前状态到哪去，可以转移到哪些状态

  需要先计算这个状态往后转移的结果，将其记录到下一个状态中

  三个注意点

  - 需要将初始状态单拎出来

  - 不需要遍历目标状态

    ![35076f9a4200a884a2d3099653974611](E:\WeChatDoc\xwechat_files\wxid_ggubr1ock2do21_2d85\temp\RWTemp\2025-12\35076f9a4200a884a2d3099653974611.jpg)

  - 需要将所有状态设置一个初始值，可能是0，可能是极大值/极小值

  有的题顺推，由于数据量过大，需要取模，如果+=取模，会计算错误，只能采取逆推。如李白打酒加强版

- 记忆化搜索（深搜逆推）

  适用于无后效性顺序不好用for循环枚举的问题

- 拓扑搜索（广搜顺推）

  适用于无后效性顺序不好用for循环枚举的问题

  三个注意点同顺推

  无后效性顺序也可称之为拓扑序

### 空间优化

- 滚动数组
- 数组复用

### DP模型类型

- 线性

  将问题按某一个维度划分成一个个阶段，每个阶段的状态都由之前阶段的状态转移而来，这样我们只要线性遍历各个阶段的状态，就一定符合无后效性。

  **第一步阶段划分**   必须单调，那种能增能减的就不能作为划分的维度

  ```text
  找到一个维度，用它来划分阶段。如果来回变化则要用行动次数当作维度，而不能用楼梯数。前提该维度变化是单调的。
  如果找不到一个单调的维度，
  阶段划分不一定通过单单一个维度，类似于李白打酒这样的计数DP，是无法做到阶段状态是唯一的。每个状态表达是计数功能，能从多少种途径到达该状态。该多找几个就多找几个维度。
  ```

  **第二步定义状态**

  ```text
  状态的定义，不断试错
  
  大部分的状态都是直接以问题作为状态，虽然不适用于所有问题，但不妨碍我们先用它来进行尝试
  
  当直接以问题作为状态不可行时，可以尝试以i开头和以i结尾进行状态的定义
  
  i结尾的极值 | i开头的极值 + 最后再遍历整个f[i]取极值
  ```

  **第三步状态如何转移（决策）**

  - 前缀DP

    简单，当前阶段的问题只和前一阶段有关，和更早的历史阶段无关

    P1002 过河卒 可以认为是双重前缀DP, 每一行看作是一维状态，然后每一行中的每一列看作是二维状态。

    李白打酒加强版也是三重DP

    ```text
    f[i][j]=1, i=1,j=1
    f[i][j]=f[i][j-1], i=1,j>1
    f[i][j]=f[i-1][j], i>1,j=1
    f[i][j]=f[i-1][j]+f[i][j-1], i>1,j>1
    //f[i][j]的值需要前一行和同行的前一列, 可以从上到下每行依次遍历，从左到右遍历每列依次遍历。
    //可以从左到右遍历每列，再从每列从上到下遍历
    ```

    

  - 01 DP

  - 一般线性DP

  

  单调队列优化

  斜率优化

  数据结构优化

  四边形不等式优化等

- 背包

- 二维/笛卡尔积

  两个独立状态进行叠加

- 区间/划分
- DAG 有向无环图上的动态规划
- 树形
- 数位
- 状态压缩->TSP DP/一般状压 DP/斯坦纳树 DP/插头 DP
- 动态

按值类型划分

- 极值DP

- 计数DP

  求方案数

- 概率DP



`连续`->提示状态以i结尾的最大子段和

### 做题顺序

### DEBUG

如果洛谷错误提示负号，那么大概就是数据类型选的不够大

## 草稿区

```text




f[i]=f[i-1]+1, a[i]=a[i-1]
f[i]=1, a[i]!=a[i-1]
max{fi|1<=i<=N}
```

